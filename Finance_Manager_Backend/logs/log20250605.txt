2025-06-05 18:45:02.423 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-06-05 18:45:03.229 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:45:03.365 +03:00 [DBG] Compiling query expression: 
'DbSet<User>()'
2025-06-05 18:45:03.760 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<User>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
        SELECT u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
        FROM users AS u) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
        SELECT u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
        FROM users AS u, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        User entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            User instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(User);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: User.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (User)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]: 
                        {
                            return 
                            {
                                User instance;
                                instance = new User();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Balance>k__BackingField = dataReader.GetDecimal(1);
                                instance.<Email>k__BackingField = dataReader.GetString(2);
                                instance.<PasswordHash>k__BackingField = dataReader.GetString(3);
                                instance.<PrimaryCurrency>k__BackingField = dataReader.GetString(4);
                                instance.<Role>k__BackingField = dataReader.GetString(5);
                                instance.<Salt>k__BackingField = dataReader.GetString(6);
                                instance.<SecondaryCurrency1>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<SecondaryCurrency2>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(User)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 18:45:03.862 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:45:03.895 +03:00 [DBG] Created DbConnection. (31ms).
2025-06-05 18:45:03.903 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.015 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.021 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:05.028 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (6ms).
2025-06-05 18:45:05.031 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (12ms).
2025-06-05 18:45:05.039 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
2025-06-05 18:45:05.148 +03:00 [INF] Executed DbCommand (108ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
2025-06-05 18:45:05.198 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.247 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.255 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.257 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.262 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.270 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 113ms reading results.
2025-06-05 18:45:05.273 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.279 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (6ms).
2025-06-05 18:45:05.286 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 18:45:05.289 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 18:45:05.305 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 18:45:05.376 +03:00 [DBG] Executing 2 update commands as a batch.
2025-06-05 18:45:05.386 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.390 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.394 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-06-05 18:45:05.406 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 18:45:05.412 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:05.413 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:45:05.418 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2025-06-05 18:45:05.424 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p1;
2025-06-05 18:45:05.500 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p1;
2025-06-05 18:45:05.511 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.514 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 11ms reading results.
2025-06-05 18:45:05.520 +03:00 [DBG] Committing transaction.
2025-06-05 18:45:05.550 +03:00 [DBG] Committed transaction.
2025-06-05 18:45:05.553 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.555 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:45:05.558 +03:00 [DBG] Disposing transaction.
2025-06-05 18:45:05.564 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.567 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.570 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-06-05 18:45:05.573 +03:00 [DBG] Compiling query expression: 
'DbSet<Category>()'
2025-06-05 18:45:05.582 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Category>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Category entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Category instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Category);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Category)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                        {
                            return 
                            {
                                Category instance;
                                instance = new Category();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<ColorForBackground>k__BackingField = dataReader.GetString(1);
                                instance.<Icon>k__BackingField = dataReader.GetString(2);
                                instance.<IsIncome>k__BackingField = dataReader.GetBoolean(3);
                                instance.<Name>k__BackingField = dataReader.GetString(4);
                                instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Category)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 18:45:05.588 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.590 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.591 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:05.593 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:45:05.595 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 18:45:05.596 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 18:45:05.613 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 18:45:05.629 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.643 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.646 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.648 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.651 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.653 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.655 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.657 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.659 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.661 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.663 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.664 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 49ms reading results.
2025-06-05 18:45:05.667 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.669 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:45:05.671 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 18:45:05.672 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 18:45:05.682 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 18:45:05.687 +03:00 [DBG] Executing 5 update commands as a batch.
2025-06-05 18:45:05.688 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.690 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.693 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-06-05 18:45:05.696 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 18:45:05.698 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:05.699 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-05 18:45:05.701 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 18:45:05.703 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p1;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p2;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p3;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p4;
2025-06-05 18:45:05.732 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p1;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p2;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p3;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p4;
2025-06-05 18:45:05.737 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.739 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 18:45:05.741 +03:00 [DBG] Committing transaction.
2025-06-05 18:45:05.742 +03:00 [DBG] Committed transaction.
2025-06-05 18:45:05.743 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.744 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:45:05.746 +03:00 [DBG] Disposing transaction.
2025-06-05 18:45:05.748 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.750 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.752 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.754 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.756 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:05.758 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 5 entities written to the database.
2025-06-05 18:45:05.761 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:45:05.764 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:05.766 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 18:45:05.988 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:45:06.001 +03:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Email == __email_0)'
2025-06-05 18:45:06.067 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.email == @__email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.email == @__email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Balance>k__BackingField = dataReader.GetDecimal(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(3);
                                    instance.<PrimaryCurrency>k__BackingField = dataReader.GetString(4);
                                    instance.<Role>k__BackingField = dataReader.GetString(5);
                                    instance.<Salt>k__BackingField = dataReader.GetString(6);
                                    instance.<SecondaryCurrency1>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<SecondaryCurrency2>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 18:45:06.083 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:45:06.086 +03:00 [DBG] Created DbConnection. (3ms).
2025-06-05 18:45:06.087 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.089 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.091 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:06.092 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:45:06.094 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 18:45:06.096 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 18:45:06.178 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 18:45:06.186 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.188 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 6ms reading results.
2025-06-05 18:45:06.190 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.192 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:45:06.235 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'User.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.243 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.245 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 18:45:06.246 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 18:45:06.248 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 18:45:06.260 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.261 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.263 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:06.264 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:45:06.265 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 18:45:06.267 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 50), @p1='?' (Size = 50), @p2='?' (Size = 3), @p3='?' (Size = 5), @p4='?' (Size = 30), @p5='?' (Size = 3), @p6='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id], INSERTED.[balance]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-06-05 18:45:06.305 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[@p0='?' (Size = 50), @p1='?' (Size = 50), @p2='?' (Size = 3), @p3='?' (Size = 5), @p4='?' (Size = 30), @p5='?' (Size = 3), @p6='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id], INSERTED.[balance]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-06-05 18:45:06.316 +03:00 [DBG] The foreign key property 'User.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.321 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.323 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 15ms reading results.
2025-06-05 18:45:06.325 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.326 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:45:06.333 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.337 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 18:45:06.443 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'RefreshToken.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.468 +03:00 [DBG] The navigation 'RefreshToken.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.472 +03:00 [DBG] Context 'AppDbContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.476 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 18:45:06.477 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 18:45:06.487 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 18:45:06.493 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.495 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.497 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:06.499 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:45:06.502 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-06-05 18:45:06.505 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 18:45:06.558 +03:00 [INF] Executed DbCommand (53ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 18:45:06.564 +03:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.566 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.568 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 7ms reading results.
2025-06-05 18:45:06.570 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.571 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:45:06.574 +03:00 [DBG] An entity of type 'RefreshToken' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.576 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 18:45:06.579 +03:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Id == __authData_UserDTO_Id_0)'
2025-06-05 18:45:06.585 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.id == @__authData_UserDTO_Id_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.id == @__authData_UserDTO_Id_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Balance>k__BackingField = dataReader.GetDecimal(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(3);
                                    instance.<PrimaryCurrency>k__BackingField = dataReader.GetString(4);
                                    instance.<Role>k__BackingField = dataReader.GetString(5);
                                    instance.<Salt>k__BackingField = dataReader.GetString(6);
                                    instance.<SecondaryCurrency1>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<SecondaryCurrency2>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 18:45:06.590 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.591 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.593 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:06.594 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:45:06.596 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 18:45:06.597 +03:00 [DBG] Executing DbCommand [Parameters=[@__authData_UserDTO_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__authData_UserDTO_Id_0
2025-06-05 18:45:06.645 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[@__authData_UserDTO_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__authData_UserDTO_Id_0
2025-06-05 18:45:06.649 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.652 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 18:45:06.654 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.656 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 18:45:06.664 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.669 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.671 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.674 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.676 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.678 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.680 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.682 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.686 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.688 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.690 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 18:45:06.693 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 18:45:06.698 +03:00 [DBG] The unchanged property 'User.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.700 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.704 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 18:45:06.720 +03:00 [DBG] Executing 6 update commands as a batch.
2025-06-05 18:45:06.721 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.723 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.726 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-06-05 18:45:06.727 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 18:45:06.728 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:06.730 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:45:06.732 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 18:45:06.734 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 7), @p1='?' (Size = 100), @p2='?' (DbType = Boolean), @p3='?' (Size = 50), @p4='?' (DbType = Int32), @p5='?' (Size = 7), @p6='?' (Size = 100), @p7='?' (DbType = Boolean), @p8='?' (Size = 50), @p9='?' (DbType = Int32), @p10='?' (Size = 7), @p11='?' (Size = 100), @p12='?' (DbType = Boolean), @p13='?' (Size = 50), @p14='?' (DbType = Int32), @p15='?' (Size = 7), @p16='?' (Size = 100), @p17='?' (DbType = Boolean), @p18='?' (Size = 50), @p19='?' (DbType = Int32), @p20='?' (Size = 7), @p21='?' (Size = 100), @p22='?' (DbType = Boolean), @p23='?' (Size = 50), @p24='?' (DbType = Int32), @p26='?' (DbType = Int32), @p25='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [categories] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, 0),
(@p5, @p6, @p7, @p8, @p9, 1),
(@p10, @p11, @p12, @p13, @p14, 2),
(@p15, @p16, @p17, @p18, @p19, 3),
(@p20, @p21, @p22, @p23, @p24, 4)) AS i ([background_color], [icon_path], [is_income], [name], [parent_category_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([background_color], [icon_path], [is_income], [name], [parent_category_fk])
VALUES (i.[background_color], i.[icon_path], i.[is_income], i.[name], i.[parent_category_fk])
OUTPUT INSERTED.[id], i._Position;
UPDATE [users] SET [balance] = @p25
OUTPUT 1
WHERE [id] = @p26;
2025-06-05 18:45:06.759 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@p0='?' (Size = 7), @p1='?' (Size = 100), @p2='?' (DbType = Boolean), @p3='?' (Size = 50), @p4='?' (DbType = Int32), @p5='?' (Size = 7), @p6='?' (Size = 100), @p7='?' (DbType = Boolean), @p8='?' (Size = 50), @p9='?' (DbType = Int32), @p10='?' (Size = 7), @p11='?' (Size = 100), @p12='?' (DbType = Boolean), @p13='?' (Size = 50), @p14='?' (DbType = Int32), @p15='?' (Size = 7), @p16='?' (Size = 100), @p17='?' (DbType = Boolean), @p18='?' (Size = 50), @p19='?' (DbType = Int32), @p20='?' (Size = 7), @p21='?' (Size = 100), @p22='?' (DbType = Boolean), @p23='?' (Size = 50), @p24='?' (DbType = Int32), @p26='?' (DbType = Int32), @p25='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [categories] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, 0),
(@p5, @p6, @p7, @p8, @p9, 1),
(@p10, @p11, @p12, @p13, @p14, 2),
(@p15, @p16, @p17, @p18, @p19, 3),
(@p20, @p21, @p22, @p23, @p24, 4)) AS i ([background_color], [icon_path], [is_income], [name], [parent_category_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([background_color], [icon_path], [is_income], [name], [parent_category_fk])
VALUES (i.[background_color], i.[icon_path], i.[is_income], i.[name], i.[parent_category_fk])
OUTPUT INSERTED.[id], i._Position;
UPDATE [users] SET [balance] = @p25
OUTPUT 1
WHERE [id] = @p26;
2025-06-05 18:45:06.762 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.765 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.767 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.768 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.770 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.772 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.773 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 11ms reading results.
2025-06-05 18:45:06.775 +03:00 [DBG] Committing transaction.
2025-06-05 18:45:06.776 +03:00 [DBG] Committed transaction.
2025-06-05 18:45:06.777 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.779 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:45:06.780 +03:00 [DBG] Disposing transaction.
2025-06-05 18:45:06.782 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.784 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.786 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.788 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.790 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.792 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.794 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 6 entities written to the database.
2025-06-05 18:45:06.799 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.819 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.820 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.822 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.824 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.826 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.827 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.829 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.830 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.832 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.834 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.837 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.839 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.840 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.842 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.844 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.845 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.847 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.848 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.852 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.854 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.856 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.858 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.860 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.861 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.863 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.865 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.867 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.869 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.871 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.873 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.875 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.877 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.879 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.882 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.885 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.887 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.890 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.892 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.894 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:06.896 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 18:45:06.897 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 18:45:06.905 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 18:45:06.908 +03:00 [DBG] Executing 20 update commands as a batch.
2025-06-05 18:45:06.910 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.912 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:06.914 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:06.915 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:45:06.918 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-06-05 18:45:06.921 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (Size = 50), @p4='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 50), @p10='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (DbType = DateTime2), @p20='?' (DbType = Int32), @p21='?' (Size = 50), @p22='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32), @p25='?' (DbType = DateTime2), @p26='?' (DbType = Int32), @p27='?' (Size = 50), @p28='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p29='?' (DbType = Int32), @p30='?' (DbType = Int32), @p31='?' (DbType = DateTime2), @p32='?' (DbType = Int32), @p33='?' (Size = 50), @p34='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p35='?' (DbType = Int32), @p36='?' (DbType = Int32), @p37='?' (DbType = DateTime2), @p38='?' (DbType = Int32), @p39='?' (Size = 50), @p40='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p41='?' (DbType = Int32), @p42='?' (DbType = Int32), @p43='?' (DbType = DateTime2), @p44='?' (DbType = Int32), @p45='?' (Size = 50), @p46='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p47='?' (DbType = Int32), @p48='?' (DbType = Int32), @p49='?' (DbType = DateTime2), @p50='?' (DbType = Int32), @p51='?' (Size = 50), @p52='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p53='?' (DbType = Int32), @p54='?' (DbType = Int32), @p55='?' (DbType = DateTime2), @p56='?' (DbType = Int32), @p57='?' (Size = 50), @p58='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p59='?' (DbType = Int32), @p60='?' (DbType = Int32), @p61='?' (DbType = DateTime2), @p62='?' (DbType = Int32), @p63='?' (Size = 50), @p64='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p65='?' (DbType = Int32), @p66='?' (DbType = Int32), @p67='?' (DbType = DateTime2), @p68='?' (DbType = Int32), @p69='?' (Size = 50), @p70='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p71='?' (DbType = Int32), @p72='?' (DbType = Int32), @p73='?' (DbType = DateTime2), @p74='?' (DbType = Int32), @p75='?' (Size = 50), @p76='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p77='?' (DbType = Int32), @p78='?' (DbType = Int32), @p79='?' (DbType = DateTime2), @p80='?' (DbType = Int32), @p81='?' (Size = 50), @p82='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p83='?' (DbType = Int32), @p84='?' (DbType = Int32), @p85='?' (DbType = DateTime2), @p86='?' (DbType = Int32), @p87='?' (Size = 50), @p88='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p89='?' (DbType = Int32), @p90='?' (DbType = Int32), @p91='?' (DbType = DateTime2), @p92='?' (DbType = Int32), @p93='?' (Size = 50), @p94='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p95='?' (DbType = Int32), @p96='?' (DbType = Int32), @p97='?' (DbType = DateTime2), @p98='?' (DbType = Int32), @p99='?' (Size = 50), @p100='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p101='?' (DbType = Int32), @p102='?' (DbType = Int32), @p103='?' (DbType = DateTime2), @p104='?' (DbType = Int32), @p105='?' (Size = 50), @p106='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p107='?' (DbType = Int32), @p108='?' (DbType = Int32), @p109='?' (DbType = DateTime2), @p110='?' (DbType = Int32), @p111='?' (Size = 50), @p112='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p113='?' (DbType = Int32), @p114='?' (DbType = Int32), @p115='?' (DbType = DateTime2), @p116='?' (DbType = Int32), @p117='?' (Size = 50), @p118='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p119='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [transactions] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, 0),
(@p6, @p7, @p8, @p9, @p10, @p11, 1),
(@p12, @p13, @p14, @p15, @p16, @p17, 2),
(@p18, @p19, @p20, @p21, @p22, @p23, 3),
(@p24, @p25, @p26, @p27, @p28, @p29, 4),
(@p30, @p31, @p32, @p33, @p34, @p35, 5),
(@p36, @p37, @p38, @p39, @p40, @p41, 6),
(@p42, @p43, @p44, @p45, @p46, @p47, 7),
(@p48, @p49, @p50, @p51, @p52, @p53, 8),
(@p54, @p55, @p56, @p57, @p58, @p59, 9),
(@p60, @p61, @p62, @p63, @p64, @p65, 10),
(@p66, @p67, @p68, @p69, @p70, @p71, 11),
(@p72, @p73, @p74, @p75, @p76, @p77, 12),
(@p78, @p79, @p80, @p81, @p82, @p83, 13),
(@p84, @p85, @p86, @p87, @p88, @p89, 14),
(@p90, @p91, @p92, @p93, @p94, @p95, 15),
(@p96, @p97, @p98, @p99, @p100, @p101, 16),
(@p102, @p103, @p104, @p105, @p106, @p107, 17),
(@p108, @p109, @p110, @p111, @p112, @p113, 18),
(@p114, @p115, @p116, @p117, @p118, @p119, 19)) AS i ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk])
VALUES (i.[category_fk], i.[date], i.[inner_category_fk], i.[name], i.[price], i.[user_fk])
OUTPUT INSERTED.[id], i._Position;
2025-06-05 18:45:06.952 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (Size = 50), @p4='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 50), @p10='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (DbType = DateTime2), @p20='?' (DbType = Int32), @p21='?' (Size = 50), @p22='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32), @p25='?' (DbType = DateTime2), @p26='?' (DbType = Int32), @p27='?' (Size = 50), @p28='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p29='?' (DbType = Int32), @p30='?' (DbType = Int32), @p31='?' (DbType = DateTime2), @p32='?' (DbType = Int32), @p33='?' (Size = 50), @p34='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p35='?' (DbType = Int32), @p36='?' (DbType = Int32), @p37='?' (DbType = DateTime2), @p38='?' (DbType = Int32), @p39='?' (Size = 50), @p40='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p41='?' (DbType = Int32), @p42='?' (DbType = Int32), @p43='?' (DbType = DateTime2), @p44='?' (DbType = Int32), @p45='?' (Size = 50), @p46='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p47='?' (DbType = Int32), @p48='?' (DbType = Int32), @p49='?' (DbType = DateTime2), @p50='?' (DbType = Int32), @p51='?' (Size = 50), @p52='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p53='?' (DbType = Int32), @p54='?' (DbType = Int32), @p55='?' (DbType = DateTime2), @p56='?' (DbType = Int32), @p57='?' (Size = 50), @p58='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p59='?' (DbType = Int32), @p60='?' (DbType = Int32), @p61='?' (DbType = DateTime2), @p62='?' (DbType = Int32), @p63='?' (Size = 50), @p64='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p65='?' (DbType = Int32), @p66='?' (DbType = Int32), @p67='?' (DbType = DateTime2), @p68='?' (DbType = Int32), @p69='?' (Size = 50), @p70='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p71='?' (DbType = Int32), @p72='?' (DbType = Int32), @p73='?' (DbType = DateTime2), @p74='?' (DbType = Int32), @p75='?' (Size = 50), @p76='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p77='?' (DbType = Int32), @p78='?' (DbType = Int32), @p79='?' (DbType = DateTime2), @p80='?' (DbType = Int32), @p81='?' (Size = 50), @p82='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p83='?' (DbType = Int32), @p84='?' (DbType = Int32), @p85='?' (DbType = DateTime2), @p86='?' (DbType = Int32), @p87='?' (Size = 50), @p88='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p89='?' (DbType = Int32), @p90='?' (DbType = Int32), @p91='?' (DbType = DateTime2), @p92='?' (DbType = Int32), @p93='?' (Size = 50), @p94='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p95='?' (DbType = Int32), @p96='?' (DbType = Int32), @p97='?' (DbType = DateTime2), @p98='?' (DbType = Int32), @p99='?' (Size = 50), @p100='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p101='?' (DbType = Int32), @p102='?' (DbType = Int32), @p103='?' (DbType = DateTime2), @p104='?' (DbType = Int32), @p105='?' (Size = 50), @p106='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p107='?' (DbType = Int32), @p108='?' (DbType = Int32), @p109='?' (DbType = DateTime2), @p110='?' (DbType = Int32), @p111='?' (Size = 50), @p112='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p113='?' (DbType = Int32), @p114='?' (DbType = Int32), @p115='?' (DbType = DateTime2), @p116='?' (DbType = Int32), @p117='?' (Size = 50), @p118='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p119='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [transactions] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, 0),
(@p6, @p7, @p8, @p9, @p10, @p11, 1),
(@p12, @p13, @p14, @p15, @p16, @p17, 2),
(@p18, @p19, @p20, @p21, @p22, @p23, 3),
(@p24, @p25, @p26, @p27, @p28, @p29, 4),
(@p30, @p31, @p32, @p33, @p34, @p35, 5),
(@p36, @p37, @p38, @p39, @p40, @p41, 6),
(@p42, @p43, @p44, @p45, @p46, @p47, 7),
(@p48, @p49, @p50, @p51, @p52, @p53, 8),
(@p54, @p55, @p56, @p57, @p58, @p59, 9),
(@p60, @p61, @p62, @p63, @p64, @p65, 10),
(@p66, @p67, @p68, @p69, @p70, @p71, 11),
(@p72, @p73, @p74, @p75, @p76, @p77, 12),
(@p78, @p79, @p80, @p81, @p82, @p83, 13),
(@p84, @p85, @p86, @p87, @p88, @p89, 14),
(@p90, @p91, @p92, @p93, @p94, @p95, 15),
(@p96, @p97, @p98, @p99, @p100, @p101, 16),
(@p102, @p103, @p104, @p105, @p106, @p107, 17),
(@p108, @p109, @p110, @p111, @p112, @p113, 18),
(@p114, @p115, @p116, @p117, @p118, @p119, 19)) AS i ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk])
VALUES (i.[category_fk], i.[date], i.[inner_category_fk], i.[name], i.[price], i.[user_fk])
OUTPUT INSERTED.[id], i._Position;
2025-06-05 18:45:06.958 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.963 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.965 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.968 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.970 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.972 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.974 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.976 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.978 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.980 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.982 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.983 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.987 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.989 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.991 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.993 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.995 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.997 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:06.998 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:07.001 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:07.004 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.006 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 49ms reading results.
2025-06-05 18:45:07.008 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.009 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:45:07.012 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.014 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.017 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.021 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.023 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.025 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.027 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.029 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.031 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.033 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.036 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.038 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.040 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.042 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.044 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.046 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.048 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.050 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.053 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.055 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.057 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 20 entities written to the database.
2025-06-05 18:45:07.060 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.074 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.076 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.077 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.079 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.081 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.082 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.086 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.087 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 18:45:07.088 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 18:45:07.093 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 18:45:07.095 +03:00 [DBG] Executing 4 update commands as a batch.
2025-06-05 18:45:07.097 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.098 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.100 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:07.102 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-06-05 18:45:07.104 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 18:45:07.105 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (DbType = Int32), @p3='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 50), @p5='?' (DbType = Int32), @p6='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p10='?' (Size = 50), @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [savings] USING (
VALUES (@p0, @p1, @p2, 0),
(@p3, @p4, @p5, 1),
(@p6, @p7, @p8, 2),
(@p9, @p10, @p11, 3)) AS i ([goal], [name], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([goal], [name], [user_fk])
VALUES (i.[goal], i.[name], i.[user_fk])
OUTPUT INSERTED.[id], INSERTED.[current_amount], i._Position;
2025-06-05 18:45:07.136 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (DbType = Int32), @p3='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 50), @p5='?' (DbType = Int32), @p6='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p10='?' (Size = 50), @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [savings] USING (
VALUES (@p0, @p1, @p2, 0),
(@p3, @p4, @p5, 1),
(@p6, @p7, @p8, 2),
(@p9, @p10, @p11, 3)) AS i ([goal], [name], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([goal], [name], [user_fk])
VALUES (i.[goal], i.[name], i.[user_fk])
OUTPUT INSERTED.[id], INSERTED.[current_amount], i._Position;
2025-06-05 18:45:07.141 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:07.143 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:07.145 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:07.147 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:07.149 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.152 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 12ms reading results.
2025-06-05 18:45:07.154 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.157 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 18:45:07.159 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.162 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.165 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.168 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.171 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 4 entities written to the database.
2025-06-05 18:45:07.173 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:45:07.175 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.177 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 18:45:07.200 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:45:07.207 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:45:07.208 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 18:45:07.211 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.213 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.215 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:07.216 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:45:07.219 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-06-05 18:45:07.221 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 18:45:07.226 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 18:45:07.229 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.231 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-06-05 18:45:07.233 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.236 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (3ms).
2025-06-05 18:45:07.249 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'User.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.252 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.254 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 18:45:07.256 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 18:45:07.258 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 18:45:07.259 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.261 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.263 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:07.264 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:45:07.266 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 18:45:07.269 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Precision = 12) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (Size = 50), @p3='?' (Size = 3), @p4='?' (Size = 5), @p5='?' (Size = 30), @p6='?' (Size = 3), @p7='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([balance], [email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-06-05 18:45:07.276 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Precision = 12) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (Size = 50), @p3='?' (Size = 3), @p4='?' (Size = 5), @p5='?' (Size = 30), @p6='?' (Size = 3), @p7='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([balance], [email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-06-05 18:45:07.279 +03:00 [DBG] The foreign key property 'User.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:45:07.281 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.282 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 18:45:07.286 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.287 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:45:07.290 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:45:07.292 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 18:45:07.293 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:45:07.295 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.296 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 18:45:07.418 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-05 18:45:07.502 +03:00 [DBG] Hosting starting
2025-06-05 18:45:07.571 +03:00 [INF] User profile is available. Using 'C:\Users\ebtyx\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-06-05 18:45:07.590 +03:00 [DBG] Reading data from file 'C:\Users\ebtyx\AppData\Local\ASP.NET\DataProtection-Keys\key-036e1e5f-5347-47d7-8236-0b64ed0a76a1.xml'.
2025-06-05 18:45:07.592 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:45:07.597 +03:00 [DBG] Found key {036e1e5f-5347-47d7-8236-0b64ed0a76a1}.
2025-06-05 18:45:07.598 +03:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.ExpiresAt < DateTime.UtcNow)'
2025-06-05 18:45:07.608 +03:00 [DBG] Considering key {036e1e5f-5347-47d7-8236-0b64ed0a76a1} with expiration date 2025-07-16 20:11:06Z as default key.
2025-06-05 18:45:07.611 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<RefreshToken>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
        SELECT r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
        FROM refresh_tokens AS r
        WHERE r.expires_at < GETUTCDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
        SELECT r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
        FROM refresh_tokens AS r
        WHERE r.expires_at < GETUTCDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        RefreshToken entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            RefreshToken instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(RefreshToken);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: RefreshToken.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (RefreshToken)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]: 
                        {
                            return 
                            {
                                RefreshToken instance;
                                instance = new RefreshToken();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                instance.<ExpiresAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<IsRevoked>k__BackingField = dataReader.GetBoolean(3);
                                instance.<Token>k__BackingField = dataReader.GetString(4);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(5);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(RefreshToken)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 18:45:07.613 +03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-06-05 18:45:07.614 +03:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-06-05 18:45:07.617 +03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-06-05 18:45:07.617 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:45:07.619 +03:00 [DBG] Created DbConnection. (2ms).
2025-06-05 18:45:07.620 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.621 +03:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-06-05 18:45:07.622 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.624 +03:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-06-05 18:45:07.625 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:45:07.627 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-06-05 18:45:07.627 +03:00 [DBG] Using key {036e1e5f-5347-47d7-8236-0b64ed0a76a1} as the default key.
2025-06-05 18:45:07.629 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 18:45:07.630 +03:00 [DBG] Key ring with default key {036e1e5f-5347-47d7-8236-0b64ed0a76a1} was loaded during application startup.
2025-06-05 18:45:07.631 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[expires_at] < GETUTCDATE()
2025-06-05 18:45:07.641 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[expires_at] < GETUTCDATE()
2025-06-05 18:45:07.644 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.646 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 18:45:07.655 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.657 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 18:45:07.660 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:45:07.661 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:45:07.664 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 18:45:07.978 +03:00 [INF] Now listening on: https://localhost:49464
2025-06-05 18:45:07.983 +03:00 [INF] Now listening on: http://localhost:49465
2025-06-05 18:45:07.985 +03:00 [DBG] Loaded hosting startup assembly Finance_Manager_Backend
2025-06-05 18:45:07.987 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-06-05 18:45:07.988 +03:00 [INF] Hosting environment: Development
2025-06-05 18:45:07.990 +03:00 [INF] Content root path: G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend
2025-06-05 18:45:07.991 +03:00 [DBG] Hosting started
2025-06-05 18:46:53.866 +03:00 [DBG] Connection id "0HND490OUORBS" accepted.
2025-06-05 18:46:53.873 +03:00 [DBG] Connection id "0HND490OUORBS" started.
2025-06-05 18:46:53.950 +03:00 [DBG] Connection 0HND490OUORBS established using the following protocol: "Tls12"
2025-06-05 18:46:54.473 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - application/json-patch+json 90
2025-06-05 18:46:54.480 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-05 18:46:54.600 +03:00 [DBG] POST requests are not supported
2025-06-05 18:46:54.623 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/refresh-token'
2025-06-05 18:46:54.628 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)' with route pattern 'api/Auth/refresh-token' is valid for the request path '/api/Auth/refresh-token'
2025-06-05 18:46:54.630 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-06-05 18:46:54.713 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-06-05 18:46:54.717 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-06-05 18:46:54.742 +03:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] RefreshToken(System.String) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-06-05 18:46:54.745 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:46:54.747 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:46:54.749 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:46:54.751 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:46:54.753 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:46:54.757 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 18:46:54.760 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 18:46:54.818 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' ...
2025-06-05 18:46:54.838 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' using the name '' in request data ...
2025-06-05 18:46:54.851 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:46:54.853 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:46:54.890 +03:00 [DBG] Connection id "0HND490OUORBS", Request id "0HND490OUORBS:00000001": started reading request body.
2025-06-05 18:46:54.893 +03:00 [DBG] Connection id "0HND490OUORBS", Request id "0HND490OUORBS:00000001": done reading request body.
2025-06-05 18:46:55.097 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-06-05 18:46:55.100 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-06-05 18:46:55.101 +03:00 [DBG] Attempting to validate the bound parameter 'refreshToken' of type 'System.String' ...
2025-06-05 18:46:55.112 +03:00 [DBG] Done attempting to validate the bound parameter 'refreshToken' of type 'System.String'.
2025-06-05 18:46:55.123 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:46:55.132 +03:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(rt => rt.Token == __refreshToken_0)'
2025-06-05 18:46:55.148 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<RefreshToken>(
    asyncEnumerable: SingleQueryingEnumerable.Create<RefreshToken>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
            SELECT TOP(1) r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
            FROM refresh_tokens AS r
            WHERE r.token == @__refreshToken_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
            SELECT TOP(1) r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
            FROM refresh_tokens AS r
            WHERE r.token == @__refreshToken_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            RefreshToken entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                RefreshToken instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(RefreshToken);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: RefreshToken.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (RefreshToken)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]: 
                            {
                                return 
                                {
                                    RefreshToken instance;
                                    instance = new RefreshToken();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<ExpiresAt>k__BackingField = dataReader.GetDateTime(2);
                                    instance.<IsRevoked>k__BackingField = dataReader.GetBoolean(3);
                                    instance.<Token>k__BackingField = dataReader.GetString(4);
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(5);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(RefreshToken)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 18:46:55.154 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:46:55.158 +03:00 [DBG] Created DbConnection. (4ms).
2025-06-05 18:46:55.160 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:46:55.163 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:46:55.165 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:46:55.166 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:46:55.169 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 18:46:55.178 +03:00 [DBG] Executing DbCommand [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-06-05 18:46:55.224 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-06-05 18:46:55.227 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:46:55.229 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-06-05 18:46:55.231 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:46:55.232 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:46:55.249 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend) in 491.2399ms
2025-06-05 18:46:55.253 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-06-05 18:46:55.258 +03:00 [ERR] Invalid refresh token
System.InvalidOperationException: Invalid refresh token
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserWithRefreshTokenAsync(String refreshToken) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 89
   at Finance_Manager_Backend.Controllers.AuthController.RefreshToken(String refreshToken) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 86
   at lambda_method475(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-06-05 18:46:55.629 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:46:55.667 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:46:55.671 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:46:55.674 +03:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-06-05 18:46:55.678 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - 400 null application/json 1206.0924ms
2025-06-05 18:47:08.526 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - application/json-patch+json 63
2025-06-05 18:47:08.535 +03:00 [DBG] POST requests are not supported
2025-06-05 18:47:08.539 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/authenticate'
2025-06-05 18:47:08.542 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)' with route pattern 'api/Auth/authenticate' is valid for the request path '/api/Auth/authenticate'
2025-06-05 18:47:08.546 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-06-05 18:47:08.551 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-06-05 18:47:08.556 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-06-05 18:47:08.567 +03:00 [INF] Route matched with {action = "Authenticate", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] Authenticate(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-06-05 18:47:08.569 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:08.571 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:08.572 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:08.574 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:08.576 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:08.578 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 18:47:08.580 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 18:47:08.581 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-06-05 18:47:08.583 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' using the name '' in request data ...
2025-06-05 18:47:08.586 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:47:08.587 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:47:08.589 +03:00 [DBG] Connection id "0HND490OUORBS", Request id "0HND490OUORBS:00000002": started reading request body.
2025-06-05 18:47:08.590 +03:00 [DBG] Connection id "0HND490OUORBS", Request id "0HND490OUORBS:00000002": done reading request body.
2025-06-05 18:47:08.665 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-06-05 18:47:08.667 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-06-05 18:47:08.669 +03:00 [DBG] Attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-06-05 18:47:08.673 +03:00 [DBG] Done attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-06-05 18:47:08.736 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:47:08.739 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:47:08.740 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 18:47:08.741 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:08.743 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:08.744 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:47:08.746 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:47:08.747 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 18:47:08.749 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 18:47:08.753 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 18:47:08.755 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:08.757 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:08.759 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 18:47:08.761 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:08.762 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:47:08.774 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'RefreshToken.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:08.776 +03:00 [DBG] The navigation 'RefreshToken.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:08.778 +03:00 [DBG] Context 'AppDbContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:08.779 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 18:47:08.780 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 18:47:08.781 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 18:47:08.783 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:08.785 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:08.786 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:47:08.788 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:47:08.789 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 18:47:08.791 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 18:47:08.795 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 18:47:08.797 +03:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:47:08.799 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:08.800 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 18:47:08.802 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:08.804 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:47:08.805 +03:00 [DBG] An entity of type 'RefreshToken' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:08.808 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 18:47:08.811 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:08.816 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:08.818 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:08.820 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:08.820 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:08.823 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:08.824 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO'.
2025-06-05 18:47:08.863 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend) in 284.6317ms
2025-06-05 18:47:08.864 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-06-05 18:47:08.865 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:47:08.867 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:47:08.868 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:08.869 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 18:47:08.871 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - 200 524 application/json; charset=utf-8 345.2735ms
2025-06-05 18:47:09.653 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1153 - null null
2025-06-05 18:47:09.665 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:47:09.670 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1153'
2025-06-05 18:47:09.672 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1153'
2025-06-05 18:47:09.673 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:09.876 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:09.879 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:09.881 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:09.888 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 18:47:09.891 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:09.892 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:09.894 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:09.896 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:09.898 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:09.899 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:47:09.910 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:47:09.912 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:09.914 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:47:09.917 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:09.918 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:09.920 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:09.921 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:09.943 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:09.946 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:09.948 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:09.949 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:09.950 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:09.952 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:09.953 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 18:47:09.963 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 64.0523ms
2025-06-05 18:47:09.968 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:09.970 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:47:09.974 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1153 - 200 105 application/json; charset=utf-8 320.854ms
2025-06-05 18:47:10.004 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Categories - null null
2025-06-05 18:47:10.008 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:47:10.009 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Categories'
2025-06-05 18:47:10.010 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)' with route pattern 'api/Categories' is valid for the request path '/api/Categories'
2025-06-05 18:47:10.012 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)'
2025-06-05 18:47:10.013 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:10.014 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:10.016 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)'
2025-06-05 18:47:10.020 +03:00 [INF] Route matched with {action = "GetAllCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryDTO]]] GetAllCategories() on controller Finance_Manager_Backend.Controllers.CategoriesController (Finance_Manager_Backend).
2025-06-05 18:47:10.022 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:10.023 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:10.025 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:10.027 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:10.028 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:10.030 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.CategoriesController (Finance_Manager_Backend)
2025-06-05 18:47:10.032 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.CategoriesController (Finance_Manager_Backend)
2025-06-05 18:47:10.036 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:47:10.038 +03:00 [DBG] Compiling query expression: 
'DbSet<Category>()'
2025-06-05 18:47:10.044 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Category>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Category entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Category instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Category);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Category)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                        {
                            return 
                            {
                                Category instance;
                                instance = new Category();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<ColorForBackground>k__BackingField = dataReader.GetString(1);
                                instance.<Icon>k__BackingField = dataReader.GetString(2);
                                instance.<IsIncome>k__BackingField = dataReader.GetBoolean(3);
                                instance.<Name>k__BackingField = dataReader.GetString(4);
                                instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Category)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 18:47:10.048 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:47:10.049 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 18:47:10.050 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.052 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.053 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:47:10.054 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:47:10.056 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 18:47:10.057 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 18:47:10.060 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 18:47:10.063 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.065 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.069 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.070 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.072 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.074 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.076 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 13ms reading results.
2025-06-05 18:47:10.077 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.079 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:47:10.096 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:10.102 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:10.103 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:10.105 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:10.106 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:10.106 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:10.108 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 18:47:10.118 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend) in 88.2148ms
2025-06-05 18:47:10.121 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)'
2025-06-05 18:47:10.123 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:47:10.125 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:47:10.127 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.131 +03:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-06-05 18:47:10.137 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Categories - 200 736 application/json; charset=utf-8 132.895ms
2025-06-05 18:47:10.164 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Transactions?userId=1153&lastDate=2025-06-05T15%3A47%3A10&pageSize=10 - null null
2025-06-05 18:47:10.168 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:47:10.169 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions'
2025-06-05 18:47:10.171 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)' with route pattern 'api/Transactions' is valid for the request path '/api/Transactions'
2025-06-05 18:47:10.173 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)'
2025-06-05 18:47:10.175 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:10.176 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:10.177 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)'
2025-06-05 18:47:10.184 +03:00 [INF] Route matched with {action = "GetTransactions", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO]]] GetTransactions(Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 18:47:10.186 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:10.189 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:10.191 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:10.192 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:10.194 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:10.196 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:47:10.199 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:47:10.205 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO' ...
2025-06-05 18:47:10.207 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO' using the name '' in request data ...
2025-06-05 18:47:10.211 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-06-05 18:47:10.214 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.userId' of type 'System.Int32'.
2025-06-05 18:47:10.216 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.lastDate' of type 'System.Nullable`1[System.DateTime]' using the name 'lastDate' in request data ...
2025-06-05 18:47:10.219 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.lastDate' of type 'System.Nullable`1[System.DateTime]'.
2025-06-05 18:47:10.221 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-06-05 18:47:10.223 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.pageSize' of type 'System.Int32'.
2025-06-05 18:47:10.225 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO'.
2025-06-05 18:47:10.227 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO'.
2025-06-05 18:47:10.228 +03:00 [DBG] Attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO' ...
2025-06-05 18:47:10.230 +03:00 [DBG] Done attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO'.
2025-06-05 18:47:10.257 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:47:10.262 +03:00 [DBG] Compiling query expression: 
'DbSet<Transaction>()
    .Where(t => t.UserId == __userId_0)
    .OrderByDescending(t => t.Date)
    .Where(t => t.Date < __lastDate_Value_1)
    .OrderByDescending(t => t.Date)
    .Take(__p_2)'
2025-06-05 18:47:10.313 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Transaction>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Transaction.CategoryId (int) Required FK Index, 1], [Property: Transaction.Date (DateTime) Required, 2], [Property: Transaction.InnerCategoryId (int?) FK Index, 3], [Property: Transaction.Name (string) Required MaxLength(50), 4], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 5], [Property: Transaction.UserId (int) Required FK Index, 6] }
        SELECT TOP(@__p_2) t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        WHERE (t.user_fk == @__userId_0) && (t.date < @__lastDate_Value_1)
        ORDER BY t.date DESC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Transaction.CategoryId (int) Required FK Index, 1], [Property: Transaction.Date (DateTime) Required, 2], [Property: Transaction.InnerCategoryId (int?) FK Index, 3], [Property: Transaction.Name (string) Required MaxLength(50), 4], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 5], [Property: Transaction.UserId (int) Required FK Index, 6] }
        SELECT TOP(@__p_2) t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        WHERE (t.user_fk == @__userId_0) && (t.date < @__lastDate_Value_1)
        ORDER BY t.date DESC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Transaction entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Transaction instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Transaction);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Transaction.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Transaction)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]: 
                        {
                            return 
                            {
                                Transaction instance;
                                instance = new Transaction();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(1);
                                instance.<Date>k__BackingField = dataReader.GetDateTime(2);
                                instance.<InnerCategoryId>k__BackingField = dataReader.IsDBNull(3) ? default(int?) : (int?)dataReader.GetInt32(3);
                                instance.<Name>k__BackingField = dataReader.GetString(4);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(5);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(6);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Transaction)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 18:47:10.327 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:47:10.330 +03:00 [DBG] Created DbConnection. (3ms).
2025-06-05 18:47:10.335 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.337 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.339 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:47:10.340 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:47:10.344 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-06-05 18:47:10.346 +03:00 [DBG] Executing DbCommand [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__lastDate_Value_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
WHERE [t].[user_fk] = @__userId_0 AND [t].[date] < @__lastDate_Value_1
ORDER BY [t].[date] DESC
2025-06-05 18:47:10.432 +03:00 [INF] Executed DbCommand (86ms) [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__lastDate_Value_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
WHERE [t].[user_fk] = @__userId_0 AND [t].[date] < @__lastDate_Value_1
ORDER BY [t].[date] DESC
2025-06-05 18:47:10.438 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.440 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.442 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.444 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.446 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.448 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.452 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.456 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.459 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.461 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.463 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.465 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 27ms reading results.
2025-06-05 18:47:10.469 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.471 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 18:47:10.478 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:10.480 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:10.482 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:10.484 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:10.485 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:10.486 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:10.487 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 18:47:10.492 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend) in 295.9851ms
2025-06-05 18:47:10.493 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)'
2025-06-05 18:47:10.495 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:47:10.496 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:47:10.498 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.499 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 18:47:10.501 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Transactions?userId=1153&lastDate=2025-06-05T15%3A47%3A10&pageSize=10 - 200 1345 application/json; charset=utf-8 336.8553ms
2025-06-05 18:47:10.520 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Savings?userId=1153&previousSavingId=1&pageSize=5 - null null
2025-06-05 18:47:10.523 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:47:10.524 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 18:47:10.525 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 18:47:10.527 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)'
2025-06-05 18:47:10.528 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:10.533 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:10.535 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)'
2025-06-05 18:47:10.540 +03:00 [INF] Route matched with {action = "GetSavings", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingDTO]]] GetSavings(Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 18:47:10.542 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:10.544 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:10.545 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:10.546 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:10.548 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:10.549 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 18:47:10.551 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 18:47:10.553 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO' ...
2025-06-05 18:47:10.554 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO' using the name '' in request data ...
2025-06-05 18:47:10.556 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-06-05 18:47:10.558 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.userId' of type 'System.Int32'.
2025-06-05 18:47:10.559 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.previousSavingId' of type 'System.Int32' using the name 'previousSavingId' in request data ...
2025-06-05 18:47:10.560 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.previousSavingId' of type 'System.Int32'.
2025-06-05 18:47:10.563 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-06-05 18:47:10.565 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.pageSize' of type 'System.Int32'.
2025-06-05 18:47:10.567 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO'.
2025-06-05 18:47:10.570 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO'.
2025-06-05 18:47:10.572 +03:00 [DBG] Attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO' ...
2025-06-05 18:47:10.574 +03:00 [DBG] Done attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO'.
2025-06-05 18:47:10.586 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:47:10.590 +03:00 [DBG] Compiling query expression: 
'DbSet<Saving>()
    .Where(s => s.UserId == __userId_0 && s.Id > __previousSavingId_1)
    .Take(__p_2)'
2025-06-05 18:47:10.594 +03:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-06-05 18:47:10.602 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Saving>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
        SELECT TOP(@__p_2) s.id, s.current_amount, s.goal, s.name, s.user_fk
        FROM savings AS s
        WHERE (s.user_fk == @__userId_0) && (s.id > @__previousSavingId_1)) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
        SELECT TOP(@__p_2) s.id, s.current_amount, s.goal, s.name, s.user_fk
        FROM savings AS s
        WHERE (s.user_fk == @__userId_0) && (s.id > @__previousSavingId_1), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Saving entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Saving instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Saving);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Saving.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Saving)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]: 
                        {
                            return 
                            {
                                Saving instance;
                                instance = new Saving();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<CurrentAmount>k__BackingField = dataReader.GetDecimal(1);
                                instance.<Goal>k__BackingField = dataReader.GetDecimal(2);
                                instance.<Name>k__BackingField = dataReader.GetString(3);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(4);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Saving)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 18:47:10.607 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:47:10.608 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 18:47:10.610 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.612 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.614 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:47:10.616 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:47:10.619 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-06-05 18:47:10.621 +03:00 [DBG] Executing DbCommand [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__previousSavingId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[user_fk] = @__userId_0 AND [s].[id] > @__previousSavingId_1
2025-06-05 18:47:10.628 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__previousSavingId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[user_fk] = @__userId_0 AND [s].[id] > @__previousSavingId_1
2025-06-05 18:47:10.631 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.633 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.636 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.638 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:10.641 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.642 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 11ms reading results.
2025-06-05 18:47:10.644 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.646 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:47:10.653 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:10.657 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:10.659 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:10.660 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:10.661 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:10.662 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:10.664 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 18:47:10.670 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend) in 121.1964ms
2025-06-05 18:47:10.676 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)'
2025-06-05 18:47:10.679 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:47:10.681 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:47:10.683 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.688 +03:00 [DBG] Disposed connection to database '' on server '' (5ms).
2025-06-05 18:47:10.692 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Savings?userId=1153&previousSavingId=1&pageSize=5 - 200 327 application/json; charset=utf-8 172.2932ms
2025-06-05 18:47:10.697 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Analytics/overview?userId=1153&minDate=2025-05-29T15%3A47%3A10&maxDate=2025-06-05T15%3A47%3A10 - null null
2025-06-05 18:47:10.701 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:47:10.703 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Analytics/overview'
2025-06-05 18:47:10.704 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)' with route pattern 'api/Analytics/overview' is valid for the request path '/api/Analytics/overview'
2025-06-05 18:47:10.707 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)'
2025-06-05 18:47:10.709 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:10.710 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:10.711 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)'
2025-06-05 18:47:10.718 +03:00 [INF] Route matched with {action = "GetAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryPercentDTO]]] GetAnalytics(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO) on controller Finance_Manager_Backend.Controllers.AnalyticsController (Finance_Manager_Backend).
2025-06-05 18:47:10.722 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:10.723 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:10.725 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:10.727 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:10.728 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:10.730 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AnalyticsController (Finance_Manager_Backend)
2025-06-05 18:47:10.733 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AnalyticsController (Finance_Manager_Backend)
2025-06-05 18:47:10.735 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO' ...
2025-06-05 18:47:10.736 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO' using the name '' in request data ...
2025-06-05 18:47:10.738 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-06-05 18:47:10.740 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.userId' of type 'System.Int32'.
2025-06-05 18:47:10.742 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.minDate' of type 'System.DateTime' using the name 'minDate' in request data ...
2025-06-05 18:47:10.744 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.minDate' of type 'System.DateTime'.
2025-06-05 18:47:10.746 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.maxDate' of type 'System.DateTime' using the name 'maxDate' in request data ...
2025-06-05 18:47:10.748 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.maxDate' of type 'System.DateTime'.
2025-06-05 18:47:10.750 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO'.
2025-06-05 18:47:10.751 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO'.
2025-06-05 18:47:10.753 +03:00 [DBG] Attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO' ...
2025-06-05 18:47:10.755 +03:00 [DBG] Done attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO'.
2025-06-05 18:47:10.766 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:47:10.772 +03:00 [DBG] Compiling query expression: 
'DbSet<Transaction>()
    .Where(s => s.UserId == __userId_0 && !(s.Category.IsIncome) && s.Date > __minDate_1 && s.Date < __maxDate_2)
    .GroupBy(s => s.Category)'
2025-06-05 18:47:10.912 +03:00 [DBG] Generated query execution expression: 
'queryContext => GroupBySingleQueryingEnumerable.Create<Category, Transaction>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
            1 -> 0
            2 -> 1
            3 -> 2
            4 -> 3
            5 -> 4
            6 -> 5
            7 -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Transaction.CategoryId (int) Required FK Index, 7], [Property: Transaction.Date (DateTime) Required, 8], [Property: Transaction.InnerCategoryId (int?) FK Index, 9], [Property: Transaction.Name (string) Required MaxLength(50), 10], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 11], [Property: Transaction.UserId (int) Required FK Index, 12] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk, t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        INNER JOIN categories AS c ON t.category_fk == c.id
        WHERE (((t.user_fk == @__userId_0) && Not(c.is_income)) && (t.date > @__minDate_1)) && (t.date < @__maxDate_2)
        ORDER BY c.id ASC, c.background_color ASC, c.icon_path ASC, c.is_income ASC, c.name ASC, c.parent_category_fk ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
            1 -> 0
            2 -> 1
            3 -> 2
            4 -> 3
            5 -> 4
            6 -> 5
            7 -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Transaction.CategoryId (int) Required FK Index, 7], [Property: Transaction.Date (DateTime) Required, 8], [Property: Transaction.InnerCategoryId (int?) FK Index, 9], [Property: Transaction.Name (string) Required MaxLength(50), 10], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 11], [Property: Transaction.UserId (int) Required FK Index, 12] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk, t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        INNER JOIN categories AS c ON t.category_fk == c.id
        WHERE (((t.user_fk == @__userId_0) && Not(c.is_income)) && (t.date > @__minDate_1)) && (t.date < @__maxDate_2)
        ORDER BY c.id ASC, c.background_color ASC, c.icon_path ASC, c.is_income ASC, c.name ASC, c.parent_category_fk ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    keySelector: (queryContext, dataReader) => 
    {
        MaterializationContext materializationContext1;
        IEntityType entityType1;
        Category instance1;
        InternalEntityEntry entry1;
        bool hasNullKey1;
        materializationContext1 = new MaterializationContext(
            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
            queryContext.Context
        );
        instance1 = default(Category);
        entry1 = queryContext.TryGetEntry(
            key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
            keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
            throwOnNullKey: True, 
            hasNullKey: hasNullKey1);
        !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
        {
            entityType1 = entry1.EntityType;
            return instance1 = (Category)entry1.Entity;
        } : 
        {
            ISnapshot shadowSnapshot1;
            shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
            entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
            instance1 = switch (entityType1)
            {
                case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                    {
                        return 
                        {
                            Category instance;
                            instance = new Category();
                            instance.<Id>k__BackingField = dataReader.GetInt32(0);
                            instance.<ColorForBackground>k__BackingField = dataReader.GetString(1);
                            instance.<Icon>k__BackingField = dataReader.GetString(2);
                            instance.<IsIncome>k__BackingField = dataReader.GetBoolean(3);
                            instance.<Name>k__BackingField = dataReader.GetString(4);
                            instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5);
                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                context: materializationContext1.Context, 
                                entity: instance, 
                                queryTrackingBehavior: TrackAll, 
                                structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                            return instance;
                        }}
                default: 
                    default(Category)
            }
            ;
            entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                entityType: entityType1, 
                entity: instance1, 
                snapshot: shadowSnapshot1);
            return instance1;
        } : default(void);
        return instance1;
    }, 
    keyIdentifier: (queryContext, dataReader) => new object[]
    { 
        (object)(int?)dataReader.GetInt32(0), 
        dataReader.GetString(1), 
        dataReader.GetString(2), 
        (object)(bool?)dataReader.GetBoolean(3), 
        dataReader.GetString(4), 
        (object)dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5) 
    }, 
    keyIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
    { 
        (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
        (left, right) => left == null ? right == null : right != null && (string)left == (string)right, 
        (left, right) => left == null ? right == null : right != null && (string)left == (string)right, 
        (left, right) => left == null ? right == null : right != null && (bool)left == (bool)right, 
        (left, right) => left == null ? right == null : right != null && (string)left == (string)right, 
        (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
    }], 
    elementSelector: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Transaction entity;
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Transaction instance2;
            InternalEntityEntry entry2;
            bool hasNullKey2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Transaction);
            entry2 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Transaction.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(6) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey2);
            !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
            {
                entityType2 = entry2.EntityType;
                return instance2 = (Transaction)entry2.Entity;
            } : 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]: 
                        {
                            return 
                            {
                                Transaction instance;
                                instance = new Transaction();
                                instance.<Id>k__BackingField = dataReader.GetInt32(6);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(7);
                                instance.<Date>k__BackingField = dataReader.GetDateTime(8);
                                instance.<InnerCategoryId>k__BackingField = dataReader.IsDBNull(9) ? default(int?) : (int?)dataReader.GetInt32(9);
                                instance.<Name>k__BackingField = dataReader.GetString(10);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(11);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Transaction)
                }
                ;
                entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType2, 
                    entity: instance2, 
                    snapshot: shadowSnapshot2);
                return instance2;
            } : default(void);
            return instance2;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 18:47:10.935 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:47:10.957 +03:00 [DBG] Created DbConnection. (22ms).
2025-06-05 18:47:10.958 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.959 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:10.967 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:47:10.969 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:47:10.975 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-06-05 18:47:10.981 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32), @__minDate_1='?' (DbType = DateTime2), @__maxDate_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
WHERE [t].[user_fk] = @__userId_0 AND [c].[is_income] = CAST(0 AS bit) AND [t].[date] > @__minDate_1 AND [t].[date] < @__maxDate_2
ORDER BY [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
2025-06-05 18:47:11.013 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@__userId_0='?' (DbType = Int32), @__minDate_1='?' (DbType = DateTime2), @__maxDate_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
WHERE [t].[user_fk] = @__userId_0 AND [c].[is_income] = CAST(0 AS bit) AND [t].[date] > @__minDate_1 AND [t].[date] < @__maxDate_2
ORDER BY [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
2025-06-05 18:47:11.017 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:11.019 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 18:47:11.021 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:11.022 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:47:11.029 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:11.032 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:11.033 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:11.036 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:11.037 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:11.038 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:11.040 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryPercentDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 18:47:11.043 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend) in 312.5411ms
2025-06-05 18:47:11.046 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)'
2025-06-05 18:47:11.047 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:47:11.048 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:47:11.049 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:11.051 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 18:47:11.053 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Analytics/overview?userId=1153&minDate=2025-05-29T15%3A47%3A10&maxDate=2025-06-05T15%3A47%3A10 - 200 2 application/json; charset=utf-8 356.1704ms
2025-06-05 18:47:16.586 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Transactions - application/json-patch+json 124
2025-06-05 18:47:16.593 +03:00 [DBG] POST requests are not supported
2025-06-05 18:47:16.595 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions'
2025-06-05 18:47:16.598 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)' with route pattern 'api/Transactions' is valid for the request path '/api/Transactions'
2025-06-05 18:47:16.602 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:16.605 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:16.610 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:16.619 +03:00 [DBG] Authorization was successful.
2025-06-05 18:47:16.621 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:16.627 +03:00 [INF] Route matched with {action = "CreateTransaction", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Int32]] CreateTransaction(Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 18:47:16.630 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:16.631 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:16.633 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:16.635 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:16.637 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:16.639 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:47:16.641 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:47:16.642 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 18:47:16.644 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' using the name '' in request data ...
2025-06-05 18:47:16.645 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:47:16.647 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:47:16.648 +03:00 [DBG] Connection id "0HND490OUORBS", Request id "0HND490OUORBS:00000008": started reading request body.
2025-06-05 18:47:16.649 +03:00 [DBG] Connection id "0HND490OUORBS", Request id "0HND490OUORBS:00000008": done reading request body.
2025-06-05 18:47:16.660 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 18:47:16.661 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 18:47:16.662 +03:00 [DBG] Attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 18:47:16.667 +03:00 [DBG] Done attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 18:47:16.737 +03:00 [ERR] Validation failed. Errors: ["{ Field = Name, Error = Transaction name can't be empty. }","{ Field = Price, Error = 'Price' must not be empty. }","{ Field = Price, Error = 'Price' must be greater than '0'. }","{ Field = CategoryId, Error = 'Category Id' must not be empty. }","{ Field = CategoryId, Error = Transaction category id must be greater than 0. }"]
2025-06-05 18:47:16.740 +03:00 [DBG] Request was short circuited at action filter 'Finance_Manager_Backend.Middleware.ValidationFilter'.
2025-06-05 18:47:16.742 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:16.744 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:16.745 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:16.747 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:16.747 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:16.748 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:16.750 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Finance_Manager_Backend.Middleware.ErrorResponse'.
2025-06-05 18:47:16.752 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend) in 113.1969ms
2025-06-05 18:47:16.754 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:16.755 +03:00 [DBG] Connection id "0HND490OUORBT" accepted.
2025-06-05 18:47:16.756 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:47:16.757 +03:00 [DBG] Connection id "0HND490OUORBT" started.
2025-06-05 18:47:16.758 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Transactions - 400 255 application/json; charset=utf-8 172.2425ms
2025-06-05 18:47:16.761 +03:00 [DBG] Connection 0HND490OUORBT established using the following protocol: "Tls12"
2025-06-05 18:47:16.763 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1153 - null null
2025-06-05 18:47:16.766 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:47:16.767 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1153'
2025-06-05 18:47:16.768 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1153'
2025-06-05 18:47:16.770 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:16.771 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:16.772 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:16.773 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:16.774 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 18:47:16.776 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:16.778 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:16.779 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:16.781 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:16.783 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:16.784 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:47:16.786 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:47:16.787 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:16.789 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:47:16.790 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:16.792 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:16.793 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:16.794 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:16.796 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:16.798 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:16.800 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:16.801 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:16.802 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:16.803 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:16.804 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 18:47:16.806 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 21.1892ms
2025-06-05 18:47:16.807 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:16.808 +03:00 [DBG] Connection id "0HND490OUORBT" completed keep alive response.
2025-06-05 18:47:16.809 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1153 - 200 105 application/json; charset=utf-8 45.7159ms
2025-06-05 18:47:37.256 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Transactions - application/json-patch+json 133
2025-06-05 18:47:37.260 +03:00 [DBG] POST requests are not supported
2025-06-05 18:47:37.261 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions'
2025-06-05 18:47:37.262 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)' with route pattern 'api/Transactions' is valid for the request path '/api/Transactions'
2025-06-05 18:47:37.263 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:37.265 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:37.266 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:37.269 +03:00 [DBG] Authorization was successful.
2025-06-05 18:47:37.270 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:37.271 +03:00 [INF] Route matched with {action = "CreateTransaction", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Int32]] CreateTransaction(Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 18:47:37.273 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:37.276 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:37.278 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:37.280 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:37.282 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:37.283 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:47:37.288 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:47:37.290 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 18:47:37.292 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' using the name '' in request data ...
2025-06-05 18:47:37.294 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:47:37.295 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:47:37.296 +03:00 [DBG] Connection id "0HND490OUORBS", Request id "0HND490OUORBS:00000009": started reading request body.
2025-06-05 18:47:37.297 +03:00 [DBG] Connection id "0HND490OUORBS", Request id "0HND490OUORBS:00000009": done reading request body.
2025-06-05 18:47:37.299 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 18:47:37.300 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 18:47:37.301 +03:00 [DBG] Attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 18:47:37.303 +03:00 [DBG] Done attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 18:47:37.307 +03:00 [ERR] Validation failed. Errors: ["{ Field = Price, Error = 'Price' must be greater than '0'. }"]
2025-06-05 18:47:37.308 +03:00 [DBG] Request was short circuited at action filter 'Finance_Manager_Backend.Middleware.ValidationFilter'.
2025-06-05 18:47:37.310 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:37.312 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:37.314 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:37.316 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:37.316 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:37.317 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:37.319 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Finance_Manager_Backend.Middleware.ErrorResponse'.
2025-06-05 18:47:37.321 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend) in 37.3719ms
2025-06-05 18:47:37.322 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1153 - null null
2025-06-05 18:47:37.322 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:37.325 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:47:37.326 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:47:37.327 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1153'
2025-06-05 18:47:37.328 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Transactions - 400 73 application/json; charset=utf-8 72.012ms
2025-06-05 18:47:37.329 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1153'
2025-06-05 18:47:37.335 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:37.337 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:37.337 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:37.338 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:37.340 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 18:47:37.342 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:37.343 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:37.345 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:37.347 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:37.348 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:37.350 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:47:37.352 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:47:37.353 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:37.355 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:47:37.357 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:37.358 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:37.360 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:37.361 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:37.362 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:37.365 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:37.367 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:37.368 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:37.369 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:37.370 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:37.371 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 18:47:37.373 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 22.954ms
2025-06-05 18:47:37.377 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:37.385 +03:00 [DBG] Connection id "0HND490OUORBT" completed keep alive response.
2025-06-05 18:47:37.387 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1153 - 200 105 application/json; charset=utf-8 64.9394ms
2025-06-05 18:47:42.054 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Transactions - application/json-patch+json 132
2025-06-05 18:47:42.058 +03:00 [DBG] POST requests are not supported
2025-06-05 18:47:42.060 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions'
2025-06-05 18:47:42.061 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)' with route pattern 'api/Transactions' is valid for the request path '/api/Transactions'
2025-06-05 18:47:42.063 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:42.065 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:42.065 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:42.067 +03:00 [DBG] Authorization was successful.
2025-06-05 18:47:42.069 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:42.070 +03:00 [INF] Route matched with {action = "CreateTransaction", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Int32]] CreateTransaction(Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 18:47:42.071 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:42.073 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:42.075 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:42.077 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:42.078 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:42.080 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:47:42.082 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:47:42.085 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 18:47:42.091 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' using the name '' in request data ...
2025-06-05 18:47:42.093 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:47:42.094 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:47:42.095 +03:00 [DBG] Connection id "0HND490OUORBS", Request id "0HND490OUORBS:0000000A": started reading request body.
2025-06-05 18:47:42.097 +03:00 [DBG] Connection id "0HND490OUORBS", Request id "0HND490OUORBS:0000000A": done reading request body.
2025-06-05 18:47:42.098 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 18:47:42.100 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 18:47:42.101 +03:00 [DBG] Attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 18:47:42.103 +03:00 [DBG] Done attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 18:47:42.107 +03:00 [INF] Executing CreateTransactionAsync method.
2025-06-05 18:47:42.110 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 18:47:42.154 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:47:42.169 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:47:42.170 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 18:47:42.171 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:42.172 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:42.174 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 18:47:42.175 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 18:47:42.176 +03:00 [DBG] Start db transaction.
2025-06-05 18:47:42.179 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:42.184 +03:00 [DBG] Compiling query expression: 
'DbSet<Category>()
    .FirstOrDefault(t => t.Id == __categoryId_0)'
2025-06-05 18:47:42.190 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Category>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Category>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
            SELECT TOP(1) c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
            FROM categories AS c
            WHERE c.id == @__categoryId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
            SELECT TOP(1) c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
            FROM categories AS c
            WHERE c.id == @__categoryId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Category entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Category instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Category);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Category)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<ColorForBackground>k__BackingField = dataReader.GetString(1);
                                    instance.<Icon>k__BackingField = dataReader.GetString(2);
                                    instance.<IsIncome>k__BackingField = dataReader.GetBoolean(3);
                                    instance.<Name>k__BackingField = dataReader.GetString(4);
                                    instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 18:47:42.196 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:47:42.197 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:47:42.198 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 18:47:42.199 +03:00 [DBG] Executing DbCommand [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
WHERE [c].[id] = @__categoryId_0
2025-06-05 18:47:42.237 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
WHERE [c].[id] = @__categoryId_0
2025-06-05 18:47:42.240 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:42.242 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:42.244 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 4ms reading results.
2025-06-05 18:47:42.246 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:42.249 +03:00 [DBG] The navigation 'Transaction.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:42.250 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:42.252 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 18:47:42.253 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 18:47:42.254 +03:00 [DBG] The unchanged property 'User.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:47:42.256 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:42.258 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 18:47:42.261 +03:00 [DBG] Executing 2 update commands as a batch.
2025-06-05 18:47:42.264 +03:00 [DBG] Creating transaction savepoint.
2025-06-05 18:47:42.329 +03:00 [DBG] Created transaction savepoint.
2025-06-05 18:47:42.330 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:47:42.332 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:47:42.333 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 18:47:42.335 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (Size = 50), @p4='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = Int32), @p7='?' (DbType = Int32), @p6='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [transactions] ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [users] SET [balance] = @p6
OUTPUT 1
WHERE [id] = @p7;
2025-06-05 18:47:42.384 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (Size = 50), @p4='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = Int32), @p7='?' (DbType = Int32), @p6='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [transactions] ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [users] SET [balance] = @p6
OUTPUT 1
WHERE [id] = @p7;
2025-06-05 18:47:42.386 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 18:47:42.388 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:42.389 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 18:47:42.391 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:42.393 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:42.395 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-06-05 18:47:42.397 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 18:47:42.398 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 18:47:42.399 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 18:47:42.400 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 0 entities written to the database.
2025-06-05 18:47:42.402 +03:00 [DBG] Committing transaction.
2025-06-05 18:47:42.418 +03:00 [DBG] Committed transaction.
2025-06-05 18:47:42.419 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:42.421 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:47:42.422 +03:00 [INF] Transaction successful.
2025-06-05 18:47:42.424 +03:00 [DBG] Disposing transaction.
2025-06-05 18:47:42.426 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:42.429 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:42.431 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:42.433 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:42.433 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:42.434 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:42.436 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'System.Int32'.
2025-06-05 18:47:42.456 +03:00 [DBG] Found the endpoints ["Finance_Manager_Backend.Controllers.TransactionsController.GetTransactionById (Finance_Manager_Backend)"] for address (id=[2780],action=[GetTransactionById],controller=[Transactions])
2025-06-05 18:47:42.460 +03:00 [DBG] Successfully processed template api/Transactions/{id} for Finance_Manager_Backend.Controllers.TransactionsController.GetTransactionById (Finance_Manager_Backend) resulting in /api/Transactions/2780 and 
2025-06-05 18:47:42.464 +03:00 [DBG] Link generation succeeded for endpoints ["Finance_Manager_Backend.Controllers.TransactionsController.GetTransactionById (Finance_Manager_Backend)"] with result /api/Transactions/2780
2025-06-05 18:47:42.466 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend) in 386.3349ms
2025-06-05 18:47:42.467 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1153 - null null
2025-06-05 18:47:42.469 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:42.471 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:47:42.472 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:47:42.473 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1153'
2025-06-05 18:47:42.474 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:47:42.476 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1153'
2025-06-05 18:47:42.477 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:42.479 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:42.480 +03:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-06-05 18:47:42.481 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:42.483 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Transactions - 201 4 application/json; charset=utf-8 428.2462ms
2025-06-05 18:47:42.483 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:42.488 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:42.489 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 18:47:42.491 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:42.492 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:42.494 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:42.496 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:42.498 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:42.499 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:47:42.500 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:47:42.502 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:42.503 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:47:42.504 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:42.506 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:42.507 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:42.508 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:42.511 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:42.513 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:42.515 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:42.517 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:42.518 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:42.519 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:42.520 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 18:47:42.522 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 23.0238ms
2025-06-05 18:47:42.540 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:42.541 +03:00 [DBG] Connection id "0HND490OUORBT" completed keep alive response.
2025-06-05 18:47:42.543 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1153 - 200 104 application/json; charset=utf-8 75.1636ms
2025-06-05 18:47:46.566 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:49464/api/Transactions/2780 - null null
2025-06-05 18:47:46.570 +03:00 [DBG] DELETE requests are not supported
2025-06-05 18:47:46.571 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions/2780'
2025-06-05 18:47:46.572 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)' with route pattern 'api/Transactions/{id}' is valid for the request path '/api/Transactions/2780'
2025-06-05 18:47:46.574 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:46.576 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:46.577 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:46.579 +03:00 [DBG] Authorization was successful.
2025-06-05 18:47:46.580 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:46.584 +03:00 [INF] Route matched with {action = "DeleteTransaction", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] DeleteTransaction(Int32) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 18:47:46.586 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:46.587 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:46.588 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:46.591 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:46.593 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:46.594 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:47:46.595 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:47:46.597 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:46.598 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:47:46.600 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:46.601 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:46.602 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:46.603 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:46.605 +03:00 [INF] Executing DeleteTransactionAsync method.
2025-06-05 18:47:46.606 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 18:47:46.607 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:47:46.611 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:47:46.612 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 18:47:46.613 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:46.615 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:46.616 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 18:47:46.618 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 18:47:46.619 +03:00 [DBG] Start db transaction.
2025-06-05 18:47:46.624 +03:00 [DBG] Compiling query expression: 
'DbSet<Transaction>()
    .Include(t => t.Category)
    .Include(t => t.InnerCategory)
    .FirstOrDefault(t => t.Id == __transactionId_0)'
2025-06-05 18:47:46.629 +03:00 [DBG] Including navigation: 'Transaction.Category'.
2025-06-05 18:47:46.632 +03:00 [DBG] Including navigation: 'Transaction.InnerCategory'.
2025-06-05 18:47:46.691 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Transaction>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Transaction>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Transaction.CategoryId (int) Required FK Index, 1], [Property: Transaction.Date (DateTime) Required, 2], [Property: Transaction.InnerCategoryId (int?) FK Index, 3], [Property: Transaction.Name (string) Required MaxLength(50), 4], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 5], [Property: Transaction.UserId (int) Required FK Index, 6] }
                1 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Category.ColorForBackground (string) Required MaxLength(7), 8], [Property: Category.Icon (string) Required MaxLength(100), 9], [Property: Category.IsIncome (bool) Required, 10], [Property: Category.Name (string) Required MaxLength(50), 11], [Property: Category.ParentCategoryId (int?) FK Index, 12] }
                2 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Category.ColorForBackground (string) Required MaxLength(7), 14], [Property: Category.Icon (string) Required MaxLength(100), 15], [Property: Category.IsIncome (bool) Required, 16], [Property: Category.Name (string) Required MaxLength(50), 17], [Property: Category.ParentCategoryId (int?) FK Index, 18] }
            SELECT TOP(1) t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk, c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk, c0.id, c0.background_color, c0.icon_path, c0.is_income, c0.name, c0.parent_category_fk
            FROM transactions AS t
            INNER JOIN categories AS c ON t.category_fk == c.id
            LEFT JOIN categories AS c0 ON t.inner_category_fk == c0.id
            WHERE t.id == @__transactionId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Transaction.CategoryId (int) Required FK Index, 1], [Property: Transaction.Date (DateTime) Required, 2], [Property: Transaction.InnerCategoryId (int?) FK Index, 3], [Property: Transaction.Name (string) Required MaxLength(50), 4], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 5], [Property: Transaction.UserId (int) Required FK Index, 6] }
                1 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Category.ColorForBackground (string) Required MaxLength(7), 8], [Property: Category.Icon (string) Required MaxLength(100), 9], [Property: Category.IsIncome (bool) Required, 10], [Property: Category.Name (string) Required MaxLength(50), 11], [Property: Category.ParentCategoryId (int?) FK Index, 12] }
                2 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Category.ColorForBackground (string) Required MaxLength(7), 14], [Property: Category.Icon (string) Required MaxLength(100), 15], [Property: Category.IsIncome (bool) Required, 16], [Property: Category.Name (string) Required MaxLength(50), 17], [Property: Category.ParentCategoryId (int?) FK Index, 18] }
            SELECT TOP(1) t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk, c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk, c0.id, c0.background_color, c0.icon_path, c0.is_income, c0.name, c0.parent_category_fk
            FROM transactions AS t
            INNER JOIN categories AS c ON t.category_fk == c.id
            LEFT JOIN categories AS c0 ON t.inner_category_fk == c0.id
            WHERE t.id == @__transactionId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Transaction entity;
            Category entity;
            Category entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Transaction instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Transaction);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Transaction.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Transaction)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]: 
                            {
                                return 
                                {
                                    Transaction instance;
                                    instance = new Transaction();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CategoryId>k__BackingField = dataReader.GetInt32(1);
                                    instance.<Date>k__BackingField = dataReader.GetDateTime(2);
                                    instance.<InnerCategoryId>k__BackingField = dataReader.IsDBNull(3) ? default(int?) : (int?)dataReader.GetInt32(3);
                                    instance.<Name>k__BackingField = dataReader.GetString(4);
                                    instance.<Price>k__BackingField = dataReader.GetDecimal(5);
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(6);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Transaction)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Category instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Category);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(7) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Category)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(7);
                                    instance.<ColorForBackground>k__BackingField = dataReader.GetString(8);
                                    instance.<Icon>k__BackingField = dataReader.GetString(9);
                                    instance.<IsIncome>k__BackingField = dataReader.GetBoolean(10);
                                    instance.<Name>k__BackingField = dataReader.GetString(11);
                                    instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                Category instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(Category);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (Category)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<Id>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                    instance.<ColorForBackground>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                    instance.<Icon>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                    instance.<IsIncome>k__BackingField = dataReader.IsDBNull(16) ? default(bool) : dataReader.GetBoolean(16);
                                    instance.<Name>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                    instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(18) ? default(int?) : (int?)dataReader.GetInt32(18);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<Transaction, Transaction, Category>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Transaction.Category (Category) ToPrincipal Category | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindNavigation("Category")], 
                inverseNavigation: default(INavigation), 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    return namelessParameter{10}.<Category>k__BackingField = namelessParameter{11};
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<Transaction, Transaction, Category>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Transaction.InnerCategory (Category) ToPrincipal Category | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindNavigation("InnerCategory")], 
                inverseNavigation: default(INavigation), 
                fixup: (namelessParameter{13}, namelessParameter{14}) => 
                {
                    return namelessParameter{13}.<InnerCategory>k__BackingField = namelessParameter{14};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 18:47:46.704 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:47:46.706 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:47:46.707 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 18:47:46.709 +03:00 [DBG] Executing DbCommand [Parameters=[@__transactionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk], [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [c0].[id], [c0].[background_color], [c0].[icon_path], [c0].[is_income], [c0].[name], [c0].[parent_category_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
LEFT JOIN [categories] AS [c0] ON [t].[inner_category_fk] = [c0].[id]
WHERE [t].[id] = @__transactionId_0
2025-06-05 18:47:46.729 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[@__transactionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk], [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [c0].[id], [c0].[background_color], [c0].[icon_path], [c0].[is_income], [c0].[name], [c0].[parent_category_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
LEFT JOIN [categories] AS [c0] ON [t].[inner_category_fk] = [c0].[id]
WHERE [t].[id] = @__transactionId_0
2025-06-05 18:47:46.735 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:46.738 +03:00 [DBG] The navigation 'Transaction.Category' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:46.740 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:46.742 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:46.743 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 7ms reading results.
2025-06-05 18:47:46.746 +03:00 [DBG] The navigation 'Transaction.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:46.748 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:47:46.761 +03:00 [ERR] Failed transaction: The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
2025-06-05 18:47:46.765 +03:00 [DBG] Rolling back transaction.
2025-06-05 18:47:46.768 +03:00 [DBG] Rolled back transaction.
2025-06-05 18:47:46.769 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:46.770 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:47:46.772 +03:00 [DBG] Disposing transaction.
2025-06-05 18:47:46.774 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend) in 179.568ms
2025-06-05 18:47:46.775 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 18:47:46.776 +03:00 [ERR] The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState[TEntity](TEntity entity, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.Attach[TEntity](TEntity entity)
   at Finance_Manager_Backend.BusinessLogic.Services.TransactionsService.<>c__DisplayClass12_0.<<DeleteTransactionAsync>b__0>d.MoveNext() in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\TransactionsService.cs:line 139
--- End of stack trace from previous location ---
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 31
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 51
   at Finance_Manager_Backend.BusinessLogic.Services.TransactionsService.DeleteTransactionAsync(Int32 transactionId) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\TransactionsService.cs:line 133
   at Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction(Int32 id) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\TransactionsController.cs:line 136
   at lambda_method681(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-06-05 18:47:46.788 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:47:46.790 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1153 - null null
2025-06-05 18:47:46.790 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:47:46.793 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:47:46.794 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:47:46.795 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1153'
2025-06-05 18:47:46.797 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 18:47:46.797 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1153'
2025-06-05 18:47:46.799 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:49464/api/Transactions/2780 - 400 null application/json 233.3474ms
2025-06-05 18:47:46.801 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:46.805 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:47:46.806 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:47:46.807 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:46.808 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 18:47:46.810 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:47:46.812 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:47:46.813 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:47:46.816 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:47:46.817 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:47:46.819 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:47:46.820 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:47:46.822 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:46.823 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:47:46.825 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:46.826 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:46.828 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:47:46.829 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:47:46.830 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:47:46.832 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:47:46.834 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:47:46.835 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:47:46.836 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:47:46.837 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:47:46.838 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 18:47:46.840 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 21.0186ms
2025-06-05 18:47:46.841 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:47:46.842 +03:00 [DBG] Connection id "0HND490OUORBT" completed keep alive response.
2025-06-05 18:47:46.842 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1153 - 200 104 application/json; charset=utf-8 52.7908ms
2025-06-05 18:48:15.635 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:49464/api/Transactions/2780 - null null
2025-06-05 18:48:15.640 +03:00 [DBG] DELETE requests are not supported
2025-06-05 18:48:15.641 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions/2780'
2025-06-05 18:48:15.642 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)' with route pattern 'api/Transactions/{id}' is valid for the request path '/api/Transactions/2780'
2025-06-05 18:48:15.643 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 18:48:15.645 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:48:15.646 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:48:15.647 +03:00 [DBG] Authorization was successful.
2025-06-05 18:48:15.647 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 18:48:15.648 +03:00 [INF] Route matched with {action = "DeleteTransaction", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] DeleteTransaction(Int32) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 18:48:15.650 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:48:15.652 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:48:15.655 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:48:15.657 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:48:15.658 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:48:15.660 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:48:15.661 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:48:15.663 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:48:15.664 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:48:15.666 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:48:15.672 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:48:15.673 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:48:15.679 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:48:15.680 +03:00 [INF] Executing DeleteTransactionAsync method.
2025-06-05 18:48:15.681 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 18:48:15.683 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:48:15.700 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:48:15.701 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 18:48:15.702 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:48:15.703 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:48:15.705 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 18:48:15.706 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 18:48:15.707 +03:00 [DBG] Start db transaction.
2025-06-05 18:48:15.708 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:48:15.709 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-05 18:48:15.710 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:48:15.711 +03:00 [DBG] Executing DbCommand [Parameters=[@__transactionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk], [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [c0].[id], [c0].[background_color], [c0].[icon_path], [c0].[is_income], [c0].[name], [c0].[parent_category_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
LEFT JOIN [categories] AS [c0] ON [t].[inner_category_fk] = [c0].[id]
WHERE [t].[id] = @__transactionId_0
2025-06-05 18:48:15.719 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__transactionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk], [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [c0].[id], [c0].[background_color], [c0].[icon_path], [c0].[is_income], [c0].[name], [c0].[parent_category_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
LEFT JOIN [categories] AS [c0] ON [t].[inner_category_fk] = [c0].[id]
WHERE [t].[id] = @__transactionId_0
2025-06-05 18:48:15.722 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:48:15.724 +03:00 [DBG] The navigation 'Transaction.Category' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:48:15.726 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:48:15.727 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:48:15.728 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 5ms reading results.
2025-06-05 18:48:15.730 +03:00 [DBG] The navigation 'Transaction.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:48:15.732 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:48:15.733 +03:00 [ERR] Failed transaction: The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
2025-06-05 18:48:15.734 +03:00 [DBG] Rolling back transaction.
2025-06-05 18:48:15.738 +03:00 [DBG] Rolled back transaction.
2025-06-05 18:48:15.739 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:48:15.741 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:48:15.742 +03:00 [DBG] Disposing transaction.
2025-06-05 18:48:15.744 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend) in 84.0619ms
2025-06-05 18:48:15.746 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 18:48:15.748 +03:00 [ERR] The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState[TEntity](TEntity entity, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.Attach[TEntity](TEntity entity)
   at Finance_Manager_Backend.BusinessLogic.Services.TransactionsService.<>c__DisplayClass12_0.<<DeleteTransactionAsync>b__0>d.MoveNext() in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\TransactionsService.cs:line 139
--- End of stack trace from previous location ---
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 31
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 51
   at Finance_Manager_Backend.BusinessLogic.Services.TransactionsService.DeleteTransactionAsync(Int32 transactionId) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\TransactionsService.cs:line 133
   at Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction(Int32 id) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\TransactionsController.cs:line 136
   at lambda_method681(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-06-05 18:48:15.761 +03:00 [DBG] Connection id "0HND490OUORBS" completed keep alive response.
2025-06-05 18:48:15.762 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:48:15.765 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1153 - null null
2025-06-05 18:48:15.777 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:48:15.788 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:48:15.790 +03:00 [DBG] Disposed connection to database '' on server '' (12ms).
2025-06-05 18:48:15.791 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1153'
2025-06-05 18:48:15.792 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:49464/api/Transactions/2780 - 400 null application/json 157.2976ms
2025-06-05 18:48:15.796 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1153'
2025-06-05 18:48:15.800 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:48:15.801 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:48:15.802 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:48:15.804 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:48:15.806 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 18:48:15.807 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:48:15.809 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:48:15.810 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:48:15.812 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:48:15.813 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:48:15.814 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:48:15.816 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:48:15.817 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:48:15.819 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:48:15.822 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:48:15.824 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:48:15.825 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:48:15.826 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:48:15.828 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:48:15.829 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:48:15.830 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:48:15.831 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:48:15.832 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:48:15.833 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:48:15.834 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 18:48:15.836 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 21.9007ms
2025-06-05 18:48:15.857 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:48:15.862 +03:00 [DBG] Connection id "0HND490OUORBT" completed keep alive response.
2025-06-05 18:48:15.863 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1153 - 200 104 application/json; charset=utf-8 97.8718ms
2025-06-05 18:49:09.914 +03:00 [DBG] HttpMessageHandler expired after 120000ms for client 'CurrencyConverterService'
2025-06-05 18:49:19.927 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:49:19.930 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0263ms - processed: 0 items - remaining: 1 items
2025-06-05 18:49:23.846 +03:00 [DBG] Connection id "0HND490OUORBT" received FIN.
2025-06-05 18:49:23.848 +03:00 [DBG] Connection id "0HND490OUORBS" received FIN.
2025-06-05 18:49:23.852 +03:00 [DBG] Connection id "0HND490OUORBT" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-05 18:49:23.854 +03:00 [DBG] Connection id "0HND490OUORBS" disconnecting.
2025-06-05 18:49:23.859 +03:00 [DBG] Connection id "0HND490OUORBT" disconnecting.
2025-06-05 18:49:23.861 +03:00 [DBG] Connection id "0HND490OUORBS" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-05 18:49:23.869 +03:00 [DBG] Connection id "0HND490OUORBT" stopped.
2025-06-05 18:49:23.876 +03:00 [DBG] Connection id "0HND490OUORBS" stopped.
2025-06-05 18:49:28.558 +03:00 [DBG] Connection id "0HND490OUORBU" accepted.
2025-06-05 18:49:28.561 +03:00 [DBG] Connection id "0HND490OUORBU" started.
2025-06-05 18:49:28.565 +03:00 [DBG] Connection 0HND490OUORBU established using the following protocol: "Tls12"
2025-06-05 18:49:28.567 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:49464/api/Transactions/2780 - null null
2025-06-05 18:49:28.570 +03:00 [DBG] DELETE requests are not supported
2025-06-05 18:49:28.571 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions/2780'
2025-06-05 18:49:28.572 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)' with route pattern 'api/Transactions/{id}' is valid for the request path '/api/Transactions/2780'
2025-06-05 18:49:28.575 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 18:49:28.577 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:49:28.579 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:49:28.581 +03:00 [DBG] Authorization was successful.
2025-06-05 18:49:28.589 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 18:49:28.594 +03:00 [INF] Route matched with {action = "DeleteTransaction", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] DeleteTransaction(Int32) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 18:49:28.605 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:49:28.613 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:49:28.623 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:49:28.628 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:49:28.631 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:49:28.634 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:49:28.637 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 18:49:28.640 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:49:28.643 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:49:28.647 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:49:28.649 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:49:28.650 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:49:28.653 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:49:28.654 +03:00 [INF] Executing DeleteTransactionAsync method.
2025-06-05 18:49:28.656 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 18:49:28.658 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:49:28.661 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:49:28.663 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 18:49:28.665 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:49:28.666 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:49:28.668 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 18:49:28.670 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 18:49:28.671 +03:00 [DBG] Start db transaction.
2025-06-05 18:49:28.672 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:49:28.673 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:49:28.677 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-06-05 18:49:28.680 +03:00 [DBG] Executing DbCommand [Parameters=[@__transactionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk], [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [c0].[id], [c0].[background_color], [c0].[icon_path], [c0].[is_income], [c0].[name], [c0].[parent_category_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
LEFT JOIN [categories] AS [c0] ON [t].[inner_category_fk] = [c0].[id]
WHERE [t].[id] = @__transactionId_0
2025-06-05 18:49:28.688 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__transactionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk], [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [c0].[id], [c0].[background_color], [c0].[icon_path], [c0].[is_income], [c0].[name], [c0].[parent_category_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
LEFT JOIN [categories] AS [c0] ON [t].[inner_category_fk] = [c0].[id]
WHERE [t].[id] = @__transactionId_0
2025-06-05 18:49:28.692 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:49:28.695 +03:00 [DBG] The navigation 'Transaction.Category' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:49:28.698 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:49:28.701 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:49:28.704 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 12ms reading results.
2025-06-05 18:49:28.708 +03:00 [DBG] The navigation 'Transaction.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:49:28.711 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:49:28.715 +03:00 [ERR] Failed transaction: The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
2025-06-05 18:49:28.717 +03:00 [DBG] Rolling back transaction.
2025-06-05 18:49:28.719 +03:00 [DBG] Rolled back transaction.
2025-06-05 18:49:28.719 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:49:28.721 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:49:28.724 +03:00 [DBG] Disposing transaction.
2025-06-05 18:49:28.725 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend) in 91.7361ms
2025-06-05 18:49:28.727 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 18:49:28.729 +03:00 [ERR] The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState[TEntity](TEntity entity, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.Attach[TEntity](TEntity entity)
   at Finance_Manager_Backend.BusinessLogic.Services.TransactionsService.<>c__DisplayClass12_0.<<DeleteTransactionAsync>b__0>d.MoveNext() in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\TransactionsService.cs:line 139
--- End of stack trace from previous location ---
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 31
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 51
   at Finance_Manager_Backend.BusinessLogic.Services.TransactionsService.DeleteTransactionAsync(Int32 transactionId) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\TransactionsService.cs:line 133
   at Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction(Int32 id) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\TransactionsController.cs:line 136
   at lambda_method681(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-06-05 18:49:28.740 +03:00 [DBG] Connection id "0HND490OUORBU" completed keep alive response.
2025-06-05 18:49:28.742 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:49:28.743 +03:00 [DBG] Connection id "0HND490OUORBV" accepted.
2025-06-05 18:49:28.744 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:49:28.745 +03:00 [DBG] Connection id "0HND490OUORBV" started.
2025-06-05 18:49:28.747 +03:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-06-05 18:49:28.751 +03:00 [DBG] Connection 0HND490OUORBV established using the following protocol: "Tls12"
2025-06-05 18:49:28.752 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:49464/api/Transactions/2780 - 400 null application/json 184.0369ms
2025-06-05 18:49:28.756 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1153 - null null
2025-06-05 18:49:28.769 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:49:28.771 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1153'
2025-06-05 18:49:28.773 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1153'
2025-06-05 18:49:28.776 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:49:28.778 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:49:28.780 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:49:28.782 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:49:28.784 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 18:49:28.788 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:49:28.790 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:49:28.792 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:49:28.797 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:49:28.800 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:49:28.805 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:49:28.807 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:49:28.811 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:49:28.816 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:49:28.820 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:49:28.823 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:49:28.826 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:49:28.829 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:49:28.832 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:49:28.837 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:49:28.840 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:49:28.842 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:49:28.844 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:49:28.871 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:49:28.878 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 18:49:28.882 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 77.1161ms
2025-06-05 18:49:28.911 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:49:28.916 +03:00 [DBG] Connection id "0HND490OUORBV" completed keep alive response.
2025-06-05 18:49:28.919 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1153 - 200 104 application/json; charset=utf-8 163.3711ms
2025-06-05 18:49:29.945 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:49:29.946 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0083ms - processed: 0 items - remaining: 1 items
2025-06-05 18:49:39.956 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:49:39.957 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0032ms - processed: 0 items - remaining: 1 items
2025-06-05 18:49:49.971 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:49:49.979 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0039ms - processed: 0 items - remaining: 1 items
2025-06-05 18:49:59.998 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:50:00.003 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0044ms - processed: 0 items - remaining: 1 items
2025-06-05 18:50:10.017 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:50:10.021 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0034ms - processed: 0 items - remaining: 1 items
2025-06-05 18:50:20.036 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:50:20.038 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0032ms - processed: 0 items - remaining: 1 items
2025-06-05 18:50:30.054 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:50:30.056 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0034ms - processed: 0 items - remaining: 1 items
2025-06-05 18:50:38.881 +03:00 [DBG] Connection id "0HND490OUORBV" received FIN.
2025-06-05 18:50:38.882 +03:00 [DBG] Connection id "0HND490OUORBU" received FIN.
2025-06-05 18:50:38.884 +03:00 [DBG] Connection id "0HND490OUORBV" disconnecting.
2025-06-05 18:50:38.886 +03:00 [DBG] Connection id "0HND490OUORBU" disconnecting.
2025-06-05 18:50:38.887 +03:00 [DBG] Connection id "0HND490OUORBV" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-05 18:50:38.888 +03:00 [DBG] Connection id "0HND490OUORBU" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-05 18:50:38.896 +03:00 [DBG] Connection id "0HND490OUORBU" stopped.
2025-06-05 18:50:38.896 +03:00 [DBG] Connection id "0HND490OUORBV" stopped.
2025-06-05 18:50:40.063 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:50:40.199 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0124ms - processed: 0 items - remaining: 1 items
2025-06-05 18:50:50.210 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:50:50.213 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.003ms - processed: 0 items - remaining: 1 items
2025-06-05 18:51:00.221 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:51:00.224 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0032ms - processed: 0 items - remaining: 1 items
2025-06-05 18:51:10.231 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:51:10.234 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0029ms - processed: 0 items - remaining: 1 items
2025-06-05 18:51:20.247 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:51:20.248 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0026ms - processed: 0 items - remaining: 1 items
2025-06-05 18:51:28.648 +03:00 [DBG] HttpMessageHandler expired after 120000ms for client 'CurrencyConverterService'
2025-06-05 18:51:30.253 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:51:30.255 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.4265ms - processed: 1 items - remaining: 1 items
2025-06-05 18:51:40.259 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:51:40.262 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0035ms - processed: 0 items - remaining: 1 items
2025-06-05 18:51:50.274 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:51:50.275 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0028ms - processed: 0 items - remaining: 1 items
2025-06-05 18:52:00.280 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:52:00.282 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.003ms - processed: 0 items - remaining: 1 items
2025-06-05 18:52:10.295 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:52:10.297 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0033ms - processed: 0 items - remaining: 1 items
2025-06-05 18:52:20.313 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:52:20.314 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0033ms - processed: 0 items - remaining: 1 items
2025-06-05 18:52:30.319 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:52:30.320 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0033ms - processed: 0 items - remaining: 1 items
2025-06-05 18:52:37.219 +03:00 [DBG] Connection id "0HND490OUORC0" accepted.
2025-06-05 18:52:37.226 +03:00 [DBG] Connection id "0HND490OUORC0" started.
2025-06-05 18:52:37.230 +03:00 [DBG] Connection 0HND490OUORC0 established using the following protocol: "Tls12"
2025-06-05 18:52:37.233 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:49464/api/Savings - application/json-patch+json 48
2025-06-05 18:52:37.237 +03:00 [DBG] PUT requests are not supported
2025-06-05 18:52:37.239 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 18:52:37.259 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 18:52:37.264 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 18:52:37.266 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:52:37.267 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:52:37.269 +03:00 [DBG] Authorization was successful.
2025-06-05 18:52:37.271 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 18:52:37.278 +03:00 [INF] Route matched with {action = "UpdateSaving", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] UpdateSaving(Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 18:52:37.281 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:52:37.284 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:52:37.286 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:52:37.289 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:52:37.292 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:52:37.294 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 18:52:37.297 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 18:52:37.305 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 18:52:37.311 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' using the name '' in request data ...
2025-06-05 18:52:37.316 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:52:37.321 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:52:37.327 +03:00 [DBG] Connection id "0HND490OUORC0", Request id "0HND490OUORC0:00000001": started reading request body.
2025-06-05 18:52:37.330 +03:00 [DBG] Connection id "0HND490OUORC0", Request id "0HND490OUORC0:00000001": done reading request body.
2025-06-05 18:52:37.335 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 18:52:37.339 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 18:52:37.344 +03:00 [DBG] Attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 18:52:37.349 +03:00 [DBG] Done attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 18:52:37.355 +03:00 [ERR] Validation failed. Errors: ["{ Field = topUpAmount, Error = Top up amount must be greater than 0. }"]
2025-06-05 18:52:37.357 +03:00 [DBG] Request was short circuited at action filter 'Finance_Manager_Backend.Middleware.ValidationFilter'.
2025-06-05 18:52:37.359 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:52:37.363 +03:00 [DBG] No information found on request to perform content negotiation.
2025-06-05 18:52:37.365 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:52:37.366 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:52:37.368 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:52:37.370 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Finance_Manager_Backend.Middleware.ErrorResponse'.
2025-06-05 18:52:37.373 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend) in 78.7466ms
2025-06-05 18:52:37.376 +03:00 [DBG] Connection id "0HND490OUORC1" accepted.
2025-06-05 18:52:37.377 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 18:52:37.379 +03:00 [DBG] Connection id "0HND490OUORC1" started.
2025-06-05 18:52:37.381 +03:00 [DBG] Connection id "0HND490OUORC0" completed keep alive response.
2025-06-05 18:52:37.385 +03:00 [DBG] Connection 0HND490OUORC1 established using the following protocol: "Tls12"
2025-06-05 18:52:37.387 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:49464/api/Savings - 400 83 application/json; charset=utf-8 153.4912ms
2025-06-05 18:52:37.389 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1153 - null null
2025-06-05 18:52:37.398 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:52:37.399 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1153'
2025-06-05 18:52:37.401 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1153'
2025-06-05 18:52:37.404 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:52:37.407 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:52:37.408 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:52:37.412 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:52:37.414 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 18:52:37.416 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:52:37.418 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:52:37.420 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:52:37.423 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:52:37.425 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:52:37.428 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:52:37.430 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:52:37.433 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:52:37.435 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:52:37.437 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:52:37.440 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:52:37.443 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:52:37.445 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:52:37.447 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:52:37.451 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:52:37.454 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:52:37.456 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:52:37.458 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:52:37.459 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:52:37.461 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 18:52:37.464 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 36.0293ms
2025-06-05 18:52:37.468 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:52:37.472 +03:00 [DBG] Connection id "0HND490OUORC1" completed keep alive response.
2025-06-05 18:52:37.478 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1153 - 200 104 application/json; charset=utf-8 89.4116ms
2025-06-05 18:52:40.330 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:52:40.334 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0034ms - processed: 0 items - remaining: 1 items
2025-06-05 18:52:43.280 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:49464/api/Savings - application/json-patch+json 47
2025-06-05 18:52:43.289 +03:00 [DBG] PUT requests are not supported
2025-06-05 18:52:43.290 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 18:52:43.295 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 18:52:43.300 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 18:52:43.304 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:52:43.334 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:52:43.337 +03:00 [DBG] Authorization was successful.
2025-06-05 18:52:43.338 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 18:52:43.340 +03:00 [INF] Route matched with {action = "UpdateSaving", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] UpdateSaving(Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 18:52:43.345 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:52:43.347 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:52:43.350 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:52:43.355 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:52:43.357 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:52:43.359 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 18:52:43.361 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 18:52:43.363 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 18:52:43.366 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' using the name '' in request data ...
2025-06-05 18:52:43.369 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:52:43.373 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:52:43.375 +03:00 [DBG] Connection id "0HND490OUORC0", Request id "0HND490OUORC0:00000002": started reading request body.
2025-06-05 18:52:43.376 +03:00 [DBG] Connection id "0HND490OUORC0", Request id "0HND490OUORC0:00000002": done reading request body.
2025-06-05 18:52:43.378 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 18:52:43.380 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 18:52:43.382 +03:00 [DBG] Attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 18:52:43.383 +03:00 [DBG] Done attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 18:52:43.386 +03:00 [INF] Executing UdateSavingAsync method
2025-06-05 18:52:43.387 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 18:52:43.388 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:52:43.390 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:52:43.390 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 18:52:43.391 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:52:43.393 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:52:43.394 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 18:52:43.395 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 18:52:43.396 +03:00 [DBG] Start db transaction.
2025-06-05 18:52:43.399 +03:00 [DBG] Compiling query expression: 
'DbSet<Saving>()
    .FirstOrDefault(s => s.Id == __savingId_0)'
2025-06-05 18:52:43.404 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Saving>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Saving>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
            SELECT TOP(1) s.id, s.current_amount, s.goal, s.name, s.user_fk
            FROM savings AS s
            WHERE s.id == @__savingId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
            SELECT TOP(1) s.id, s.current_amount, s.goal, s.name, s.user_fk
            FROM savings AS s
            WHERE s.id == @__savingId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Saving entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Saving instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Saving);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Saving.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Saving)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]: 
                            {
                                return 
                                {
                                    Saving instance;
                                    instance = new Saving();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CurrentAmount>k__BackingField = dataReader.GetDecimal(1);
                                    instance.<Goal>k__BackingField = dataReader.GetDecimal(2);
                                    instance.<Name>k__BackingField = dataReader.GetString(3);
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(4);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Saving)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 18:52:43.407 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:52:43.408 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:52:43.410 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 18:52:43.411 +03:00 [DBG] Executing DbCommand [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 18:52:43.457 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 18:52:43.459 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:52:43.461 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:52:43.462 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 18:52:43.465 +03:00 [DBG] The navigation 'Saving.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:52:43.467 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:52:43.470 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:52:43.473 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:52:43.475 +03:00 [ERR] Failed transaction: The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
2025-06-05 18:52:43.476 +03:00 [DBG] Rolling back transaction.
2025-06-05 18:52:43.478 +03:00 [DBG] Rolled back transaction.
2025-06-05 18:52:43.478 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:52:43.480 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:52:43.482 +03:00 [DBG] Disposing transaction.
2025-06-05 18:52:43.484 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend) in 125.0496ms
2025-06-05 18:52:43.485 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 18:52:43.486 +03:00 [ERR] The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'Transaction' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState[TEntity](TEntity entity, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.Attach[TEntity](TEntity entity)
   at Finance_Manager_Backend.BusinessLogic.Services.SavingsService.<>c__DisplayClass10_0.<<UpdateSavingAsync>b__0>d.MoveNext() in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\SavingsService.cs:line 79
--- End of stack trace from previous location ---
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 31
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 51
   at Finance_Manager_Backend.BusinessLogic.Services.SavingsService.UpdateSavingAsync(Int32 savingId, Decimal topUpAmount) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\SavingsService.cs:line 71
   at Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving(SavingTopUpDTO topUpDTO) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\SavingsController.cs:line 112
   at lambda_method716(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-06-05 18:52:43.500 +03:00 [DBG] Connection id "0HND490OUORC0" completed keep alive response.
2025-06-05 18:52:43.501 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1153 - null null
2025-06-05 18:52:43.508 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:52:43.514 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:52:43.516 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:52:43.517 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1153'
2025-06-05 18:52:43.520 +03:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-06-05 18:52:43.523 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1153'
2025-06-05 18:52:43.526 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:49464/api/Savings - 400 null application/json 246.2321ms
2025-06-05 18:52:43.529 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:52:43.539 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:52:43.543 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:52:43.545 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:52:43.548 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 18:52:43.551 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:52:43.555 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:52:43.556 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:52:43.559 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:52:43.562 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:52:43.565 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:52:43.568 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:52:43.572 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:52:43.574 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:52:43.579 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:52:43.581 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:52:43.584 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:52:43.587 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:52:43.590 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:52:43.595 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:52:43.597 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:52:43.600 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:52:43.601 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:52:43.604 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:52:43.606 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 18:52:43.610 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 44.803ms
2025-06-05 18:52:43.621 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:52:43.631 +03:00 [DBG] Connection id "0HND490OUORC1" completed keep alive response.
2025-06-05 18:52:43.633 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1153 - 200 104 application/json; charset=utf-8 132.1256ms
2025-06-05 18:52:50.341 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:52:50.343 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0031ms - processed: 0 items - remaining: 1 items
2025-06-05 18:52:54.272 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:49464/api/Savings - application/json-patch+json 47
2025-06-05 18:52:54.275 +03:00 [DBG] PUT requests are not supported
2025-06-05 18:52:54.276 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 18:52:54.278 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 18:52:54.280 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 18:52:54.281 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:52:54.282 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:52:54.284 +03:00 [DBG] Authorization was successful.
2025-06-05 18:52:54.285 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 18:52:54.286 +03:00 [INF] Route matched with {action = "UpdateSaving", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] UpdateSaving(Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 18:52:54.288 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:52:54.289 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:52:54.290 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:52:54.292 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:52:54.294 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:52:54.295 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 18:52:54.297 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 18:52:54.298 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 18:52:54.300 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' using the name '' in request data ...
2025-06-05 18:52:54.303 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:52:54.304 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 18:52:54.305 +03:00 [DBG] Connection id "0HND490OUORC0", Request id "0HND490OUORC0:00000003": started reading request body.
2025-06-05 18:52:54.307 +03:00 [DBG] Connection id "0HND490OUORC0", Request id "0HND490OUORC0:00000003": done reading request body.
2025-06-05 18:52:54.309 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 18:52:54.311 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 18:52:54.313 +03:00 [DBG] Attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 18:52:54.316 +03:00 [DBG] Done attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 18:52:54.318 +03:00 [INF] Executing UdateSavingAsync method
2025-06-05 18:52:54.319 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 18:52:54.321 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 18:52:54.324 +03:00 [DBG] Creating DbConnection.
2025-06-05 18:52:54.324 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 18:52:54.326 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:52:54.327 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:52:54.330 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 18:52:54.331 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 18:52:54.333 +03:00 [DBG] Start db transaction.
2025-06-05 18:52:54.334 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 18:52:54.335 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 18:52:54.336 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 18:52:54.338 +03:00 [DBG] Executing DbCommand [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 18:52:54.342 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 18:52:54.344 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:52:54.345 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:52:54.347 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 18:52:54.348 +03:00 [DBG] The navigation 'Saving.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:52:54.350 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 18:52:54.351 +03:00 [ERR] Failed transaction: The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
2025-06-05 18:52:54.352 +03:00 [DBG] Rolling back transaction.
2025-06-05 18:52:54.353 +03:00 [DBG] Rolled back transaction.
2025-06-05 18:52:54.354 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:52:54.355 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 18:52:54.357 +03:00 [DBG] Disposing transaction.
2025-06-05 18:52:54.358 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend) in 62.644ms
2025-06-05 18:52:54.359 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 18:52:54.360 +03:00 [ERR] The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState[TEntity](TEntity entity, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.Attach[TEntity](TEntity entity)
   at Finance_Manager_Backend.BusinessLogic.Services.SavingsService.<>c__DisplayClass10_0.<<UpdateSavingAsync>b__0>d.MoveNext() in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\SavingsService.cs:line 79
--- End of stack trace from previous location ---
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 31
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 51
   at Finance_Manager_Backend.BusinessLogic.Services.SavingsService.UpdateSavingAsync(Int32 savingId, Decimal topUpAmount) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\SavingsService.cs:line 71
   at Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving(SavingTopUpDTO topUpDTO) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\SavingsController.cs:line 112
   at lambda_method716(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-06-05 18:52:54.368 +03:00 [DBG] Connection id "0HND490OUORC0" completed keep alive response.
2025-06-05 18:52:54.369 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1153 - null null
2025-06-05 18:52:54.370 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 18:52:54.372 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 18:52:54.373 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 18:52:54.374 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1153'
2025-06-05 18:52:54.375 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 18:52:54.376 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1153'
2025-06-05 18:52:54.378 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:49464/api/Savings - 400 null application/json 105.2149ms
2025-06-05 18:52:54.379 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:52:54.383 +03:00 [DBG] Successfully validated the token.
2025-06-05 18:52:54.384 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 18:52:54.385 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:52:54.386 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 18:52:54.387 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 18:52:54.388 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 18:52:54.390 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 18:52:54.391 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 18:52:54.394 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 18:52:54.395 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:52:54.397 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 18:52:54.398 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 18:52:54.399 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 18:52:54.400 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:52:54.402 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 18:52:54.403 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 18:52:54.405 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 18:52:54.407 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 18:52:54.411 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 18:52:54.413 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 18:52:54.415 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 18:52:54.416 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 18:52:54.417 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 18:52:54.419 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 18:52:54.421 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 26.1468ms
2025-06-05 18:52:54.447 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 18:52:54.455 +03:00 [DBG] Connection id "0HND490OUORC1" completed keep alive response.
2025-06-05 18:52:54.463 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1153 - 200 104 application/json; charset=utf-8 93.7576ms
2025-06-05 18:53:00.352 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:53:00.355 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0027ms - processed: 0 items - remaining: 1 items
2025-06-05 18:53:10.367 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:53:10.369 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.003ms - processed: 0 items - remaining: 1 items
2025-06-05 18:53:20.384 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:53:20.386 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0026ms - processed: 0 items - remaining: 1 items
2025-06-05 18:53:30.400 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:53:30.402 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0021ms - processed: 0 items - remaining: 1 items
2025-06-05 18:53:40.416 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:53:40.441 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0027ms - processed: 0 items - remaining: 1 items
2025-06-05 18:53:50.462 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:53:50.464 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0029ms - processed: 0 items - remaining: 1 items
2025-06-05 18:54:00.473 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:54:00.474 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0027ms - processed: 0 items - remaining: 1 items
2025-06-05 18:54:07.287 +03:00 [DBG] Connection id "0HND490OUORC1" received FIN.
2025-06-05 18:54:07.289 +03:00 [DBG] Connection id "0HND490OUORC0" received FIN.
2025-06-05 18:54:07.290 +03:00 [DBG] Connection id "0HND490OUORC1" disconnecting.
2025-06-05 18:54:07.292 +03:00 [DBG] Connection id "0HND490OUORC0" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-05 18:54:07.293 +03:00 [DBG] Connection id "0HND490OUORC1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-05 18:54:07.294 +03:00 [DBG] Connection id "0HND490OUORC0" disconnecting.
2025-06-05 18:54:07.297 +03:00 [DBG] Connection id "0HND490OUORC0" stopped.
2025-06-05 18:54:07.301 +03:00 [DBG] Connection id "0HND490OUORC1" stopped.
2025-06-05 18:54:10.489 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:54:10.490 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0098ms - processed: 0 items - remaining: 1 items
2025-06-05 18:54:20.505 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:54:20.508 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0046ms - processed: 0 items - remaining: 1 items
2025-06-05 18:54:30.504 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 18:54:30.506 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0017ms - processed: 0 items - remaining: 1 items
2025-06-05 18:54:37.301 +03:00 [DBG] HttpMessageHandler expired after 120000ms for client 'CurrencyConverterService'
2025-06-05 18:54:40.505 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:54:40.506 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0022ms - processed: 0 items - remaining: 2 items
2025-06-05 18:54:50.516 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:54:50.517 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0022ms - processed: 0 items - remaining: 2 items
2025-06-05 18:55:00.516 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:55:00.517 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0018ms - processed: 0 items - remaining: 2 items
2025-06-05 18:55:10.532 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:55:10.533 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0025ms - processed: 0 items - remaining: 2 items
2025-06-05 18:55:20.532 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:55:20.533 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0025ms - processed: 0 items - remaining: 2 items
2025-06-05 18:55:30.542 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:55:30.543 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0023ms - processed: 0 items - remaining: 2 items
2025-06-05 18:55:40.558 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:55:40.559 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0025ms - processed: 0 items - remaining: 2 items
2025-06-05 18:55:50.559 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:55:50.560 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0029ms - processed: 0 items - remaining: 2 items
2025-06-05 18:56:00.559 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:56:00.560 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0025ms - processed: 0 items - remaining: 2 items
2025-06-05 18:56:10.575 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:56:10.576 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0028ms - processed: 0 items - remaining: 2 items
2025-06-05 18:56:20.590 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:56:20.592 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0039ms - processed: 0 items - remaining: 2 items
2025-06-05 18:56:30.606 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:56:30.607 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0028ms - processed: 0 items - remaining: 2 items
2025-06-05 18:56:40.622 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:56:40.623 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0029ms - processed: 0 items - remaining: 2 items
2025-06-05 18:56:50.621 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:56:50.623 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0849ms - processed: 0 items - remaining: 2 items
2025-06-05 18:57:00.626 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:57:00.628 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0026ms - processed: 0 items - remaining: 2 items
2025-06-05 18:57:10.627 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:57:10.628 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0028ms - processed: 0 items - remaining: 2 items
2025-06-05 18:57:20.642 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:57:20.643 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0028ms - processed: 0 items - remaining: 2 items
2025-06-05 18:57:30.657 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:57:30.658 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0021ms - processed: 0 items - remaining: 2 items
2025-06-05 18:57:40.664 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:57:40.666 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0027ms - processed: 0 items - remaining: 2 items
2025-06-05 18:57:50.679 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:57:50.682 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0028ms - processed: 0 items - remaining: 2 items
2025-06-05 18:58:00.691 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:58:00.692 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0028ms - processed: 0 items - remaining: 2 items
2025-06-05 18:58:10.699 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:58:10.700 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0023ms - processed: 0 items - remaining: 2 items
2025-06-05 18:58:20.714 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:58:20.716 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0033ms - processed: 0 items - remaining: 2 items
2025-06-05 18:58:30.728 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:58:30.729 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0026ms - processed: 0 items - remaining: 2 items
2025-06-05 18:58:40.744 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:58:40.745 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0021ms - processed: 0 items - remaining: 2 items
2025-06-05 18:58:50.744 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:58:50.745 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0023ms - processed: 0 items - remaining: 2 items
2025-06-05 18:59:00.759 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:59:00.761 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0026ms - processed: 0 items - remaining: 2 items
2025-06-05 18:59:10.773 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:59:10.774 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0022ms - processed: 0 items - remaining: 2 items
2025-06-05 18:59:20.788 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:59:20.791 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0043ms - processed: 0 items - remaining: 2 items
2025-06-05 18:59:30.788 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:59:30.789 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0017ms - processed: 0 items - remaining: 2 items
2025-06-05 18:59:40.793 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:59:40.794 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0019ms - processed: 0 items - remaining: 2 items
2025-06-05 18:59:50.803 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 18:59:50.804 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0015ms - processed: 0 items - remaining: 2 items
2025-06-05 19:00:00.816 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:00:00.818 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 2 items
2025-06-05 19:00:10.830 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:00:10.832 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0018ms - processed: 0 items - remaining: 2 items
2025-06-05 19:00:20.837 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:00:20.838 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0015ms - processed: 0 items - remaining: 2 items
2025-06-05 19:00:30.837 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:00:30.838 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 2 items
2025-06-05 19:00:40.837 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:00:40.838 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 2 items
2025-06-05 19:00:50.840 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:00:50.841 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0014ms - processed: 0 items - remaining: 2 items
2025-06-05 19:01:00.851 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:01:00.852 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0016ms - processed: 0 items - remaining: 2 items
2025-06-05 19:01:10.861 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:01:10.863 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0016ms - processed: 0 items - remaining: 2 items
2025-06-05 19:01:20.877 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:01:20.878 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0012ms - processed: 0 items - remaining: 2 items
2025-06-05 19:01:30.877 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:01:30.878 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0023ms - processed: 0 items - remaining: 2 items
2025-06-05 19:01:40.878 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:01:40.879 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0016ms - processed: 0 items - remaining: 2 items
2025-06-05 19:01:50.879 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:01:50.880 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0012ms - processed: 0 items - remaining: 2 items
2025-06-05 19:02:00.880 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:02:00.881 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0014ms - processed: 0 items - remaining: 2 items
2025-06-05 19:02:10.893 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:02:10.894 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0016ms - processed: 0 items - remaining: 2 items
2025-06-05 19:02:20.900 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:02:20.901 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0016ms - processed: 0 items - remaining: 2 items
2025-06-05 19:02:30.903 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:02:30.904 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0014ms - processed: 0 items - remaining: 2 items
2025-06-05 19:02:40.909 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:02:40.910 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0015ms - processed: 0 items - remaining: 2 items
2025-06-05 19:02:50.925 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:02:50.926 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0015ms - processed: 0 items - remaining: 2 items
2025-06-05 19:03:00.940 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:03:00.941 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 2 items
2025-06-05 19:03:10.940 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:03:10.941 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 2 items
2025-06-05 19:03:20.940 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:03:20.942 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0015ms - processed: 0 items - remaining: 2 items
2025-06-05 19:03:30.940 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:03:30.941 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0015ms - processed: 0 items - remaining: 2 items
2025-06-05 19:03:40.940 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:03:40.941 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0017ms - processed: 0 items - remaining: 2 items
2025-06-05 19:03:50.956 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:03:50.957 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0016ms - processed: 0 items - remaining: 2 items
2025-06-05 19:04:00.970 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:04:00.971 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 2 items
2025-06-05 19:04:10.979 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:04:10.980 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0017ms - processed: 0 items - remaining: 2 items
2025-06-05 19:04:20.992 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:04:20.994 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0014ms - processed: 0 items - remaining: 2 items
2025-06-05 19:04:30.994 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:04:30.996 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0017ms - processed: 0 items - remaining: 2 items
2025-06-05 19:04:40.994 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:04:40.995 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0016ms - processed: 0 items - remaining: 2 items
2025-06-05 19:04:50.994 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:04:50.995 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0014ms - processed: 0 items - remaining: 2 items
2025-06-05 19:05:01.001 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:05:01.002 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 2 items
2025-06-05 19:05:11.006 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:05:11.007 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 2 items
2025-06-05 19:05:21.013 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:05:21.015 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0018ms - processed: 0 items - remaining: 2 items
2025-06-05 19:05:31.016 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:05:31.017 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0015ms - processed: 0 items - remaining: 2 items
2025-06-05 19:05:41.023 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:05:41.024 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0019ms - processed: 0 items - remaining: 2 items
2025-06-05 19:05:51.023 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:05:51.024 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0014ms - processed: 0 items - remaining: 2 items
2025-06-05 19:06:01.038 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:06:01.039 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0015ms - processed: 0 items - remaining: 2 items
2025-06-05 19:06:11.050 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:06:11.051 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0016ms - processed: 0 items - remaining: 2 items
2025-06-05 19:06:21.058 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:06:21.059 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0011ms - processed: 0 items - remaining: 2 items
2025-06-05 19:06:31.067 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:06:31.068 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 2 items
2025-06-05 19:06:41.075 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:06:41.076 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0017ms - processed: 0 items - remaining: 2 items
2025-06-05 19:06:51.091 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:06:51.092 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 2 items
2025-06-05 19:07:01.091 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:07:01.092 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0015ms - processed: 0 items - remaining: 2 items
2025-06-05 19:07:11.107 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:07:11.108 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0019ms - processed: 0 items - remaining: 2 items
2025-06-05 19:07:21.117 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:07:21.120 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0014ms - processed: 0 items - remaining: 2 items
2025-06-05 19:07:31.131 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:07:31.133 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.002ms - processed: 0 items - remaining: 2 items
2025-06-05 19:07:41.142 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:07:41.143 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0024ms - processed: 0 items - remaining: 2 items
2025-06-05 19:07:51.150 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:07:51.152 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.002ms - processed: 0 items - remaining: 2 items
2025-06-05 19:08:01.163 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:08:01.170 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 2 items
2025-06-05 19:08:11.207 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 2 items
2025-06-05 19:08:11.208 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0012ms - processed: 0 items - remaining: 2 items
2025-06-05 19:08:17.009 +03:00 [INF] Application is shutting down...
2025-06-05 19:08:17.010 +03:00 [DBG] Hosting stopping
2025-06-05 19:08:17.066 +03:00 [DBG] Hosting stopped
2025-06-05 20:28:15.417 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-06-05 20:28:16.310 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:28:16.426 +03:00 [DBG] Compiling query expression: 
'DbSet<User>()'
2025-06-05 20:28:16.823 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<User>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
        SELECT u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
        FROM users AS u) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
        SELECT u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
        FROM users AS u, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        User entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            User instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(User);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: User.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (User)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]: 
                        {
                            return 
                            {
                                User instance;
                                instance = new User();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Balance>k__BackingField = dataReader.GetDecimal(1);
                                instance.<Email>k__BackingField = dataReader.GetString(2);
                                instance.<PasswordHash>k__BackingField = dataReader.GetString(3);
                                instance.<PrimaryCurrency>k__BackingField = dataReader.GetString(4);
                                instance.<Role>k__BackingField = dataReader.GetString(5);
                                instance.<Salt>k__BackingField = dataReader.GetString(6);
                                instance.<SecondaryCurrency1>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<SecondaryCurrency2>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(User)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 20:28:16.880 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:28:16.974 +03:00 [DBG] Created DbConnection. (94ms).
2025-06-05 20:28:16.980 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:17.481 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:17.490 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:17.497 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (8ms).
2025-06-05 20:28:17.500 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (14ms).
2025-06-05 20:28:17.508 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
2025-06-05 20:28:17.579 +03:00 [INF] Executed DbCommand (71ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
2025-06-05 20:28:17.618 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:17.718 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:17.730 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:17.732 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:17.737 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:17.746 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 159ms reading results.
2025-06-05 20:28:17.749 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:17.755 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (5ms).
2025-06-05 20:28:17.761 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 20:28:17.764 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 20:28:17.781 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 20:28:17.908 +03:00 [DBG] Executing 2 update commands as a batch.
2025-06-05 20:28:17.915 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:17.919 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:17.922 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-06-05 20:28:17.933 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 20:28:17.938 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:17.940 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:28:17.945 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-06-05 20:28:17.949 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p1;
2025-06-05 20:28:18.017 +03:00 [INF] Executed DbCommand (69ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p1;
2025-06-05 20:28:18.031 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.035 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 14ms reading results.
2025-06-05 20:28:18.041 +03:00 [DBG] Committing transaction.
2025-06-05 20:28:18.045 +03:00 [DBG] Committed transaction.
2025-06-05 20:28:18.048 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.049 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:18.053 +03:00 [DBG] Disposing transaction.
2025-06-05 20:28:18.059 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.061 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.065 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-06-05 20:28:18.068 +03:00 [DBG] Compiling query expression: 
'DbSet<Category>()'
2025-06-05 20:28:18.076 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Category>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Category entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Category instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Category);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Category)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                        {
                            return 
                            {
                                Category instance;
                                instance = new Category();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<ColorForBackground>k__BackingField = dataReader.GetString(1);
                                instance.<Icon>k__BackingField = dataReader.GetString(2);
                                instance.<IsIncome>k__BackingField = dataReader.GetBoolean(3);
                                instance.<Name>k__BackingField = dataReader.GetString(4);
                                instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Category)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 20:28:18.080 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.082 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.083 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:18.084 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:18.086 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:28:18.087 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 20:28:18.103 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 20:28:18.131 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.145 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.149 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.150 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.152 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.154 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.157 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.159 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.161 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.163 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.165 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.167 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 61ms reading results.
2025-06-05 20:28:18.168 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.169 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:18.171 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 20:28:18.173 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 20:28:18.184 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 20:28:18.188 +03:00 [DBG] Executing 5 update commands as a batch.
2025-06-05 20:28:18.190 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.192 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.194 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-06-05 20:28:18.196 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 20:28:18.198 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:18.199 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:18.200 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:28:18.202 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p1;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p2;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p3;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p4;
2025-06-05 20:28:18.241 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p1;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p2;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p3;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p4;
2025-06-05 20:28:18.244 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.246 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-06-05 20:28:18.248 +03:00 [DBG] Committing transaction.
2025-06-05 20:28:18.276 +03:00 [DBG] Committed transaction.
2025-06-05 20:28:18.277 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.278 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:18.280 +03:00 [DBG] Disposing transaction.
2025-06-05 20:28:18.281 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.283 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.285 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.287 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.291 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:18.293 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 5 entities written to the database.
2025-06-05 20:28:18.295 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:28:18.298 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.300 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 20:28:18.499 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:28:18.513 +03:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Email == __email_0)'
2025-06-05 20:28:18.653 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.email == @__email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.email == @__email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Balance>k__BackingField = dataReader.GetDecimal(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(3);
                                    instance.<PrimaryCurrency>k__BackingField = dataReader.GetString(4);
                                    instance.<Role>k__BackingField = dataReader.GetString(5);
                                    instance.<Salt>k__BackingField = dataReader.GetString(6);
                                    instance.<SecondaryCurrency1>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<SecondaryCurrency2>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 20:28:18.688 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:28:18.692 +03:00 [DBG] Created DbConnection. (3ms).
2025-06-05 20:28:18.693 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.695 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.697 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:18.698 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:18.700 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:18.702 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 20:28:18.714 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 20:28:18.728 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.730 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 6ms reading results.
2025-06-05 20:28:18.732 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:18.734 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:18.793 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'User.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.085 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.088 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 20:28:19.089 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 20:28:19.091 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 20:28:19.102 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.104 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.105 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:19.107 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:28:19.109 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:19.110 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 50), @p1='?' (Size = 50), @p2='?' (Size = 3), @p3='?' (Size = 5), @p4='?' (Size = 30), @p5='?' (Size = 3), @p6='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id], INSERTED.[balance]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-06-05 20:28:19.174 +03:00 [INF] Executed DbCommand (63ms) [Parameters=[@p0='?' (Size = 50), @p1='?' (Size = 50), @p2='?' (Size = 3), @p3='?' (Size = 5), @p4='?' (Size = 30), @p5='?' (Size = 3), @p6='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id], INSERTED.[balance]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-06-05 20:28:19.187 +03:00 [DBG] The foreign key property 'User.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:19.194 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.196 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 19ms reading results.
2025-06-05 20:28:19.198 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.200 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:19.208 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.211 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 20:28:19.638 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'RefreshToken.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.652 +03:00 [DBG] The navigation 'RefreshToken.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.656 +03:00 [DBG] Context 'AppDbContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.659 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 20:28:19.661 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 20:28:19.668 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 20:28:19.674 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.676 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.678 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:19.680 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:19.682 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:19.683 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 20:28:19.705 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 20:28:19.712 +03:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:19.714 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.716 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 7ms reading results.
2025-06-05 20:28:19.718 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.719 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:19.722 +03:00 [DBG] An entity of type 'RefreshToken' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.725 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 20:28:19.728 +03:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Id == __authData_UserDTO_Id_0)'
2025-06-05 20:28:19.735 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.id == @__authData_UserDTO_Id_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.id == @__authData_UserDTO_Id_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Balance>k__BackingField = dataReader.GetDecimal(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(3);
                                    instance.<PrimaryCurrency>k__BackingField = dataReader.GetString(4);
                                    instance.<Role>k__BackingField = dataReader.GetString(5);
                                    instance.<Salt>k__BackingField = dataReader.GetString(6);
                                    instance.<SecondaryCurrency1>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<SecondaryCurrency2>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 20:28:19.740 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.742 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.744 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:19.745 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:19.746 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:28:19.748 +03:00 [DBG] Executing DbCommand [Parameters=[@__authData_UserDTO_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__authData_UserDTO_Id_0
2025-06-05 20:28:19.752 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__authData_UserDTO_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__authData_UserDTO_Id_0
2025-06-05 20:28:19.755 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.758 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 20:28:19.760 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.762 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:19.770 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.773 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.778 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.780 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.782 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.784 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.786 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.788 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.790 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.793 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.795 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 20:28:19.797 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 20:28:19.799 +03:00 [DBG] The unchanged property 'User.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:19.801 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.803 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 20:28:19.816 +03:00 [DBG] Executing 6 update commands as a batch.
2025-06-05 20:28:19.818 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.820 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.826 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-06-05 20:28:19.830 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 20:28:19.832 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:19.833 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:19.835 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:19.837 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 7), @p1='?' (Size = 100), @p2='?' (DbType = Boolean), @p3='?' (Size = 50), @p4='?' (DbType = Int32), @p5='?' (Size = 7), @p6='?' (Size = 100), @p7='?' (DbType = Boolean), @p8='?' (Size = 50), @p9='?' (DbType = Int32), @p10='?' (Size = 7), @p11='?' (Size = 100), @p12='?' (DbType = Boolean), @p13='?' (Size = 50), @p14='?' (DbType = Int32), @p15='?' (Size = 7), @p16='?' (Size = 100), @p17='?' (DbType = Boolean), @p18='?' (Size = 50), @p19='?' (DbType = Int32), @p20='?' (Size = 7), @p21='?' (Size = 100), @p22='?' (DbType = Boolean), @p23='?' (Size = 50), @p24='?' (DbType = Int32), @p26='?' (DbType = Int32), @p25='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [categories] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, 0),
(@p5, @p6, @p7, @p8, @p9, 1),
(@p10, @p11, @p12, @p13, @p14, 2),
(@p15, @p16, @p17, @p18, @p19, 3),
(@p20, @p21, @p22, @p23, @p24, 4)) AS i ([background_color], [icon_path], [is_income], [name], [parent_category_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([background_color], [icon_path], [is_income], [name], [parent_category_fk])
VALUES (i.[background_color], i.[icon_path], i.[is_income], i.[name], i.[parent_category_fk])
OUTPUT INSERTED.[id], i._Position;
UPDATE [users] SET [balance] = @p25
OUTPUT 1
WHERE [id] = @p26;
2025-06-05 20:28:19.856 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@p0='?' (Size = 7), @p1='?' (Size = 100), @p2='?' (DbType = Boolean), @p3='?' (Size = 50), @p4='?' (DbType = Int32), @p5='?' (Size = 7), @p6='?' (Size = 100), @p7='?' (DbType = Boolean), @p8='?' (Size = 50), @p9='?' (DbType = Int32), @p10='?' (Size = 7), @p11='?' (Size = 100), @p12='?' (DbType = Boolean), @p13='?' (Size = 50), @p14='?' (DbType = Int32), @p15='?' (Size = 7), @p16='?' (Size = 100), @p17='?' (DbType = Boolean), @p18='?' (Size = 50), @p19='?' (DbType = Int32), @p20='?' (Size = 7), @p21='?' (Size = 100), @p22='?' (DbType = Boolean), @p23='?' (Size = 50), @p24='?' (DbType = Int32), @p26='?' (DbType = Int32), @p25='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [categories] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, 0),
(@p5, @p6, @p7, @p8, @p9, 1),
(@p10, @p11, @p12, @p13, @p14, 2),
(@p15, @p16, @p17, @p18, @p19, 3),
(@p20, @p21, @p22, @p23, @p24, 4)) AS i ([background_color], [icon_path], [is_income], [name], [parent_category_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([background_color], [icon_path], [is_income], [name], [parent_category_fk])
VALUES (i.[background_color], i.[icon_path], i.[is_income], i.[name], i.[parent_category_fk])
OUTPUT INSERTED.[id], i._Position;
UPDATE [users] SET [balance] = @p25
OUTPUT 1
WHERE [id] = @p26;
2025-06-05 20:28:19.861 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:19.864 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:19.865 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:19.867 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:19.868 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:19.870 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.871 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 12ms reading results.
2025-06-05 20:28:19.873 +03:00 [DBG] Committing transaction.
2025-06-05 20:28:19.893 +03:00 [DBG] Committed transaction.
2025-06-05 20:28:19.894 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:19.896 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:19.898 +03:00 [DBG] Disposing transaction.
2025-06-05 20:28:19.899 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.901 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.903 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.905 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.907 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.909 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.912 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 6 entities written to the database.
2025-06-05 20:28:19.917 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.937 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.938 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.940 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.942 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.944 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.947 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.949 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.950 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.952 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.953 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.955 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.957 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.960 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.961 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.963 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.965 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.967 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.968 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.970 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.972 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.973 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.975 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.977 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.979 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.980 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.982 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.984 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.986 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.987 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.989 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.994 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.996 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:19.998 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.000 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.002 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.004 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.006 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.009 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.012 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.013 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 20:28:20.014 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 20:28:20.021 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 20:28:20.027 +03:00 [DBG] Executing 20 update commands as a batch.
2025-06-05 20:28:20.028 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.030 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.032 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:20.033 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:20.035 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:20.037 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (Size = 50), @p4='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 50), @p10='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (DbType = DateTime2), @p20='?' (DbType = Int32), @p21='?' (Size = 50), @p22='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32), @p25='?' (DbType = DateTime2), @p26='?' (DbType = Int32), @p27='?' (Size = 50), @p28='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p29='?' (DbType = Int32), @p30='?' (DbType = Int32), @p31='?' (DbType = DateTime2), @p32='?' (DbType = Int32), @p33='?' (Size = 50), @p34='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p35='?' (DbType = Int32), @p36='?' (DbType = Int32), @p37='?' (DbType = DateTime2), @p38='?' (DbType = Int32), @p39='?' (Size = 50), @p40='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p41='?' (DbType = Int32), @p42='?' (DbType = Int32), @p43='?' (DbType = DateTime2), @p44='?' (DbType = Int32), @p45='?' (Size = 50), @p46='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p47='?' (DbType = Int32), @p48='?' (DbType = Int32), @p49='?' (DbType = DateTime2), @p50='?' (DbType = Int32), @p51='?' (Size = 50), @p52='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p53='?' (DbType = Int32), @p54='?' (DbType = Int32), @p55='?' (DbType = DateTime2), @p56='?' (DbType = Int32), @p57='?' (Size = 50), @p58='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p59='?' (DbType = Int32), @p60='?' (DbType = Int32), @p61='?' (DbType = DateTime2), @p62='?' (DbType = Int32), @p63='?' (Size = 50), @p64='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p65='?' (DbType = Int32), @p66='?' (DbType = Int32), @p67='?' (DbType = DateTime2), @p68='?' (DbType = Int32), @p69='?' (Size = 50), @p70='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p71='?' (DbType = Int32), @p72='?' (DbType = Int32), @p73='?' (DbType = DateTime2), @p74='?' (DbType = Int32), @p75='?' (Size = 50), @p76='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p77='?' (DbType = Int32), @p78='?' (DbType = Int32), @p79='?' (DbType = DateTime2), @p80='?' (DbType = Int32), @p81='?' (Size = 50), @p82='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p83='?' (DbType = Int32), @p84='?' (DbType = Int32), @p85='?' (DbType = DateTime2), @p86='?' (DbType = Int32), @p87='?' (Size = 50), @p88='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p89='?' (DbType = Int32), @p90='?' (DbType = Int32), @p91='?' (DbType = DateTime2), @p92='?' (DbType = Int32), @p93='?' (Size = 50), @p94='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p95='?' (DbType = Int32), @p96='?' (DbType = Int32), @p97='?' (DbType = DateTime2), @p98='?' (DbType = Int32), @p99='?' (Size = 50), @p100='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p101='?' (DbType = Int32), @p102='?' (DbType = Int32), @p103='?' (DbType = DateTime2), @p104='?' (DbType = Int32), @p105='?' (Size = 50), @p106='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p107='?' (DbType = Int32), @p108='?' (DbType = Int32), @p109='?' (DbType = DateTime2), @p110='?' (DbType = Int32), @p111='?' (Size = 50), @p112='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p113='?' (DbType = Int32), @p114='?' (DbType = Int32), @p115='?' (DbType = DateTime2), @p116='?' (DbType = Int32), @p117='?' (Size = 50), @p118='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p119='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [transactions] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, 0),
(@p6, @p7, @p8, @p9, @p10, @p11, 1),
(@p12, @p13, @p14, @p15, @p16, @p17, 2),
(@p18, @p19, @p20, @p21, @p22, @p23, 3),
(@p24, @p25, @p26, @p27, @p28, @p29, 4),
(@p30, @p31, @p32, @p33, @p34, @p35, 5),
(@p36, @p37, @p38, @p39, @p40, @p41, 6),
(@p42, @p43, @p44, @p45, @p46, @p47, 7),
(@p48, @p49, @p50, @p51, @p52, @p53, 8),
(@p54, @p55, @p56, @p57, @p58, @p59, 9),
(@p60, @p61, @p62, @p63, @p64, @p65, 10),
(@p66, @p67, @p68, @p69, @p70, @p71, 11),
(@p72, @p73, @p74, @p75, @p76, @p77, 12),
(@p78, @p79, @p80, @p81, @p82, @p83, 13),
(@p84, @p85, @p86, @p87, @p88, @p89, 14),
(@p90, @p91, @p92, @p93, @p94, @p95, 15),
(@p96, @p97, @p98, @p99, @p100, @p101, 16),
(@p102, @p103, @p104, @p105, @p106, @p107, 17),
(@p108, @p109, @p110, @p111, @p112, @p113, 18),
(@p114, @p115, @p116, @p117, @p118, @p119, 19)) AS i ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk])
VALUES (i.[category_fk], i.[date], i.[inner_category_fk], i.[name], i.[price], i.[user_fk])
OUTPUT INSERTED.[id], i._Position;
2025-06-05 20:28:20.082 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (Size = 50), @p4='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 50), @p10='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (DbType = DateTime2), @p20='?' (DbType = Int32), @p21='?' (Size = 50), @p22='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32), @p25='?' (DbType = DateTime2), @p26='?' (DbType = Int32), @p27='?' (Size = 50), @p28='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p29='?' (DbType = Int32), @p30='?' (DbType = Int32), @p31='?' (DbType = DateTime2), @p32='?' (DbType = Int32), @p33='?' (Size = 50), @p34='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p35='?' (DbType = Int32), @p36='?' (DbType = Int32), @p37='?' (DbType = DateTime2), @p38='?' (DbType = Int32), @p39='?' (Size = 50), @p40='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p41='?' (DbType = Int32), @p42='?' (DbType = Int32), @p43='?' (DbType = DateTime2), @p44='?' (DbType = Int32), @p45='?' (Size = 50), @p46='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p47='?' (DbType = Int32), @p48='?' (DbType = Int32), @p49='?' (DbType = DateTime2), @p50='?' (DbType = Int32), @p51='?' (Size = 50), @p52='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p53='?' (DbType = Int32), @p54='?' (DbType = Int32), @p55='?' (DbType = DateTime2), @p56='?' (DbType = Int32), @p57='?' (Size = 50), @p58='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p59='?' (DbType = Int32), @p60='?' (DbType = Int32), @p61='?' (DbType = DateTime2), @p62='?' (DbType = Int32), @p63='?' (Size = 50), @p64='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p65='?' (DbType = Int32), @p66='?' (DbType = Int32), @p67='?' (DbType = DateTime2), @p68='?' (DbType = Int32), @p69='?' (Size = 50), @p70='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p71='?' (DbType = Int32), @p72='?' (DbType = Int32), @p73='?' (DbType = DateTime2), @p74='?' (DbType = Int32), @p75='?' (Size = 50), @p76='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p77='?' (DbType = Int32), @p78='?' (DbType = Int32), @p79='?' (DbType = DateTime2), @p80='?' (DbType = Int32), @p81='?' (Size = 50), @p82='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p83='?' (DbType = Int32), @p84='?' (DbType = Int32), @p85='?' (DbType = DateTime2), @p86='?' (DbType = Int32), @p87='?' (Size = 50), @p88='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p89='?' (DbType = Int32), @p90='?' (DbType = Int32), @p91='?' (DbType = DateTime2), @p92='?' (DbType = Int32), @p93='?' (Size = 50), @p94='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p95='?' (DbType = Int32), @p96='?' (DbType = Int32), @p97='?' (DbType = DateTime2), @p98='?' (DbType = Int32), @p99='?' (Size = 50), @p100='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p101='?' (DbType = Int32), @p102='?' (DbType = Int32), @p103='?' (DbType = DateTime2), @p104='?' (DbType = Int32), @p105='?' (Size = 50), @p106='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p107='?' (DbType = Int32), @p108='?' (DbType = Int32), @p109='?' (DbType = DateTime2), @p110='?' (DbType = Int32), @p111='?' (Size = 50), @p112='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p113='?' (DbType = Int32), @p114='?' (DbType = Int32), @p115='?' (DbType = DateTime2), @p116='?' (DbType = Int32), @p117='?' (Size = 50), @p118='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p119='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [transactions] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, 0),
(@p6, @p7, @p8, @p9, @p10, @p11, 1),
(@p12, @p13, @p14, @p15, @p16, @p17, 2),
(@p18, @p19, @p20, @p21, @p22, @p23, 3),
(@p24, @p25, @p26, @p27, @p28, @p29, 4),
(@p30, @p31, @p32, @p33, @p34, @p35, 5),
(@p36, @p37, @p38, @p39, @p40, @p41, 6),
(@p42, @p43, @p44, @p45, @p46, @p47, 7),
(@p48, @p49, @p50, @p51, @p52, @p53, 8),
(@p54, @p55, @p56, @p57, @p58, @p59, 9),
(@p60, @p61, @p62, @p63, @p64, @p65, 10),
(@p66, @p67, @p68, @p69, @p70, @p71, 11),
(@p72, @p73, @p74, @p75, @p76, @p77, 12),
(@p78, @p79, @p80, @p81, @p82, @p83, 13),
(@p84, @p85, @p86, @p87, @p88, @p89, 14),
(@p90, @p91, @p92, @p93, @p94, @p95, 15),
(@p96, @p97, @p98, @p99, @p100, @p101, 16),
(@p102, @p103, @p104, @p105, @p106, @p107, 17),
(@p108, @p109, @p110, @p111, @p112, @p113, 18),
(@p114, @p115, @p116, @p117, @p118, @p119, 19)) AS i ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk])
VALUES (i.[category_fk], i.[date], i.[inner_category_fk], i.[name], i.[price], i.[user_fk])
OUTPUT INSERTED.[id], i._Position;
2025-06-05 20:28:20.095 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.098 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.100 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.102 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.104 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.105 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.108 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.110 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.112 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.114 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.116 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.118 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.119 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.121 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.122 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.124 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.126 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.128 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.129 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.131 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.133 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.135 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 41ms reading results.
2025-06-05 20:28:20.137 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.138 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:20.140 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.143 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.145 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.148 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.150 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.152 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.154 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.156 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.158 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.160 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.163 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.164 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.166 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.168 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.170 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.172 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.176 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.178 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.181 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.183 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.185 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 20 entities written to the database.
2025-06-05 20:28:20.188 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.206 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.208 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.213 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.215 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.219 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.221 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.224 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.228 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 20:28:20.230 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 20:28:20.238 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 20:28:20.241 +03:00 [DBG] Executing 4 update commands as a batch.
2025-06-05 20:28:20.245 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.248 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.250 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:20.252 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:20.254 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:20.256 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (DbType = Int32), @p3='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 50), @p5='?' (DbType = Int32), @p6='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p10='?' (Size = 50), @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [savings] USING (
VALUES (@p0, @p1, @p2, 0),
(@p3, @p4, @p5, 1),
(@p6, @p7, @p8, 2),
(@p9, @p10, @p11, 3)) AS i ([goal], [name], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([goal], [name], [user_fk])
VALUES (i.[goal], i.[name], i.[user_fk])
OUTPUT INSERTED.[id], INSERTED.[current_amount], i._Position;
2025-06-05 20:28:20.319 +03:00 [INF] Executed DbCommand (63ms) [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (DbType = Int32), @p3='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 50), @p5='?' (DbType = Int32), @p6='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p10='?' (Size = 50), @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [savings] USING (
VALUES (@p0, @p1, @p2, 0),
(@p3, @p4, @p5, 1),
(@p6, @p7, @p8, 2),
(@p9, @p10, @p11, 3)) AS i ([goal], [name], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([goal], [name], [user_fk])
VALUES (i.[goal], i.[name], i.[user_fk])
OUTPUT INSERTED.[id], INSERTED.[current_amount], i._Position;
2025-06-05 20:28:20.350 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.354 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.357 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.361 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.367 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.370 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 21ms reading results.
2025-06-05 20:28:20.372 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.374 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:20.379 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.381 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.384 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.386 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.389 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 4 entities written to the database.
2025-06-05 20:28:20.391 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:28:20.392 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.394 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 20:28:20.417 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:28:20.436 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:28:20.437 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 20:28:20.438 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.440 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.441 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:20.443 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:20.445 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:20.447 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 20:28:20.453 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 20:28:20.458 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.460 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 20:28:20.462 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.463 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:20.481 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'User.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.483 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.484 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 20:28:20.486 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 20:28:20.487 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 20:28:20.489 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.492 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.494 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:20.496 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:20.498 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:20.500 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Precision = 12) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (Size = 50), @p3='?' (Size = 3), @p4='?' (Size = 5), @p5='?' (Size = 30), @p6='?' (Size = 3), @p7='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([balance], [email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-06-05 20:28:20.522 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@p0='?' (Precision = 12) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (Size = 50), @p3='?' (Size = 3), @p4='?' (Size = 5), @p5='?' (Size = 30), @p6='?' (Size = 3), @p7='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([balance], [email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-06-05 20:28:20.528 +03:00 [DBG] The foreign key property 'User.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:20.530 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.531 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 20:28:20.533 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.538 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (4ms).
2025-06-05 20:28:20.540 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:20.546 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 20:28:20.549 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:28:20.551 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.553 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 20:28:20.751 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-05 20:28:20.849 +03:00 [DBG] Hosting starting
2025-06-05 20:28:20.878 +03:00 [INF] User profile is available. Using 'C:\Users\ebtyx\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-06-05 20:28:20.916 +03:00 [DBG] Reading data from file 'C:\Users\ebtyx\AppData\Local\ASP.NET\DataProtection-Keys\key-036e1e5f-5347-47d7-8236-0b64ed0a76a1.xml'.
2025-06-05 20:28:20.920 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:28:20.927 +03:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.ExpiresAt < DateTime.UtcNow)'
2025-06-05 20:28:20.930 +03:00 [DBG] Found key {036e1e5f-5347-47d7-8236-0b64ed0a76a1}.
2025-06-05 20:28:20.944 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<RefreshToken>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
        SELECT r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
        FROM refresh_tokens AS r
        WHERE r.expires_at < GETUTCDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
        SELECT r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
        FROM refresh_tokens AS r
        WHERE r.expires_at < GETUTCDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        RefreshToken entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            RefreshToken instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(RefreshToken);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: RefreshToken.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (RefreshToken)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]: 
                        {
                            return 
                            {
                                RefreshToken instance;
                                instance = new RefreshToken();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                instance.<ExpiresAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<IsRevoked>k__BackingField = dataReader.GetBoolean(3);
                                instance.<Token>k__BackingField = dataReader.GetString(4);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(5);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(RefreshToken)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 20:28:20.947 +03:00 [DBG] Considering key {036e1e5f-5347-47d7-8236-0b64ed0a76a1} with expiration date 2025-07-16 20:11:06Z as default key.
2025-06-05 20:28:20.952 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:28:20.952 +03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-06-05 20:28:20.956 +03:00 [DBG] Created DbConnection. (3ms).
2025-06-05 20:28:20.959 +03:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-06-05 20:28:20.961 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.963 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.963 +03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-06-05 20:28:20.965 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:20.967 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:28:20.968 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:20.969 +03:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-06-05 20:28:20.971 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[expires_at] < GETUTCDATE()
2025-06-05 20:28:20.973 +03:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-06-05 20:28:20.978 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[expires_at] < GETUTCDATE()
2025-06-05 20:28:20.979 +03:00 [DBG] Using key {036e1e5f-5347-47d7-8236-0b64ed0a76a1} as the default key.
2025-06-05 20:28:20.982 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:20.985 +03:00 [DBG] Key ring with default key {036e1e5f-5347-47d7-8236-0b64ed0a76a1} was loaded during application startup.
2025-06-05 20:28:20.987 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 5ms reading results.
2025-06-05 20:28:21.006 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:21.007 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:21.011 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:28:21.013 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:21.016 +03:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-06-05 20:28:21.174 +03:00 [INF] Now listening on: https://localhost:49464
2025-06-05 20:28:21.178 +03:00 [INF] Now listening on: http://localhost:49465
2025-06-05 20:28:21.180 +03:00 [DBG] Loaded hosting startup assembly Finance_Manager_Backend
2025-06-05 20:28:21.181 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-06-05 20:28:21.182 +03:00 [INF] Hosting environment: Development
2025-06-05 20:28:21.183 +03:00 [INF] Content root path: G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend
2025-06-05 20:28:21.184 +03:00 [DBG] Hosting started
2025-06-05 20:28:28.225 +03:00 [DBG] Connection id "0HND4APH73JBN" accepted.
2025-06-05 20:28:28.236 +03:00 [DBG] Connection id "0HND4APH73JBN" started.
2025-06-05 20:28:28.292 +03:00 [DBG] Connection 0HND4APH73JBN established using the following protocol: "Tls12"
2025-06-05 20:28:28.433 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - application/json-patch+json 90
2025-06-05 20:28:28.438 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-05 20:28:28.543 +03:00 [DBG] POST requests are not supported
2025-06-05 20:28:28.576 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/refresh-token'
2025-06-05 20:28:28.586 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)' with route pattern 'api/Auth/refresh-token' is valid for the request path '/api/Auth/refresh-token'
2025-06-05 20:28:28.590 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-06-05 20:28:28.658 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-06-05 20:28:28.664 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-06-05 20:28:28.693 +03:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] RefreshToken(System.String) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-06-05 20:28:28.697 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:28:28.700 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:28:28.702 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:28:28.704 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:28:28.706 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:28:28.709 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 20:28:28.712 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 20:28:28.725 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' ...
2025-06-05 20:28:28.729 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' using the name '' in request data ...
2025-06-05 20:28:28.733 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:28:28.736 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:28:28.747 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:00000001": started reading request body.
2025-06-05 20:28:28.750 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:00000001": done reading request body.
2025-06-05 20:28:28.931 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-06-05 20:28:28.933 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-06-05 20:28:28.935 +03:00 [DBG] Attempting to validate the bound parameter 'refreshToken' of type 'System.String' ...
2025-06-05 20:28:28.945 +03:00 [DBG] Done attempting to validate the bound parameter 'refreshToken' of type 'System.String'.
2025-06-05 20:28:28.956 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:28:28.960 +03:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(rt => rt.Token == __refreshToken_0)'
2025-06-05 20:28:28.997 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<RefreshToken>(
    asyncEnumerable: SingleQueryingEnumerable.Create<RefreshToken>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
            SELECT TOP(1) r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
            FROM refresh_tokens AS r
            WHERE r.token == @__refreshToken_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
            SELECT TOP(1) r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
            FROM refresh_tokens AS r
            WHERE r.token == @__refreshToken_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            RefreshToken entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                RefreshToken instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(RefreshToken);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: RefreshToken.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (RefreshToken)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]: 
                            {
                                return 
                                {
                                    RefreshToken instance;
                                    instance = new RefreshToken();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<ExpiresAt>k__BackingField = dataReader.GetDateTime(2);
                                    instance.<IsRevoked>k__BackingField = dataReader.GetBoolean(3);
                                    instance.<Token>k__BackingField = dataReader.GetString(4);
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(5);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(RefreshToken)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 20:28:29.076 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:28:29.077 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 20:28:29.079 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:29.080 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:29.084 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:29.085 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:29.087 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:29.089 +03:00 [DBG] Executing DbCommand [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-06-05 20:28:29.093 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-06-05 20:28:29.095 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:29.097 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-06-05 20:28:29.102 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:29.104 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:29.111 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend) in 401.7467ms
2025-06-05 20:28:29.116 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-06-05 20:28:29.119 +03:00 [ERR] Invalid refresh token
System.InvalidOperationException: Invalid refresh token
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserWithRefreshTokenAsync(String refreshToken) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 89
   at Finance_Manager_Backend.Controllers.AuthController.RefreshToken(String refreshToken) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 86
   at lambda_method475(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-06-05 20:28:29.258 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:28:29.262 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:28:29.268 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:29.269 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 20:28:29.272 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - 400 null application/json 840.0021ms
2025-06-05 20:28:52.523 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - application/json-patch+json 63
2025-06-05 20:28:52.527 +03:00 [DBG] POST requests are not supported
2025-06-05 20:28:52.530 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/authenticate'
2025-06-05 20:28:52.532 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)' with route pattern 'api/Auth/authenticate' is valid for the request path '/api/Auth/authenticate'
2025-06-05 20:28:52.534 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-06-05 20:28:52.537 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-06-05 20:28:52.539 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-06-05 20:28:52.545 +03:00 [INF] Route matched with {action = "Authenticate", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] Authenticate(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-06-05 20:28:52.547 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:28:52.549 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:28:52.550 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:28:52.552 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:28:52.554 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:28:52.556 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 20:28:52.557 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 20:28:52.559 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-06-05 20:28:52.560 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' using the name '' in request data ...
2025-06-05 20:28:52.562 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:28:52.563 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:28:52.564 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:00000002": started reading request body.
2025-06-05 20:28:52.566 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:00000002": done reading request body.
2025-06-05 20:28:52.662 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-06-05 20:28:52.664 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-06-05 20:28:52.666 +03:00 [DBG] Attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-06-05 20:28:52.672 +03:00 [DBG] Done attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-06-05 20:28:52.722 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:28:52.725 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:28:52.726 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 20:28:52.727 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:52.729 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:52.731 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:52.733 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:52.735 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:52.737 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 20:28:52.741 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 20:28:52.744 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:52.745 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:52.747 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 20:28:52.748 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:52.750 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:52.765 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'RefreshToken.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:52.768 +03:00 [DBG] The navigation 'RefreshToken.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:52.769 +03:00 [DBG] Context 'AppDbContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:52.771 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 20:28:52.771 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 20:28:52.773 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 20:28:52.774 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:52.776 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:52.777 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:52.778 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-05 20:28:52.779 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:28:52.780 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 20:28:52.844 +03:00 [INF] Executed DbCommand (63ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 20:28:52.846 +03:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:28:52.848 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:52.849 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 20:28:52.851 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:52.852 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:52.854 +03:00 [DBG] An entity of type 'RefreshToken' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:52.856 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 20:28:52.860 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 20:28:52.865 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 20:28:52.868 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 20:28:52.870 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 20:28:52.871 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 20:28:52.872 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 20:28:52.874 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO'.
2025-06-05 20:28:52.920 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend) in 363.995ms
2025-06-05 20:28:52.921 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-06-05 20:28:52.922 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:28:52.923 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:28:52.924 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:52.925 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 20:28:52.927 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - 200 524 application/json; charset=utf-8 403.5885ms
2025-06-05 20:28:53.292 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1155 - null null
2025-06-05 20:28:53.316 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 20:28:53.321 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1155'
2025-06-05 20:28:53.322 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1155'
2025-06-05 20:28:53.324 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:28:53.405 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:28:53.407 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:28:53.409 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:28:53.415 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 20:28:53.417 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:28:53.418 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:28:53.420 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:28:53.422 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:28:53.423 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:28:53.425 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 20:28:53.430 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 20:28:53.432 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 20:28:53.433 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 20:28:53.436 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 20:28:53.437 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 20:28:53.439 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 20:28:53.440 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 20:28:53.457 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 20:28:53.460 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 20:28:53.461 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 20:28:53.463 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 20:28:53.464 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 20:28:53.464 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 20:28:53.466 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 20:28:53.473 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 47.9026ms
2025-06-05 20:28:53.474 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:28:53.475 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:28:53.477 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1155 - 200 105 application/json; charset=utf-8 184.3908ms
2025-06-05 20:28:53.508 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Categories - null null
2025-06-05 20:28:53.513 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 20:28:53.514 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Categories'
2025-06-05 20:28:53.516 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)' with route pattern 'api/Categories' is valid for the request path '/api/Categories'
2025-06-05 20:28:53.521 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)'
2025-06-05 20:28:53.523 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:28:53.524 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:28:53.526 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)'
2025-06-05 20:28:53.530 +03:00 [INF] Route matched with {action = "GetAllCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryDTO]]] GetAllCategories() on controller Finance_Manager_Backend.Controllers.CategoriesController (Finance_Manager_Backend).
2025-06-05 20:28:53.532 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:28:53.534 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:28:53.537 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:28:53.540 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:28:53.542 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:28:53.543 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.CategoriesController (Finance_Manager_Backend)
2025-06-05 20:28:53.546 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.CategoriesController (Finance_Manager_Backend)
2025-06-05 20:28:53.550 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:28:53.554 +03:00 [DBG] Compiling query expression: 
'DbSet<Category>()'
2025-06-05 20:28:53.561 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Category>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Category entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Category instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Category);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Category)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                        {
                            return 
                            {
                                Category instance;
                                instance = new Category();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<ColorForBackground>k__BackingField = dataReader.GetString(1);
                                instance.<Icon>k__BackingField = dataReader.GetString(2);
                                instance.<IsIncome>k__BackingField = dataReader.GetBoolean(3);
                                instance.<Name>k__BackingField = dataReader.GetString(4);
                                instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Category)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 20:28:53.566 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:28:53.567 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 20:28:53.570 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:53.571 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:53.573 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:53.574 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:53.576 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:28:53.577 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 20:28:53.581 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 20:28:53.586 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.588 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.590 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.592 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.594 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.597 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:53.598 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 14ms reading results.
2025-06-05 20:28:53.600 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:53.603 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 20:28:53.624 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 20:28:53.628 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 20:28:53.631 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 20:28:53.633 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 20:28:53.636 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 20:28:53.637 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 20:28:53.640 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 20:28:53.656 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend) in 112.1411ms
2025-06-05 20:28:53.663 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)'
2025-06-05 20:28:53.665 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:28:53.666 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:28:53.669 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:53.671 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 20:28:53.672 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Categories - 200 736 application/json; charset=utf-8 164.3082ms
2025-06-05 20:28:53.693 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Transactions?userId=1155&lastDate=2025-06-05T17%3A28%3A53&pageSize=10 - null null
2025-06-05 20:28:53.697 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 20:28:53.698 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions'
2025-06-05 20:28:53.699 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)' with route pattern 'api/Transactions' is valid for the request path '/api/Transactions'
2025-06-05 20:28:53.703 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)'
2025-06-05 20:28:53.704 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:28:53.705 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:28:53.707 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)'
2025-06-05 20:28:53.715 +03:00 [INF] Route matched with {action = "GetTransactions", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO]]] GetTransactions(Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 20:28:53.718 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:28:53.720 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:28:53.721 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:28:53.723 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:28:53.725 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:28:53.727 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 20:28:53.729 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 20:28:53.735 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO' ...
2025-06-05 20:28:53.738 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO' using the name '' in request data ...
2025-06-05 20:28:53.741 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-06-05 20:28:53.744 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.userId' of type 'System.Int32'.
2025-06-05 20:28:53.747 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.lastDate' of type 'System.Nullable`1[System.DateTime]' using the name 'lastDate' in request data ...
2025-06-05 20:28:53.750 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.lastDate' of type 'System.Nullable`1[System.DateTime]'.
2025-06-05 20:28:53.752 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-06-05 20:28:53.754 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.pageSize' of type 'System.Int32'.
2025-06-05 20:28:53.757 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO'.
2025-06-05 20:28:53.759 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO'.
2025-06-05 20:28:53.761 +03:00 [DBG] Attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO' ...
2025-06-05 20:28:53.764 +03:00 [DBG] Done attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO'.
2025-06-05 20:28:53.807 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:28:53.815 +03:00 [DBG] Compiling query expression: 
'DbSet<Transaction>()
    .Where(t => t.UserId == __userId_0)
    .OrderByDescending(t => t.Date)
    .Where(t => t.Date < __lastDate_Value_1)
    .OrderByDescending(t => t.Date)
    .Take(__p_2)'
2025-06-05 20:28:53.831 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Transaction>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Transaction.CategoryId (int) Required FK Index, 1], [Property: Transaction.Date (DateTime) Required, 2], [Property: Transaction.InnerCategoryId (int?) FK Index, 3], [Property: Transaction.Name (string) Required MaxLength(50), 4], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 5], [Property: Transaction.UserId (int) Required FK Index, 6] }
        SELECT TOP(@__p_2) t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        WHERE (t.user_fk == @__userId_0) && (t.date < @__lastDate_Value_1)
        ORDER BY t.date DESC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Transaction.CategoryId (int) Required FK Index, 1], [Property: Transaction.Date (DateTime) Required, 2], [Property: Transaction.InnerCategoryId (int?) FK Index, 3], [Property: Transaction.Name (string) Required MaxLength(50), 4], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 5], [Property: Transaction.UserId (int) Required FK Index, 6] }
        SELECT TOP(@__p_2) t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        WHERE (t.user_fk == @__userId_0) && (t.date < @__lastDate_Value_1)
        ORDER BY t.date DESC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Transaction entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Transaction instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Transaction);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Transaction.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Transaction)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]: 
                        {
                            return 
                            {
                                Transaction instance;
                                instance = new Transaction();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(1);
                                instance.<Date>k__BackingField = dataReader.GetDateTime(2);
                                instance.<InnerCategoryId>k__BackingField = dataReader.IsDBNull(3) ? default(int?) : (int?)dataReader.GetInt32(3);
                                instance.<Name>k__BackingField = dataReader.GetString(4);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(5);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(6);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Transaction)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 20:28:53.848 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:28:53.854 +03:00 [DBG] Created DbConnection. (6ms).
2025-06-05 20:28:53.859 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:53.864 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:53.875 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:53.881 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (6ms).
2025-06-05 20:28:53.887 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (12ms).
2025-06-05 20:28:53.891 +03:00 [DBG] Executing DbCommand [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__lastDate_Value_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
WHERE [t].[user_fk] = @__userId_0 AND [t].[date] < @__lastDate_Value_1
ORDER BY [t].[date] DESC
2025-06-05 20:28:53.906 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__lastDate_Value_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
WHERE [t].[user_fk] = @__userId_0 AND [t].[date] < @__lastDate_Value_1
ORDER BY [t].[date] DESC
2025-06-05 20:28:53.923 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.926 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.928 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.930 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.933 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.935 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.938 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.939 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.941 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.943 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:53.944 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:53.948 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 27ms reading results.
2025-06-05 20:28:53.950 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:53.953 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 20:28:53.960 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 20:28:53.963 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 20:28:53.965 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 20:28:53.967 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 20:28:53.967 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 20:28:53.970 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 20:28:53.971 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 20:28:53.977 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend) in 250.6526ms
2025-06-05 20:28:53.980 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)'
2025-06-05 20:28:53.981 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:28:53.982 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:28:53.983 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:53.985 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 20:28:53.987 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Transactions?userId=1155&lastDate=2025-06-05T17%3A28%3A53&pageSize=10 - 200 1345 application/json; charset=utf-8 294.4266ms
2025-06-05 20:28:53.999 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Savings?userId=1155&previousSavingId=1&pageSize=5 - null null
2025-06-05 20:28:54.002 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 20:28:54.003 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 20:28:54.004 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 20:28:54.006 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)'
2025-06-05 20:28:54.007 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:28:54.008 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:28:54.010 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)'
2025-06-05 20:28:54.015 +03:00 [INF] Route matched with {action = "GetSavings", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingDTO]]] GetSavings(Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 20:28:54.017 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:28:54.018 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:28:54.020 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:28:54.022 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:28:54.023 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:28:54.027 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 20:28:54.032 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 20:28:54.036 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO' ...
2025-06-05 20:28:54.041 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO' using the name '' in request data ...
2025-06-05 20:28:54.044 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-06-05 20:28:54.049 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.userId' of type 'System.Int32'.
2025-06-05 20:28:54.053 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.previousSavingId' of type 'System.Int32' using the name 'previousSavingId' in request data ...
2025-06-05 20:28:54.059 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.previousSavingId' of type 'System.Int32'.
2025-06-05 20:28:54.062 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-06-05 20:28:54.066 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.pageSize' of type 'System.Int32'.
2025-06-05 20:28:54.068 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO'.
2025-06-05 20:28:54.072 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO'.
2025-06-05 20:28:54.073 +03:00 [DBG] Attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO' ...
2025-06-05 20:28:54.075 +03:00 [DBG] Done attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO'.
2025-06-05 20:28:54.084 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:28:54.089 +03:00 [DBG] Compiling query expression: 
'DbSet<Saving>()
    .Where(s => s.UserId == __userId_0 && s.Id > __previousSavingId_1)
    .Take(__p_2)'
2025-06-05 20:28:54.092 +03:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-06-05 20:28:54.098 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Saving>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
        SELECT TOP(@__p_2) s.id, s.current_amount, s.goal, s.name, s.user_fk
        FROM savings AS s
        WHERE (s.user_fk == @__userId_0) && (s.id > @__previousSavingId_1)) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
        SELECT TOP(@__p_2) s.id, s.current_amount, s.goal, s.name, s.user_fk
        FROM savings AS s
        WHERE (s.user_fk == @__userId_0) && (s.id > @__previousSavingId_1), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Saving entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Saving instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Saving);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Saving.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Saving)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]: 
                        {
                            return 
                            {
                                Saving instance;
                                instance = new Saving();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<CurrentAmount>k__BackingField = dataReader.GetDecimal(1);
                                instance.<Goal>k__BackingField = dataReader.GetDecimal(2);
                                instance.<Name>k__BackingField = dataReader.GetString(3);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(4);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Saving)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 20:28:54.106 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:28:54.107 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 20:28:54.109 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:54.110 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:54.112 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:54.114 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:54.121 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2025-06-05 20:28:54.123 +03:00 [DBG] Executing DbCommand [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__previousSavingId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[user_fk] = @__userId_0 AND [s].[id] > @__previousSavingId_1
2025-06-05 20:28:54.131 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__previousSavingId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[user_fk] = @__userId_0 AND [s].[id] > @__previousSavingId_1
2025-06-05 20:28:54.137 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:54.139 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:54.140 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:54.142 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:28:54.144 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:54.146 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 10ms reading results.
2025-06-05 20:28:54.149 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:54.153 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (3ms).
2025-06-05 20:28:54.158 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 20:28:54.160 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 20:28:54.162 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 20:28:54.164 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 20:28:54.165 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 20:28:54.166 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 20:28:54.167 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 20:28:54.173 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend) in 146.7192ms
2025-06-05 20:28:54.177 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)'
2025-06-05 20:28:54.180 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:28:54.182 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:28:54.184 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:54.189 +03:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-06-05 20:28:54.191 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Savings?userId=1155&previousSavingId=1&pageSize=5 - 200 327 application/json; charset=utf-8 191.8227ms
2025-06-05 20:28:54.196 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Analytics/overview?userId=1155&minDate=2025-05-29T17%3A28%3A54&maxDate=2025-06-05T17%3A28%3A54 - null null
2025-06-05 20:28:54.199 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 20:28:54.200 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Analytics/overview'
2025-06-05 20:28:54.202 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)' with route pattern 'api/Analytics/overview' is valid for the request path '/api/Analytics/overview'
2025-06-05 20:28:54.204 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)'
2025-06-05 20:28:54.205 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:28:54.206 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:28:54.207 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)'
2025-06-05 20:28:54.214 +03:00 [INF] Route matched with {action = "GetAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryPercentDTO]]] GetAnalytics(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO) on controller Finance_Manager_Backend.Controllers.AnalyticsController (Finance_Manager_Backend).
2025-06-05 20:28:54.216 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:28:54.218 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:28:54.219 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:28:54.221 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:28:54.223 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:28:54.224 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AnalyticsController (Finance_Manager_Backend)
2025-06-05 20:28:54.226 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AnalyticsController (Finance_Manager_Backend)
2025-06-05 20:28:54.228 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO' ...
2025-06-05 20:28:54.229 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO' using the name '' in request data ...
2025-06-05 20:28:54.231 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-06-05 20:28:54.233 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.userId' of type 'System.Int32'.
2025-06-05 20:28:54.235 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.minDate' of type 'System.DateTime' using the name 'minDate' in request data ...
2025-06-05 20:28:54.237 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.minDate' of type 'System.DateTime'.
2025-06-05 20:28:54.239 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.maxDate' of type 'System.DateTime' using the name 'maxDate' in request data ...
2025-06-05 20:28:54.241 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.maxDate' of type 'System.DateTime'.
2025-06-05 20:28:54.244 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO'.
2025-06-05 20:28:54.245 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO'.
2025-06-05 20:28:54.247 +03:00 [DBG] Attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO' ...
2025-06-05 20:28:54.249 +03:00 [DBG] Done attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO'.
2025-06-05 20:28:54.260 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:28:54.266 +03:00 [DBG] Compiling query expression: 
'DbSet<Transaction>()
    .Where(s => s.UserId == __userId_0 && !(s.Category.IsIncome) && s.Date > __minDate_1 && s.Date < __maxDate_2)
    .GroupBy(s => s.Category)'
2025-06-05 20:28:54.409 +03:00 [DBG] Generated query execution expression: 
'queryContext => GroupBySingleQueryingEnumerable.Create<Category, Transaction>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
            1 -> 0
            2 -> 1
            3 -> 2
            4 -> 3
            5 -> 4
            6 -> 5
            7 -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Transaction.CategoryId (int) Required FK Index, 7], [Property: Transaction.Date (DateTime) Required, 8], [Property: Transaction.InnerCategoryId (int?) FK Index, 9], [Property: Transaction.Name (string) Required MaxLength(50), 10], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 11], [Property: Transaction.UserId (int) Required FK Index, 12] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk, t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        INNER JOIN categories AS c ON t.category_fk == c.id
        WHERE (((t.user_fk == @__userId_0) && Not(c.is_income)) && (t.date > @__minDate_1)) && (t.date < @__maxDate_2)
        ORDER BY c.id ASC, c.background_color ASC, c.icon_path ASC, c.is_income ASC, c.name ASC, c.parent_category_fk ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
            1 -> 0
            2 -> 1
            3 -> 2
            4 -> 3
            5 -> 4
            6 -> 5
            7 -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Transaction.CategoryId (int) Required FK Index, 7], [Property: Transaction.Date (DateTime) Required, 8], [Property: Transaction.InnerCategoryId (int?) FK Index, 9], [Property: Transaction.Name (string) Required MaxLength(50), 10], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 11], [Property: Transaction.UserId (int) Required FK Index, 12] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk, t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        INNER JOIN categories AS c ON t.category_fk == c.id
        WHERE (((t.user_fk == @__userId_0) && Not(c.is_income)) && (t.date > @__minDate_1)) && (t.date < @__maxDate_2)
        ORDER BY c.id ASC, c.background_color ASC, c.icon_path ASC, c.is_income ASC, c.name ASC, c.parent_category_fk ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    keySelector: (queryContext, dataReader) => 
    {
        MaterializationContext materializationContext1;
        IEntityType entityType1;
        Category instance1;
        InternalEntityEntry entry1;
        bool hasNullKey1;
        materializationContext1 = new MaterializationContext(
            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
            queryContext.Context
        );
        instance1 = default(Category);
        entry1 = queryContext.TryGetEntry(
            key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
            keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
            throwOnNullKey: True, 
            hasNullKey: hasNullKey1);
        !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
        {
            entityType1 = entry1.EntityType;
            return instance1 = (Category)entry1.Entity;
        } : 
        {
            ISnapshot shadowSnapshot1;
            shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
            entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
            instance1 = switch (entityType1)
            {
                case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                    {
                        return 
                        {
                            Category instance;
                            instance = new Category();
                            instance.<Id>k__BackingField = dataReader.GetInt32(0);
                            instance.<ColorForBackground>k__BackingField = dataReader.GetString(1);
                            instance.<Icon>k__BackingField = dataReader.GetString(2);
                            instance.<IsIncome>k__BackingField = dataReader.GetBoolean(3);
                            instance.<Name>k__BackingField = dataReader.GetString(4);
                            instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5);
                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                context: materializationContext1.Context, 
                                entity: instance, 
                                queryTrackingBehavior: TrackAll, 
                                structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                            return instance;
                        }}
                default: 
                    default(Category)
            }
            ;
            entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                entityType: entityType1, 
                entity: instance1, 
                snapshot: shadowSnapshot1);
            return instance1;
        } : default(void);
        return instance1;
    }, 
    keyIdentifier: (queryContext, dataReader) => new object[]
    { 
        (object)(int?)dataReader.GetInt32(0), 
        dataReader.GetString(1), 
        dataReader.GetString(2), 
        (object)(bool?)dataReader.GetBoolean(3), 
        dataReader.GetString(4), 
        (object)dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5) 
    }, 
    keyIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
    { 
        (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
        (left, right) => left == null ? right == null : right != null && (string)left == (string)right, 
        (left, right) => left == null ? right == null : right != null && (string)left == (string)right, 
        (left, right) => left == null ? right == null : right != null && (bool)left == (bool)right, 
        (left, right) => left == null ? right == null : right != null && (string)left == (string)right, 
        (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
    }], 
    elementSelector: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Transaction entity;
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Transaction instance2;
            InternalEntityEntry entry2;
            bool hasNullKey2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Transaction);
            entry2 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Transaction.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(6) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey2);
            !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
            {
                entityType2 = entry2.EntityType;
                return instance2 = (Transaction)entry2.Entity;
            } : 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]: 
                        {
                            return 
                            {
                                Transaction instance;
                                instance = new Transaction();
                                instance.<Id>k__BackingField = dataReader.GetInt32(6);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(7);
                                instance.<Date>k__BackingField = dataReader.GetDateTime(8);
                                instance.<InnerCategoryId>k__BackingField = dataReader.IsDBNull(9) ? default(int?) : (int?)dataReader.GetInt32(9);
                                instance.<Name>k__BackingField = dataReader.GetString(10);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(11);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Transaction)
                }
                ;
                entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType2, 
                    entity: instance2, 
                    snapshot: shadowSnapshot2);
                return instance2;
            } : default(void);
            return instance2;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 20:28:54.467 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:28:54.468 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 20:28:54.469 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:54.471 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:54.473 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:28:54.474 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:28:54.476 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 20:28:54.478 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32), @__minDate_1='?' (DbType = DateTime2), @__maxDate_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
WHERE [t].[user_fk] = @__userId_0 AND [c].[is_income] = CAST(0 AS bit) AND [t].[date] > @__minDate_1 AND [t].[date] < @__maxDate_2
ORDER BY [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
2025-06-05 20:28:54.487 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (DbType = Int32), @__minDate_1='?' (DbType = DateTime2), @__maxDate_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
WHERE [t].[user_fk] = @__userId_0 AND [c].[is_income] = CAST(0 AS bit) AND [t].[date] > @__minDate_1 AND [t].[date] < @__maxDate_2
ORDER BY [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
2025-06-05 20:28:54.491 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:54.493 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 20:28:54.495 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:54.496 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:28:54.502 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 20:28:54.505 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 20:28:54.508 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 20:28:54.510 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 20:28:54.510 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 20:28:54.511 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 20:28:54.513 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryPercentDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 20:28:54.515 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend) in 291.1449ms
2025-06-05 20:28:54.521 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)'
2025-06-05 20:28:54.524 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:28:54.525 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:28:54.526 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:28:54.527 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 20:28:54.529 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Analytics/overview?userId=1155&minDate=2025-05-29T17%3A28%3A54&maxDate=2025-06-05T17%3A28%3A54 - 200 2 application/json; charset=utf-8 332.6839ms
2025-06-05 20:29:02.894 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:49464/api/Savings - application/json-patch+json 47
2025-06-05 20:29:02.898 +03:00 [DBG] PUT requests are not supported
2025-06-05 20:29:02.899 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 20:29:02.900 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 20:29:02.901 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 20:29:02.905 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:29:02.910 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:29:03.226 +03:00 [DBG] Authorization was successful.
2025-06-05 20:29:03.228 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 20:29:03.232 +03:00 [INF] Route matched with {action = "UpdateSaving", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] UpdateSaving(Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 20:29:03.234 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:29:03.236 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:29:03.238 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:29:03.240 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:29:03.242 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:29:03.243 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 20:29:03.246 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 20:29:03.247 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 20:29:03.249 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' using the name '' in request data ...
2025-06-05 20:29:03.251 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:29:03.253 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:29:03.254 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:00000008": started reading request body.
2025-06-05 20:29:03.255 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:00000008": done reading request body.
2025-06-05 20:29:03.262 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 20:29:03.264 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 20:29:03.265 +03:00 [DBG] Attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 20:29:03.268 +03:00 [DBG] Done attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 20:29:03.281 +03:00 [INF] Executing UdateSavingAsync method
2025-06-05 20:29:03.284 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 20:29:03.286 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:29:03.303 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:29:03.304 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 20:29:03.305 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:03.306 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:03.308 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 20:29:03.310 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 20:29:03.311 +03:00 [DBG] Start db transaction.
2025-06-05 20:29:03.315 +03:00 [DBG] Compiling query expression: 
'DbSet<Saving>()
    .FirstOrDefault(s => s.Id == __savingId_0)'
2025-06-05 20:29:03.320 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Saving>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Saving>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
            SELECT TOP(1) s.id, s.current_amount, s.goal, s.name, s.user_fk
            FROM savings AS s
            WHERE s.id == @__savingId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
            SELECT TOP(1) s.id, s.current_amount, s.goal, s.name, s.user_fk
            FROM savings AS s
            WHERE s.id == @__savingId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Saving entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Saving instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Saving);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Saving.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Saving)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]: 
                            {
                                return 
                                {
                                    Saving instance;
                                    instance = new Saving();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CurrentAmount>k__BackingField = dataReader.GetDecimal(1);
                                    instance.<Goal>k__BackingField = dataReader.GetDecimal(2);
                                    instance.<Name>k__BackingField = dataReader.GetString(3);
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(4);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Saving)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 20:29:03.324 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:29:03.326 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:29:03.327 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:29:03.329 +03:00 [DBG] Executing DbCommand [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 20:29:03.333 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 20:29:03.335 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:03.337 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:03.338 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 20:29:03.341 +03:00 [DBG] The navigation 'Saving.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:03.343 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:03.345 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 20:29:03.346 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 20:29:03.347 +03:00 [DBG] The unchanged property 'Saving.CurrentAmount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:29:03.348 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:03.350 +03:00 [DBG] The unchanged property 'User.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 20:29:03.352 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:03.354 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 20:29:03.355 +03:00 [DBG] Executing 2 update commands as a batch.
2025-06-05 20:29:03.359 +03:00 [DBG] Creating transaction savepoint.
2025-06-05 20:29:03.367 +03:00 [DBG] Created transaction savepoint.
2025-06-05 20:29:03.368 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:29:03.369 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:29:03.370 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:29:03.372 +03:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [savings] SET [current_amount] = @p0
OUTPUT 1
WHERE [id] = @p1;
UPDATE [users] SET [balance] = @p2
OUTPUT 1
WHERE [id] = @p3;
2025-06-05 20:29:03.386 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [savings] SET [current_amount] = @p0
OUTPUT 1
WHERE [id] = @p1;
UPDATE [users] SET [balance] = @p2
OUTPUT 1
WHERE [id] = @p3;
2025-06-05 20:29:03.389 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:03.390 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-06-05 20:29:03.392 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:03.394 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:03.396 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-06-05 20:29:03.398 +03:00 [DBG] Committing transaction.
2025-06-05 20:29:03.411 +03:00 [DBG] Committed transaction.
2025-06-05 20:29:03.412 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:03.413 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:29:03.415 +03:00 [INF] Transaction successful.
2025-06-05 20:29:03.416 +03:00 [DBG] Disposing transaction.
2025-06-05 20:29:03.418 +03:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-06-05 20:29:03.419 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend) in 175.4549ms
2025-06-05 20:29:03.420 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 20:29:03.422 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:29:03.425 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:29:03.427 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:03.429 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 20:29:03.430 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:49464/api/Savings - 204 null null 536.6147ms
2025-06-05 20:29:03.434 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1155 - null null
2025-06-05 20:29:03.436 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 20:29:03.437 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1155'
2025-06-05 20:29:03.439 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1155'
2025-06-05 20:29:03.440 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:03.441 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:29:03.443 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:29:03.444 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:03.445 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 20:29:03.447 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:29:03.449 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:29:03.450 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:29:03.452 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:29:03.454 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:29:03.456 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 20:29:03.457 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 20:29:03.458 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 20:29:03.460 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 20:29:03.461 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:03.463 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:03.464 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 20:29:03.465 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:03.467 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 20:29:03.469 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 20:29:03.471 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 20:29:03.472 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 20:29:03.473 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 20:29:03.474 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 20:29:03.475 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 20:29:03.477 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 21.2349ms
2025-06-05 20:29:03.479 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:03.481 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:29:03.482 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1155 - 200 104 application/json; charset=utf-8 48.5436ms
2025-06-05 20:29:11.772 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:49464/api/Savings - application/json-patch+json 47
2025-06-05 20:29:11.795 +03:00 [DBG] PUT requests are not supported
2025-06-05 20:29:11.797 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 20:29:11.801 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 20:29:11.803 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 20:29:11.805 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:29:11.809 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:29:11.813 +03:00 [DBG] Authorization was successful.
2025-06-05 20:29:11.820 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 20:29:11.821 +03:00 [INF] Route matched with {action = "UpdateSaving", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] UpdateSaving(Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 20:29:11.823 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:29:11.825 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:29:11.827 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:29:11.829 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:29:11.831 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:29:11.832 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 20:29:11.836 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 20:29:11.838 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 20:29:11.839 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' using the name '' in request data ...
2025-06-05 20:29:11.840 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:29:11.841 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:29:11.843 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:0000000A": started reading request body.
2025-06-05 20:29:11.844 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:0000000A": done reading request body.
2025-06-05 20:29:11.846 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 20:29:11.847 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 20:29:11.849 +03:00 [DBG] Attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 20:29:11.850 +03:00 [DBG] Done attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 20:29:11.852 +03:00 [INF] Executing UdateSavingAsync method
2025-06-05 20:29:11.853 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 20:29:11.855 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:29:11.859 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:29:11.860 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 20:29:11.861 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:11.862 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:11.864 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 20:29:11.865 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 20:29:11.867 +03:00 [DBG] Start db transaction.
2025-06-05 20:29:11.868 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:29:11.869 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:29:11.871 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:29:11.872 +03:00 [DBG] Executing DbCommand [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 20:29:11.876 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 20:29:11.879 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:11.880 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:11.882 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 20:29:11.883 +03:00 [DBG] The navigation 'Saving.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:11.885 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:11.889 +03:00 [ERR] Failed transaction: The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
2025-06-05 20:29:11.892 +03:00 [DBG] Rolling back transaction.
2025-06-05 20:29:11.895 +03:00 [DBG] Rolled back transaction.
2025-06-05 20:29:11.896 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:11.897 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:29:11.899 +03:00 [DBG] Disposing transaction.
2025-06-05 20:29:11.900 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend) in 67.4837ms
2025-06-05 20:29:11.902 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 20:29:11.903 +03:00 [ERR] The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState[TEntity](TEntity entity, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.Attach[TEntity](TEntity entity)
   at Finance_Manager_Backend.BusinessLogic.Services.SavingsService.<>c__DisplayClass10_0.<<UpdateSavingAsync>b__0>d.MoveNext() in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\SavingsService.cs:line 79
--- End of stack trace from previous location ---
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 31
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 51
   at Finance_Manager_Backend.BusinessLogic.Services.SavingsService.UpdateSavingAsync(Int32 savingId, Decimal topUpAmount) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\SavingsService.cs:line 71
   at Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving(SavingTopUpDTO topUpDTO) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\SavingsController.cs:line 112
   at lambda_method646(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-06-05 20:29:11.939 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:29:11.941 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:29:11.942 +03:00 [DBG] Connection id "0HND4APH73JBO" accepted.
2025-06-05 20:29:11.943 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:11.944 +03:00 [DBG] Connection id "0HND4APH73JBO" started.
2025-06-05 20:29:11.945 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 20:29:11.948 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:49464/api/Savings - 400 null application/json 176.1905ms
2025-06-05 20:29:11.948 +03:00 [DBG] Connection 0HND4APH73JBO established using the following protocol: "Tls12"
2025-06-05 20:29:11.957 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1155 - null null
2025-06-05 20:29:11.959 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 20:29:11.960 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1155'
2025-06-05 20:29:11.962 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1155'
2025-06-05 20:29:11.963 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:11.965 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:29:11.966 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:29:11.967 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:11.968 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 20:29:11.970 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:29:11.972 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:29:11.973 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:29:11.975 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:29:11.977 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:29:11.978 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 20:29:11.980 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 20:29:11.981 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 20:29:11.983 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 20:29:11.984 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:11.986 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:11.987 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 20:29:11.988 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:11.990 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 20:29:11.992 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 20:29:11.994 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 20:29:11.995 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 20:29:11.996 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 20:29:11.997 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 20:29:11.998 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 20:29:12.000 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 21.4326ms
2025-06-05 20:29:12.002 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:12.003 +03:00 [DBG] Connection id "0HND4APH73JBO" completed keep alive response.
2025-06-05 20:29:12.003 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1155 - 200 104 application/json; charset=utf-8 46.6946ms
2025-06-05 20:29:21.416 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:49464/api/Savings - application/json-patch+json 46
2025-06-05 20:29:21.423 +03:00 [DBG] PUT requests are not supported
2025-06-05 20:29:21.425 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 20:29:21.427 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 20:29:21.428 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 20:29:21.429 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:29:21.430 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:29:21.433 +03:00 [DBG] Authorization was successful.
2025-06-05 20:29:21.434 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 20:29:21.435 +03:00 [INF] Route matched with {action = "UpdateSaving", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] UpdateSaving(Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 20:29:21.437 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:29:21.444 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:29:21.447 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:29:21.449 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:29:21.451 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:29:21.453 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 20:29:21.459 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 20:29:21.461 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 20:29:21.462 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' using the name '' in request data ...
2025-06-05 20:29:21.465 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:29:21.466 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:29:21.468 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:0000000B": started reading request body.
2025-06-05 20:29:21.470 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:0000000B": done reading request body.
2025-06-05 20:29:21.472 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 20:29:21.476 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 20:29:21.478 +03:00 [DBG] Attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 20:29:21.480 +03:00 [DBG] Done attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 20:29:21.482 +03:00 [INF] Executing UdateSavingAsync method
2025-06-05 20:29:21.483 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 20:29:21.485 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:29:21.499 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:29:21.500 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 20:29:21.501 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:21.504 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:21.506 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 20:29:21.509 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 20:29:21.510 +03:00 [DBG] Start db transaction.
2025-06-05 20:29:21.511 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 20:29:21.512 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 20:29:21.513 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 20:29:21.515 +03:00 [DBG] Executing DbCommand [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 20:29:21.519 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 20:29:21.521 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:21.522 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:21.524 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 20:29:21.525 +03:00 [DBG] The navigation 'Saving.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:21.527 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:21.529 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:21.531 +03:00 [ERR] Failed transaction: The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
2025-06-05 20:29:21.532 +03:00 [DBG] Rolling back transaction.
2025-06-05 20:29:21.533 +03:00 [DBG] Rolled back transaction.
2025-06-05 20:29:21.534 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:21.535 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:29:21.537 +03:00 [DBG] Disposing transaction.
2025-06-05 20:29:21.538 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend) in 85.2525ms
2025-06-05 20:29:21.540 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 20:29:21.541 +03:00 [ERR] The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState[TEntity](TEntity entity, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.Attach[TEntity](TEntity entity)
   at Finance_Manager_Backend.BusinessLogic.Services.SavingsService.<>c__DisplayClass10_0.<<UpdateSavingAsync>b__0>d.MoveNext() in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\SavingsService.cs:line 79
--- End of stack trace from previous location ---
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 31
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 51
   at Finance_Manager_Backend.BusinessLogic.Services.SavingsService.UpdateSavingAsync(Int32 savingId, Decimal topUpAmount) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\SavingsService.cs:line 71
   at Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving(SavingTopUpDTO topUpDTO) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\SavingsController.cs:line 112
   at lambda_method646(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-06-05 20:29:21.550 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:29:21.551 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1155 - null null
2025-06-05 20:29:21.551 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:29:21.554 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 20:29:21.555 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:21.556 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1155'
2025-06-05 20:29:21.557 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 20:29:21.558 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1155'
2025-06-05 20:29:21.559 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:49464/api/Savings - 400 null application/json 143.3436ms
2025-06-05 20:29:21.561 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:21.565 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:29:21.566 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:29:21.567 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:21.569 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 20:29:21.570 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:29:21.572 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:29:21.574 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:29:21.576 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:29:21.577 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:29:21.579 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 20:29:21.581 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 20:29:21.582 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 20:29:21.583 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 20:29:21.585 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:21.587 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:21.588 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 20:29:21.589 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:21.591 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 20:29:21.593 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 20:29:21.594 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 20:29:21.596 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 20:29:21.597 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 20:29:21.598 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 20:29:21.599 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 20:29:21.601 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 21.7164ms
2025-06-05 20:29:21.602 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:21.603 +03:00 [DBG] Connection id "0HND4APH73JBO" completed keep alive response.
2025-06-05 20:29:21.603 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1155 - 200 104 application/json; charset=utf-8 52.6784ms
2025-06-05 20:29:31.063 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:49464/api/Transactions - application/json-patch+json 129
2025-06-05 20:29:31.083 +03:00 [DBG] PUT requests are not supported
2025-06-05 20:29:31.084 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions'
2025-06-05 20:29:31.086 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.UpdateTransaction (Finance_Manager_Backend)' with route pattern 'api/Transactions' is valid for the request path '/api/Transactions'
2025-06-05 20:29:31.088 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.UpdateTransaction (Finance_Manager_Backend)'
2025-06-05 20:29:31.090 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:29:31.107 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:29:31.109 +03:00 [DBG] Authorization was successful.
2025-06-05 20:29:31.110 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.UpdateTransaction (Finance_Manager_Backend)'
2025-06-05 20:29:31.117 +03:00 [INF] Route matched with {action = "UpdateTransaction", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] UpdateTransaction(Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 20:29:31.119 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:29:31.121 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:29:31.122 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:29:31.125 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:29:31.127 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:29:31.128 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 20:29:31.130 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 20:29:31.133 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 20:29:31.134 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' using the name '' in request data ...
2025-06-05 20:29:31.137 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:29:31.138 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 20:29:31.139 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:0000000C": started reading request body.
2025-06-05 20:29:31.140 +03:00 [DBG] Connection id "0HND4APH73JBN", Request id "0HND4APH73JBN:0000000C": done reading request body.
2025-06-05 20:29:31.146 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 20:29:31.147 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 20:29:31.148 +03:00 [DBG] Attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 20:29:31.152 +03:00 [DBG] Done attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 20:29:31.171 +03:00 [INF] Executing UpdateTransactionAsync method.
2025-06-05 20:29:31.172 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 20:29:31.173 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 20:29:31.175 +03:00 [DBG] Creating DbConnection.
2025-06-05 20:29:31.176 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 20:29:31.177 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:31.178 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:31.180 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 20:29:31.181 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 20:29:31.182 +03:00 [DBG] Start db transaction.
2025-06-05 20:29:31.184 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:31.186 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 20:29:31.187 +03:00 [ERR] Failed transaction: The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
2025-06-05 20:29:31.189 +03:00 [DBG] Rolling back transaction.
2025-06-05 20:29:31.190 +03:00 [DBG] Rolled back transaction.
2025-06-05 20:29:31.190 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:31.192 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 20:29:31.193 +03:00 [DBG] Disposing transaction.
2025-06-05 20:29:31.195 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.UpdateTransaction (Finance_Manager_Backend) in 66.2854ms
2025-06-05 20:29:31.196 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.UpdateTransaction (Finance_Manager_Backend)'
2025-06-05 20:29:31.197 +03:00 [ERR] The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
System.InvalidOperationException: The instance of entity type 'Saving' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.SetEntityState[TEntity](TEntity entity, EntityState entityState)
   at Microsoft.EntityFrameworkCore.DbContext.Attach[TEntity](TEntity entity)
   at Finance_Manager_Backend.BusinessLogic.Services.TransactionsService.<>c__DisplayClass11_0.<<UpdateTransactionAsync>b__0>d.MoveNext() in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\TransactionsService.cs:line 104
--- End of stack trace from previous location ---
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 31
   at Finance_Manager_Backend.DataBase.DbTransactionTemplate.ExecuteTransactionAsync(Func`1 transaction) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\DataBase\DbTransactionTemplate.cs:line 51
   at Finance_Manager_Backend.BusinessLogic.Services.TransactionsService.UpdateTransactionAsync(TransactionDTO newUserTransactionDTO) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\TransactionsService.cs:line 100
   at Finance_Manager_Backend.Controllers.TransactionsController.UpdateTransaction(TransactionDTO transactionDTO) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\TransactionsController.cs:line 113
   at lambda_method669(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-06-05 20:29:31.206 +03:00 [DBG] Connection id "0HND4APH73JBN" completed keep alive response.
2025-06-05 20:29:31.207 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1155 - null null
2025-06-05 20:29:31.207 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 20:29:31.210 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 20:29:31.211 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 20:29:31.212 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1155'
2025-06-05 20:29:31.213 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 20:29:31.214 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1155'
2025-06-05 20:29:31.216 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:49464/api/Transactions - 400 null application/json 153.4838ms
2025-06-05 20:29:31.218 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:31.222 +03:00 [DBG] Successfully validated the token.
2025-06-05 20:29:31.223 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 20:29:31.224 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:31.225 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 20:29:31.227 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 20:29:31.229 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 20:29:31.230 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 20:29:31.232 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 20:29:31.234 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 20:29:31.235 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 20:29:31.237 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 20:29:31.238 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 20:29:31.240 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 20:29:31.241 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:31.243 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:31.244 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 20:29:31.245 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 20:29:31.247 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 20:29:31.249 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 20:29:31.250 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 20:29:31.252 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 20:29:31.253 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 20:29:31.253 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 20:29:31.255 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 20:29:31.256 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 21.2386ms
2025-06-05 20:29:31.258 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 20:29:31.258 +03:00 [DBG] Connection id "0HND4APH73JBO" completed keep alive response.
2025-06-05 20:29:31.259 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1155 - 200 104 application/json; charset=utf-8 52.3285ms
2025-06-05 20:29:47.926 +03:00 [DBG] Connection id "0HND4APH73JBN" reset.
2025-06-05 20:29:47.927 +03:00 [DBG] Connection id "0HND4APH73JBO" reset.
2025-06-05 20:29:47.944 +03:00 [DBG] Connection id "0HND4APH73JBN" disconnecting.
2025-06-05 20:29:47.952 +03:00 [DBG] Connection id "0HND4APH73JBO" disconnecting.
2025-06-05 20:29:47.960 +03:00 [DBG] Connection id "0HND4APH73JBN" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-05 20:29:47.969 +03:00 [DBG] Connection id "0HND4APH73JBO" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-05 20:29:47.999 +03:00 [DBG] Connection id "0HND4APH73JBN" stopped.
2025-06-05 20:29:48.005 +03:00 [DBG] Connection id "0HND4APH73JBO" stopped.
2025-06-05 20:30:53.434 +03:00 [DBG] HttpMessageHandler expired after 120000ms for client 'CurrencyConverterService'
2025-06-05 20:31:03.437 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:31:03.444 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0271ms - processed: 0 items - remaining: 1 items
2025-06-05 20:31:13.451 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:31:13.452 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.1072ms - processed: 0 items - remaining: 1 items
2025-06-05 20:31:23.463 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:31:23.464 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0029ms - processed: 0 items - remaining: 1 items
2025-06-05 20:31:33.477 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:31:33.478 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0029ms - processed: 0 items - remaining: 1 items
2025-06-05 20:31:43.485 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:31:43.488 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0031ms - processed: 0 items - remaining: 1 items
2025-06-05 20:31:53.492 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:31:53.494 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0031ms - processed: 0 items - remaining: 1 items
2025-06-05 20:32:03.500 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:32:03.502 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0029ms - processed: 0 items - remaining: 1 items
2025-06-05 20:32:13.518 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:32:13.519 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.1009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:32:23.536 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:32:23.538 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0022ms - processed: 0 items - remaining: 1 items
2025-06-05 20:32:33.545 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:32:33.547 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0024ms - processed: 0 items - remaining: 1 items
2025-06-05 20:32:43.559 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:32:43.561 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0427ms - processed: 0 items - remaining: 1 items
2025-06-05 20:32:53.561 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:32:53.563 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0031ms - processed: 0 items - remaining: 1 items
2025-06-05 20:33:03.586 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:33:03.683 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0026ms - processed: 0 items - remaining: 1 items
2025-06-05 20:33:13.727 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:33:13.740 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0027ms - processed: 0 items - remaining: 1 items
2025-06-05 20:33:23.744 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:33:23.746 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0024ms - processed: 0 items - remaining: 1 items
2025-06-05 20:33:33.761 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:33:33.763 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0023ms - processed: 0 items - remaining: 1 items
2025-06-05 20:33:43.773 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:33:43.775 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0024ms - processed: 0 items - remaining: 1 items
2025-06-05 20:33:53.782 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:33:53.783 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0021ms - processed: 0 items - remaining: 1 items
2025-06-05 20:34:03.801 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:34:03.808 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0023ms - processed: 0 items - remaining: 1 items
2025-06-05 20:34:13.814 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:34:13.815 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0022ms - processed: 0 items - remaining: 1 items
2025-06-05 20:34:23.826 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:34:23.827 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0029ms - processed: 0 items - remaining: 1 items
2025-06-05 20:34:33.830 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:34:33.831 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0025ms - processed: 0 items - remaining: 1 items
2025-06-05 20:34:43.842 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:34:43.843 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0023ms - processed: 0 items - remaining: 1 items
2025-06-05 20:34:53.856 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:34:53.858 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0022ms - processed: 0 items - remaining: 1 items
2025-06-05 20:35:03.869 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:35:03.871 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0031ms - processed: 0 items - remaining: 1 items
2025-06-05 20:35:13.885 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:35:13.886 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0027ms - processed: 0 items - remaining: 1 items
2025-06-05 20:35:23.891 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:35:23.893 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0026ms - processed: 0 items - remaining: 1 items
2025-06-05 20:35:33.909 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:35:33.910 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0028ms - processed: 0 items - remaining: 1 items
2025-06-05 20:35:43.921 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:35:43.922 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0028ms - processed: 0 items - remaining: 1 items
2025-06-05 20:35:53.925 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:35:53.927 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0027ms - processed: 0 items - remaining: 1 items
2025-06-05 20:36:03.933 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:36:03.937 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0124ms - processed: 0 items - remaining: 1 items
2025-06-05 20:36:13.946 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:36:13.948 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0019ms - processed: 0 items - remaining: 1 items
2025-06-05 20:36:23.961 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:36:23.962 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0019ms - processed: 0 items - remaining: 1 items
2025-06-05 20:36:33.975 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:36:33.977 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0019ms - processed: 0 items - remaining: 1 items
2025-06-05 20:36:43.985 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:36:43.986 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0018ms - processed: 0 items - remaining: 1 items
2025-06-05 20:36:53.996 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:36:53.998 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0016ms - processed: 0 items - remaining: 1 items
2025-06-05 20:37:04.004 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:37:04.006 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0019ms - processed: 0 items - remaining: 1 items
2025-06-05 20:37:14.009 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:37:14.010 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0021ms - processed: 0 items - remaining: 1 items
2025-06-05 20:37:24.016 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:37:24.018 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.002ms - processed: 0 items - remaining: 1 items
2025-06-05 20:37:34.028 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:37:34.036 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0025ms - processed: 0 items - remaining: 1 items
2025-06-05 20:37:44.060 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:37:44.070 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0023ms - processed: 0 items - remaining: 1 items
2025-06-05 20:37:54.088 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:37:54.090 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0035ms - processed: 0 items - remaining: 1 items
2025-06-05 20:38:04.095 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:38:04.101 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0016ms - processed: 0 items - remaining: 1 items
2025-06-05 20:38:14.112 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:38:14.114 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0018ms - processed: 0 items - remaining: 1 items
2025-06-05 20:38:24.119 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:38:24.121 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0022ms - processed: 0 items - remaining: 1 items
2025-06-05 20:38:34.125 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:38:34.126 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0018ms - processed: 0 items - remaining: 1 items
2025-06-05 20:38:44.128 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:38:44.129 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.002ms - processed: 0 items - remaining: 1 items
2025-06-05 20:38:54.145 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:38:54.146 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.002ms - processed: 0 items - remaining: 1 items
2025-06-05 20:39:04.162 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:39:04.163 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0022ms - processed: 0 items - remaining: 1 items
2025-06-05 20:39:14.174 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:39:14.175 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.002ms - processed: 0 items - remaining: 1 items
2025-06-05 20:39:24.191 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:39:24.193 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.002ms - processed: 0 items - remaining: 1 items
2025-06-05 20:39:34.195 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:39:34.196 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0018ms - processed: 0 items - remaining: 1 items
2025-06-05 20:39:44.209 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:39:44.211 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0024ms - processed: 0 items - remaining: 1 items
2025-06-05 20:39:54.217 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:39:54.219 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0022ms - processed: 0 items - remaining: 1 items
2025-06-05 20:40:04.225 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:40:04.512 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0024ms - processed: 0 items - remaining: 1 items
2025-06-05 20:40:14.564 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:40:14.591 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.002ms - processed: 0 items - remaining: 1 items
2025-06-05 20:40:24.614 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:40:24.617 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0021ms - processed: 0 items - remaining: 1 items
2025-06-05 20:40:34.635 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:40:34.637 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.002ms - processed: 0 items - remaining: 1 items
2025-06-05 20:40:44.646 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:40:44.648 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0026ms - processed: 0 items - remaining: 1 items
2025-06-05 20:40:54.656 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:40:54.657 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0021ms - processed: 0 items - remaining: 1 items
2025-06-05 20:41:04.666 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:41:04.667 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.004ms - processed: 0 items - remaining: 1 items
2025-06-05 20:41:14.682 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:41:14.689 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0014ms - processed: 0 items - remaining: 1 items
2025-06-05 20:41:24.704 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:41:24.705 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:41:34.721 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:41:34.723 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:41:44.735 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:41:44.737 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 1 items
2025-06-05 20:41:54.752 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:41:54.754 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:42:04.768 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:42:04.769 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:42:14.772 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:42:14.774 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:42:24.782 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:42:24.783 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:42:34.790 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:42:34.791 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 1 items
2025-06-05 20:42:44.795 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:42:44.796 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:42:54.802 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:42:54.803 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:43:04.807 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:43:04.809 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:43:14.822 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:43:14.823 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:43:24.833 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:43:24.835 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:43:34.841 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:43:34.844 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:43:44.855 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:43:44.856 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:43:54.863 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:43:54.864 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:44:04.866 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:44:04.867 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:44:14.882 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:44:14.883 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0011ms - processed: 0 items - remaining: 1 items
2025-06-05 20:44:24.895 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:44:24.896 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 1 items
2025-06-05 20:44:34.907 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:44:34.909 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:44:44.916 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:44:44.917 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:44:54.925 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:44:54.926 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:45:04.934 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:45:04.936 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0011ms - processed: 0 items - remaining: 1 items
2025-06-05 20:45:14.948 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:45:14.950 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:45:24.956 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:45:24.958 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:45:34.998 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:45:35.301 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0018ms - processed: 0 items - remaining: 1 items
2025-06-05 20:45:45.348 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:45:45.350 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:45:55.364 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:45:55.365 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:46:05.379 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:46:05.380 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:46:15.382 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:46:15.383 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:46:25.391 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:46:25.396 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:46:35.414 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:46:35.415 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0011ms - processed: 0 items - remaining: 1 items
2025-06-05 20:46:45.419 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:46:45.421 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:46:55.451 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:46:55.452 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:47:05.469 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:47:05.470 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:47:15.484 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:47:15.485 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:47:25.488 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:47:25.490 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:47:35.501 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:47:35.504 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:47:45.511 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:47:45.513 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:47:55.523 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:47:55.524 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:48:05.533 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:48:05.535 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 1 items
2025-06-05 20:48:15.540 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:48:15.541 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:48:25.544 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:48:25.546 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:48:35.559 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:48:35.561 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0011ms - processed: 0 items - remaining: 1 items
2025-06-05 20:48:45.573 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:48:45.574 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:48:55.591 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:48:55.592 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:49:05.605 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:49:05.608 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:49:15.610 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:49:15.612 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:49:25.620 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:49:25.621 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:49:35.633 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:49:35.635 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:49:45.638 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:49:45.640 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:49:55.648 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:49:55.650 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:50:05.666 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:50:05.667 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:50:15.681 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:50:15.682 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0012ms - processed: 0 items - remaining: 1 items
2025-06-05 20:50:25.687 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:50:25.688 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:50:35.703 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:50:35.705 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:50:45.713 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:50:45.715 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:50:55.718 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:50:55.722 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:51:05.737 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:51:05.739 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:51:15.756 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:51:15.757 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:51:25.766 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:51:25.767 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:51:35.785 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:51:35.786 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:51:45.789 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:51:45.790 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:51:55.796 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:51:55.797 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:52:05.811 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:52:05.812 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0014ms - processed: 0 items - remaining: 1 items
2025-06-05 20:52:15.822 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:52:15.828 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:52:25.844 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:52:25.845 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0011ms - processed: 0 items - remaining: 1 items
2025-06-05 20:52:35.854 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:52:35.855 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0011ms - processed: 0 items - remaining: 1 items
2025-06-05 20:52:45.863 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:52:45.865 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:52:55.874 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:52:55.875 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:53:05.889 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:53:05.890 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0013ms - processed: 0 items - remaining: 1 items
2025-06-05 20:53:15.895 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:53:15.896 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0012ms - processed: 0 items - remaining: 1 items
2025-06-05 20:53:25.915 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:53:25.916 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:53:35.932 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:53:35.933 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:53:45.938 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:53:45.940 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:53:55.943 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:53:55.945 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:54:05.952 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:54:05.954 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:54:15.957 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:54:15.960 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0012ms - processed: 0 items - remaining: 1 items
2025-06-05 20:54:25.977 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:54:25.978 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:54:35.987 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:54:35.988 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:54:46.002 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:54:46.004 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0008ms - processed: 0 items - remaining: 1 items
2025-06-05 20:54:56.019 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:54:56.021 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0011ms - processed: 0 items - remaining: 1 items
2025-06-05 20:55:06.030 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:55:06.031 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:55:16.042 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:55:16.043 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:55:26.055 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:55:26.057 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:55:36.073 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:55:36.074 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:55:46.082 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:55:46.084 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:55:56.093 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:55:56.094 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:56:06.098 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:56:06.099 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:56:16.109 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:56:16.110 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0011ms - processed: 0 items - remaining: 1 items
2025-06-05 20:56:26.115 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:56:26.117 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.0009ms - processed: 0 items - remaining: 1 items
2025-06-05 20:56:36.127 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:56:36.128 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:56:46.139 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:56:46.142 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:56:56.147 +03:00 [DBG] Starting HttpMessageHandler cleanup cycle with 1 items
2025-06-05 20:56:56.148 +03:00 [DBG] Ending HttpMessageHandler cleanup cycle after 0.001ms - processed: 0 items - remaining: 1 items
2025-06-05 20:57:00.933 +03:00 [INF] Application is shutting down...
2025-06-05 20:57:00.934 +03:00 [DBG] Hosting stopping
2025-06-05 20:57:01.015 +03:00 [DBG] Hosting stopped
2025-06-05 21:32:19.911 +03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-06-05 21:32:21.037 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:21.181 +03:00 [DBG] Compiling query expression: 
'DbSet<User>()'
2025-06-05 21:32:21.509 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<User>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
        SELECT u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
        FROM users AS u) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
        SELECT u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
        FROM users AS u, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        User entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            User instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(User);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: User.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (User)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]: 
                        {
                            return 
                            {
                                User instance;
                                instance = new User();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Balance>k__BackingField = dataReader.GetDecimal(1);
                                instance.<Email>k__BackingField = dataReader.GetString(2);
                                instance.<PasswordHash>k__BackingField = dataReader.GetString(3);
                                instance.<PrimaryCurrency>k__BackingField = dataReader.GetString(4);
                                instance.<Role>k__BackingField = dataReader.GetString(5);
                                instance.<Salt>k__BackingField = dataReader.GetString(6);
                                instance.<SecondaryCurrency1>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                instance.<SecondaryCurrency2>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(User)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 21:32:21.560 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:21.646 +03:00 [DBG] Created DbConnection. (84ms).
2025-06-05 21:32:21.652 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:22.826 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:22.833 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:22.860 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (26ms).
2025-06-05 21:32:22.863 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (32ms).
2025-06-05 21:32:22.872 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
2025-06-05 21:32:22.924 +03:00 [INF] Executed DbCommand (52ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
2025-06-05 21:32:22.963 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.035 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.049 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.051 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.058 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.067 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 136ms reading results.
2025-06-05 21:32:23.070 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.081 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (10ms).
2025-06-05 21:32:23.086 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:32:23.091 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:32:23.114 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:32:23.257 +03:00 [DBG] Executing 2 update commands as a batch.
2025-06-05 21:32:23.270 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.280 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.283 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-06-05 21:32:23.294 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 21:32:23.303 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:23.304 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:23.308 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-06-05 21:32:23.313 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p1;
2025-06-05 21:32:23.409 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [users]
OUTPUT 1
WHERE [id] = @p1;
2025-06-05 21:32:23.425 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.428 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 16ms reading results.
2025-06-05 21:32:23.434 +03:00 [DBG] Committing transaction.
2025-06-05 21:32:23.462 +03:00 [DBG] Committed transaction.
2025-06-05 21:32:23.466 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.468 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 21:32:23.472 +03:00 [DBG] Disposing transaction.
2025-06-05 21:32:23.482 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.484 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.488 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-06-05 21:32:23.494 +03:00 [DBG] Compiling query expression: 
'DbSet<Category>()'
2025-06-05 21:32:23.507 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Category>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Category entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Category instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Category);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Category)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                        {
                            return 
                            {
                                Category instance;
                                instance = new Category();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<ColorForBackground>k__BackingField = dataReader.GetString(1);
                                instance.<Icon>k__BackingField = dataReader.GetString(2);
                                instance.<IsIncome>k__BackingField = dataReader.GetBoolean(3);
                                instance.<Name>k__BackingField = dataReader.GetString(4);
                                instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Category)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 21:32:23.512 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.513 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.515 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:23.516 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:23.518 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:23.519 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 21:32:23.524 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 21:32:23.557 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.571 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.574 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.576 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.578 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.580 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.582 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.583 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.586 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.587 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.590 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.591 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 64ms reading results.
2025-06-05 21:32:23.593 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.594 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:23.596 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:32:23.597 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:32:23.606 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:32:23.610 +03:00 [DBG] Executing 5 update commands as a batch.
2025-06-05 21:32:23.611 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.613 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.614 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-06-05 21:32:23.616 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 21:32:23.617 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:23.618 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:23.620 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:23.621 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p1;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p2;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p3;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p4;
2025-06-05 21:32:23.637 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p0;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p1;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p2;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p3;
DELETE FROM [categories]
OUTPUT 1
WHERE [id] = @p4;
2025-06-05 21:32:23.639 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.641 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-06-05 21:32:23.643 +03:00 [DBG] Committing transaction.
2025-06-05 21:32:23.677 +03:00 [DBG] Committed transaction.
2025-06-05 21:32:23.678 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.680 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:23.682 +03:00 [DBG] Disposing transaction.
2025-06-05 21:32:23.683 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.686 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.688 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.691 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.694 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:23.697 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 5 entities written to the database.
2025-06-05 21:32:23.699 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:23.702 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:23.705 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 21:32:23.929 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:23.946 +03:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Email == __email_0)'
2025-06-05 21:32:24.072 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.email == @__email_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.email == @__email_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Balance>k__BackingField = dataReader.GetDecimal(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(3);
                                    instance.<PrimaryCurrency>k__BackingField = dataReader.GetString(4);
                                    instance.<Role>k__BackingField = dataReader.GetString(5);
                                    instance.<Salt>k__BackingField = dataReader.GetString(6);
                                    instance.<SecondaryCurrency1>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<SecondaryCurrency2>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 21:32:24.091 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:24.093 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 21:32:24.094 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.095 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.097 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:24.098 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:24.100 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 21:32:24.102 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 21:32:24.107 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 21:32:24.112 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.113 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 4ms reading results.
2025-06-05 21:32:24.115 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.117 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:24.147 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'User.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.152 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.154 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:32:24.155 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:32:24.157 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:32:24.167 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.169 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.170 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:24.171 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:24.174 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 21:32:24.176 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 50), @p1='?' (Size = 50), @p2='?' (Size = 3), @p3='?' (Size = 5), @p4='?' (Size = 30), @p5='?' (Size = 3), @p6='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id], INSERTED.[balance]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-06-05 21:32:24.208 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@p0='?' (Size = 50), @p1='?' (Size = 50), @p2='?' (Size = 3), @p3='?' (Size = 5), @p4='?' (Size = 30), @p5='?' (Size = 3), @p6='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id], INSERTED.[balance]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-06-05 21:32:24.217 +03:00 [DBG] The foreign key property 'User.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:24.223 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.225 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 14ms reading results.
2025-06-05 21:32:24.227 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.229 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:24.235 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.237 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 21:32:24.611 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'RefreshToken.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.631 +03:00 [DBG] The navigation 'RefreshToken.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.636 +03:00 [DBG] Context 'AppDbContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.639 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:32:24.641 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:32:24.650 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:32:24.658 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.660 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.663 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:24.665 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:24.667 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 21:32:24.669 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 21:32:24.700 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 21:32:24.705 +03:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:24.708 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.709 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 6ms reading results.
2025-06-05 21:32:24.711 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.713 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:24.715 +03:00 [DBG] An entity of type 'RefreshToken' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.717 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 21:32:24.720 +03:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Id == __authData_UserDTO_Id_0)'
2025-06-05 21:32:24.727 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.id == @__authData_UserDTO_Id_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.id == @__authData_UserDTO_Id_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Balance>k__BackingField = dataReader.GetDecimal(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(3);
                                    instance.<PrimaryCurrency>k__BackingField = dataReader.GetString(4);
                                    instance.<Role>k__BackingField = dataReader.GetString(5);
                                    instance.<Salt>k__BackingField = dataReader.GetString(6);
                                    instance.<SecondaryCurrency1>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<SecondaryCurrency2>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 21:32:24.732 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.733 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.735 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:24.736 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:24.738 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:24.739 +03:00 [DBG] Executing DbCommand [Parameters=[@__authData_UserDTO_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__authData_UserDTO_Id_0
2025-06-05 21:32:24.743 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__authData_UserDTO_Id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__authData_UserDTO_Id_0
2025-06-05 21:32:24.746 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.747 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-06-05 21:32:24.749 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.750 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:24.756 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.759 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.761 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.764 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.765 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.767 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.769 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.770 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.772 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Category.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.776 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.777 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:32:24.779 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:32:24.781 +03:00 [DBG] The unchanged property 'User.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:24.782 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.785 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:32:24.795 +03:00 [DBG] Executing 6 update commands as a batch.
2025-06-05 21:32:24.796 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.798 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.800 +03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-06-05 21:32:24.804 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 21:32:24.805 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:24.808 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:24.811 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-06-05 21:32:24.812 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Size = 7), @p1='?' (Size = 100), @p2='?' (DbType = Boolean), @p3='?' (Size = 50), @p4='?' (DbType = Int32), @p5='?' (Size = 7), @p6='?' (Size = 100), @p7='?' (DbType = Boolean), @p8='?' (Size = 50), @p9='?' (DbType = Int32), @p10='?' (Size = 7), @p11='?' (Size = 100), @p12='?' (DbType = Boolean), @p13='?' (Size = 50), @p14='?' (DbType = Int32), @p15='?' (Size = 7), @p16='?' (Size = 100), @p17='?' (DbType = Boolean), @p18='?' (Size = 50), @p19='?' (DbType = Int32), @p20='?' (Size = 7), @p21='?' (Size = 100), @p22='?' (DbType = Boolean), @p23='?' (Size = 50), @p24='?' (DbType = Int32), @p26='?' (DbType = Int32), @p25='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [categories] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, 0),
(@p5, @p6, @p7, @p8, @p9, 1),
(@p10, @p11, @p12, @p13, @p14, 2),
(@p15, @p16, @p17, @p18, @p19, 3),
(@p20, @p21, @p22, @p23, @p24, 4)) AS i ([background_color], [icon_path], [is_income], [name], [parent_category_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([background_color], [icon_path], [is_income], [name], [parent_category_fk])
VALUES (i.[background_color], i.[icon_path], i.[is_income], i.[name], i.[parent_category_fk])
OUTPUT INSERTED.[id], i._Position;
UPDATE [users] SET [balance] = @p25
OUTPUT 1
WHERE [id] = @p26;
2025-06-05 21:32:24.827 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (Size = 7), @p1='?' (Size = 100), @p2='?' (DbType = Boolean), @p3='?' (Size = 50), @p4='?' (DbType = Int32), @p5='?' (Size = 7), @p6='?' (Size = 100), @p7='?' (DbType = Boolean), @p8='?' (Size = 50), @p9='?' (DbType = Int32), @p10='?' (Size = 7), @p11='?' (Size = 100), @p12='?' (DbType = Boolean), @p13='?' (Size = 50), @p14='?' (DbType = Int32), @p15='?' (Size = 7), @p16='?' (Size = 100), @p17='?' (DbType = Boolean), @p18='?' (Size = 50), @p19='?' (DbType = Int32), @p20='?' (Size = 7), @p21='?' (Size = 100), @p22='?' (DbType = Boolean), @p23='?' (Size = 50), @p24='?' (DbType = Int32), @p26='?' (DbType = Int32), @p25='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [categories] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, 0),
(@p5, @p6, @p7, @p8, @p9, 1),
(@p10, @p11, @p12, @p13, @p14, 2),
(@p15, @p16, @p17, @p18, @p19, 3),
(@p20, @p21, @p22, @p23, @p24, 4)) AS i ([background_color], [icon_path], [is_income], [name], [parent_category_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([background_color], [icon_path], [is_income], [name], [parent_category_fk])
VALUES (i.[background_color], i.[icon_path], i.[is_income], i.[name], i.[parent_category_fk])
OUTPUT INSERTED.[id], i._Position;
UPDATE [users] SET [balance] = @p25
OUTPUT 1
WHERE [id] = @p26;
2025-06-05 21:32:24.832 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:24.835 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:24.837 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:24.840 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:24.843 +03:00 [DBG] The foreign key property 'Category.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:24.845 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.846 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 15ms reading results.
2025-06-05 21:32:24.848 +03:00 [DBG] Committing transaction.
2025-06-05 21:32:24.874 +03:00 [DBG] Committed transaction.
2025-06-05 21:32:24.875 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:24.877 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:24.879 +03:00 [DBG] Disposing transaction.
2025-06-05 21:32:24.880 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.882 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.885 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.887 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.889 +03:00 [DBG] An entity of type 'Category' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.893 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.895 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 6 entities written to the database.
2025-06-05 21:32:24.903 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.930 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.932 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.934 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.936 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.937 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.939 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.941 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.942 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.944 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.946 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.947 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.949 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.951 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.952 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.954 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.956 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.958 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.960 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.962 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.963 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.965 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.967 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.968 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.970 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.972 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.974 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.976 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.978 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.980 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.981 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.983 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.985 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.987 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.988 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.990 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.992 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.994 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.995 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.997 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:24.999 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:32:25.000 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:32:25.005 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:32:25.008 +03:00 [DBG] Executing 20 update commands as a batch.
2025-06-05 21:32:25.010 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.012 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.013 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:25.014 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:25.016 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:25.018 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (Size = 50), @p4='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 50), @p10='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (DbType = DateTime2), @p20='?' (DbType = Int32), @p21='?' (Size = 50), @p22='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32), @p25='?' (DbType = DateTime2), @p26='?' (DbType = Int32), @p27='?' (Size = 50), @p28='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p29='?' (DbType = Int32), @p30='?' (DbType = Int32), @p31='?' (DbType = DateTime2), @p32='?' (DbType = Int32), @p33='?' (Size = 50), @p34='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p35='?' (DbType = Int32), @p36='?' (DbType = Int32), @p37='?' (DbType = DateTime2), @p38='?' (DbType = Int32), @p39='?' (Size = 50), @p40='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p41='?' (DbType = Int32), @p42='?' (DbType = Int32), @p43='?' (DbType = DateTime2), @p44='?' (DbType = Int32), @p45='?' (Size = 50), @p46='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p47='?' (DbType = Int32), @p48='?' (DbType = Int32), @p49='?' (DbType = DateTime2), @p50='?' (DbType = Int32), @p51='?' (Size = 50), @p52='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p53='?' (DbType = Int32), @p54='?' (DbType = Int32), @p55='?' (DbType = DateTime2), @p56='?' (DbType = Int32), @p57='?' (Size = 50), @p58='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p59='?' (DbType = Int32), @p60='?' (DbType = Int32), @p61='?' (DbType = DateTime2), @p62='?' (DbType = Int32), @p63='?' (Size = 50), @p64='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p65='?' (DbType = Int32), @p66='?' (DbType = Int32), @p67='?' (DbType = DateTime2), @p68='?' (DbType = Int32), @p69='?' (Size = 50), @p70='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p71='?' (DbType = Int32), @p72='?' (DbType = Int32), @p73='?' (DbType = DateTime2), @p74='?' (DbType = Int32), @p75='?' (Size = 50), @p76='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p77='?' (DbType = Int32), @p78='?' (DbType = Int32), @p79='?' (DbType = DateTime2), @p80='?' (DbType = Int32), @p81='?' (Size = 50), @p82='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p83='?' (DbType = Int32), @p84='?' (DbType = Int32), @p85='?' (DbType = DateTime2), @p86='?' (DbType = Int32), @p87='?' (Size = 50), @p88='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p89='?' (DbType = Int32), @p90='?' (DbType = Int32), @p91='?' (DbType = DateTime2), @p92='?' (DbType = Int32), @p93='?' (Size = 50), @p94='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p95='?' (DbType = Int32), @p96='?' (DbType = Int32), @p97='?' (DbType = DateTime2), @p98='?' (DbType = Int32), @p99='?' (Size = 50), @p100='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p101='?' (DbType = Int32), @p102='?' (DbType = Int32), @p103='?' (DbType = DateTime2), @p104='?' (DbType = Int32), @p105='?' (Size = 50), @p106='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p107='?' (DbType = Int32), @p108='?' (DbType = Int32), @p109='?' (DbType = DateTime2), @p110='?' (DbType = Int32), @p111='?' (Size = 50), @p112='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p113='?' (DbType = Int32), @p114='?' (DbType = Int32), @p115='?' (DbType = DateTime2), @p116='?' (DbType = Int32), @p117='?' (Size = 50), @p118='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p119='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [transactions] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, 0),
(@p6, @p7, @p8, @p9, @p10, @p11, 1),
(@p12, @p13, @p14, @p15, @p16, @p17, 2),
(@p18, @p19, @p20, @p21, @p22, @p23, 3),
(@p24, @p25, @p26, @p27, @p28, @p29, 4),
(@p30, @p31, @p32, @p33, @p34, @p35, 5),
(@p36, @p37, @p38, @p39, @p40, @p41, 6),
(@p42, @p43, @p44, @p45, @p46, @p47, 7),
(@p48, @p49, @p50, @p51, @p52, @p53, 8),
(@p54, @p55, @p56, @p57, @p58, @p59, 9),
(@p60, @p61, @p62, @p63, @p64, @p65, 10),
(@p66, @p67, @p68, @p69, @p70, @p71, 11),
(@p72, @p73, @p74, @p75, @p76, @p77, 12),
(@p78, @p79, @p80, @p81, @p82, @p83, 13),
(@p84, @p85, @p86, @p87, @p88, @p89, 14),
(@p90, @p91, @p92, @p93, @p94, @p95, 15),
(@p96, @p97, @p98, @p99, @p100, @p101, 16),
(@p102, @p103, @p104, @p105, @p106, @p107, 17),
(@p108, @p109, @p110, @p111, @p112, @p113, 18),
(@p114, @p115, @p116, @p117, @p118, @p119, 19)) AS i ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk])
VALUES (i.[category_fk], i.[date], i.[inner_category_fk], i.[name], i.[price], i.[user_fk])
OUTPUT INSERTED.[id], i._Position;
2025-06-05 21:32:25.062 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (Size = 50), @p4='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = Int32), @p9='?' (Size = 50), @p10='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime2), @p14='?' (DbType = Int32), @p15='?' (Size = 50), @p16='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p17='?' (DbType = Int32), @p18='?' (DbType = Int32), @p19='?' (DbType = DateTime2), @p20='?' (DbType = Int32), @p21='?' (Size = 50), @p22='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p23='?' (DbType = Int32), @p24='?' (DbType = Int32), @p25='?' (DbType = DateTime2), @p26='?' (DbType = Int32), @p27='?' (Size = 50), @p28='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p29='?' (DbType = Int32), @p30='?' (DbType = Int32), @p31='?' (DbType = DateTime2), @p32='?' (DbType = Int32), @p33='?' (Size = 50), @p34='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p35='?' (DbType = Int32), @p36='?' (DbType = Int32), @p37='?' (DbType = DateTime2), @p38='?' (DbType = Int32), @p39='?' (Size = 50), @p40='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p41='?' (DbType = Int32), @p42='?' (DbType = Int32), @p43='?' (DbType = DateTime2), @p44='?' (DbType = Int32), @p45='?' (Size = 50), @p46='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p47='?' (DbType = Int32), @p48='?' (DbType = Int32), @p49='?' (DbType = DateTime2), @p50='?' (DbType = Int32), @p51='?' (Size = 50), @p52='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p53='?' (DbType = Int32), @p54='?' (DbType = Int32), @p55='?' (DbType = DateTime2), @p56='?' (DbType = Int32), @p57='?' (Size = 50), @p58='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p59='?' (DbType = Int32), @p60='?' (DbType = Int32), @p61='?' (DbType = DateTime2), @p62='?' (DbType = Int32), @p63='?' (Size = 50), @p64='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p65='?' (DbType = Int32), @p66='?' (DbType = Int32), @p67='?' (DbType = DateTime2), @p68='?' (DbType = Int32), @p69='?' (Size = 50), @p70='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p71='?' (DbType = Int32), @p72='?' (DbType = Int32), @p73='?' (DbType = DateTime2), @p74='?' (DbType = Int32), @p75='?' (Size = 50), @p76='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p77='?' (DbType = Int32), @p78='?' (DbType = Int32), @p79='?' (DbType = DateTime2), @p80='?' (DbType = Int32), @p81='?' (Size = 50), @p82='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p83='?' (DbType = Int32), @p84='?' (DbType = Int32), @p85='?' (DbType = DateTime2), @p86='?' (DbType = Int32), @p87='?' (Size = 50), @p88='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p89='?' (DbType = Int32), @p90='?' (DbType = Int32), @p91='?' (DbType = DateTime2), @p92='?' (DbType = Int32), @p93='?' (Size = 50), @p94='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p95='?' (DbType = Int32), @p96='?' (DbType = Int32), @p97='?' (DbType = DateTime2), @p98='?' (DbType = Int32), @p99='?' (Size = 50), @p100='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p101='?' (DbType = Int32), @p102='?' (DbType = Int32), @p103='?' (DbType = DateTime2), @p104='?' (DbType = Int32), @p105='?' (Size = 50), @p106='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p107='?' (DbType = Int32), @p108='?' (DbType = Int32), @p109='?' (DbType = DateTime2), @p110='?' (DbType = Int32), @p111='?' (Size = 50), @p112='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p113='?' (DbType = Int32), @p114='?' (DbType = Int32), @p115='?' (DbType = DateTime2), @p116='?' (DbType = Int32), @p117='?' (Size = 50), @p118='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p119='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [transactions] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, 0),
(@p6, @p7, @p8, @p9, @p10, @p11, 1),
(@p12, @p13, @p14, @p15, @p16, @p17, 2),
(@p18, @p19, @p20, @p21, @p22, @p23, 3),
(@p24, @p25, @p26, @p27, @p28, @p29, 4),
(@p30, @p31, @p32, @p33, @p34, @p35, 5),
(@p36, @p37, @p38, @p39, @p40, @p41, 6),
(@p42, @p43, @p44, @p45, @p46, @p47, 7),
(@p48, @p49, @p50, @p51, @p52, @p53, 8),
(@p54, @p55, @p56, @p57, @p58, @p59, 9),
(@p60, @p61, @p62, @p63, @p64, @p65, 10),
(@p66, @p67, @p68, @p69, @p70, @p71, 11),
(@p72, @p73, @p74, @p75, @p76, @p77, 12),
(@p78, @p79, @p80, @p81, @p82, @p83, 13),
(@p84, @p85, @p86, @p87, @p88, @p89, 14),
(@p90, @p91, @p92, @p93, @p94, @p95, 15),
(@p96, @p97, @p98, @p99, @p100, @p101, 16),
(@p102, @p103, @p104, @p105, @p106, @p107, 17),
(@p108, @p109, @p110, @p111, @p112, @p113, 18),
(@p114, @p115, @p116, @p117, @p118, @p119, 19)) AS i ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk])
VALUES (i.[category_fk], i.[date], i.[inner_category_fk], i.[name], i.[price], i.[user_fk])
OUTPUT INSERTED.[id], i._Position;
2025-06-05 21:32:25.072 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.078 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.080 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.082 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.084 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.085 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.087 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.091 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.093 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.095 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.097 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.098 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.100 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.102 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.104 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.106 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.109 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.111 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.114 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.116 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.117 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.119 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 49ms reading results.
2025-06-05 21:32:25.122 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.125 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (3ms).
2025-06-05 21:32:25.128 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.130 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.132 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.135 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.138 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.141 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.144 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.147 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.149 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.152 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.155 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.159 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.162 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.165 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.167 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.170 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.172 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.176 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.179 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.181 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.183 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 20 entities written to the database.
2025-06-05 21:32:25.187 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.202 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.204 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.206 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.208 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.210 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.211 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Saving.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.213 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.215 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:32:25.216 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:32:25.221 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:32:25.223 +03:00 [DBG] Executing 4 update commands as a batch.
2025-06-05 21:32:25.225 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.227 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.228 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:25.229 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:25.231 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:25.232 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (DbType = Int32), @p3='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 50), @p5='?' (DbType = Int32), @p6='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p10='?' (Size = 50), @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [savings] USING (
VALUES (@p0, @p1, @p2, 0),
(@p3, @p4, @p5, 1),
(@p6, @p7, @p8, 2),
(@p9, @p10, @p11, 3)) AS i ([goal], [name], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([goal], [name], [user_fk])
VALUES (i.[goal], i.[name], i.[user_fk])
OUTPUT INSERTED.[id], INSERTED.[current_amount], i._Position;
2025-06-05 21:32:25.241 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (DbType = Int32), @p3='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 50), @p5='?' (DbType = Int32), @p6='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p10='?' (Size = 50), @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [savings] USING (
VALUES (@p0, @p1, @p2, 0),
(@p3, @p4, @p5, 1),
(@p6, @p7, @p8, 2),
(@p9, @p10, @p11, 3)) AS i ([goal], [name], [user_fk], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([goal], [name], [user_fk])
VALUES (i.[goal], i.[name], i.[user_fk])
OUTPUT INSERTED.[id], INSERTED.[current_amount], i._Position;
2025-06-05 21:32:25.245 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.247 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.249 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.250 +03:00 [DBG] The foreign key property 'Saving.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.252 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.253 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 10ms reading results.
2025-06-05 21:32:25.255 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.257 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 21:32:25.260 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.262 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.265 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.267 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.269 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 4 entities written to the database.
2025-06-05 21:32:25.271 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:25.272 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.274 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 21:32:25.294 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:25.319 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:25.320 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 21:32:25.321 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.323 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.325 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:25.327 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:25.328 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:25.330 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 21:32:25.335 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 21:32:25.338 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.339 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-06-05 21:32:25.343 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.345 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:25.360 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'User.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.362 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.364 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:32:25.366 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:32:25.367 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:32:25.369 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.371 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.379 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:25.380 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:25.381 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:25.383 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (Precision = 12) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (Size = 50), @p3='?' (Size = 3), @p4='?' (Size = 5), @p5='?' (Size = 30), @p6='?' (Size = 3), @p7='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([balance], [email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-06-05 21:32:25.388 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 12) (Scale = 2) (DbType = Decimal), @p1='?' (Size = 50), @p2='?' (Size = 50), @p3='?' (Size = 3), @p4='?' (Size = 5), @p5='?' (Size = 30), @p6='?' (Size = 3), @p7='?' (Size = 3)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [users] ([balance], [email], [password_hash], [primary_currency], [role], [salt], [secondary_currency_1], [secondary_currency_2])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-06-05 21:32:25.392 +03:00 [DBG] The foreign key property 'User.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:25.394 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.395 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 21:32:25.397 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.399 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:25.400 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:25.403 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 21:32:25.405 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:25.406 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.409 +03:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-06-05 21:32:25.692 +03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-06-05 21:32:25.747 +03:00 [DBG] Hosting starting
2025-06-05 21:32:25.816 +03:00 [INF] User profile is available. Using 'C:\Users\ebtyx\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-06-05 21:32:25.848 +03:00 [DBG] Reading data from file 'C:\Users\ebtyx\AppData\Local\ASP.NET\DataProtection-Keys\key-036e1e5f-5347-47d7-8236-0b64ed0a76a1.xml'.
2025-06-05 21:32:25.851 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:25.859 +03:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.ExpiresAt < DateTime.UtcNow)'
2025-06-05 21:32:25.860 +03:00 [DBG] Found key {036e1e5f-5347-47d7-8236-0b64ed0a76a1}.
2025-06-05 21:32:25.872 +03:00 [DBG] Considering key {036e1e5f-5347-47d7-8236-0b64ed0a76a1} with expiration date 2025-07-16 20:11:06Z as default key.
2025-06-05 21:32:25.875 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<RefreshToken>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
        SELECT r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
        FROM refresh_tokens AS r
        WHERE r.expires_at < GETUTCDATE()) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
        SELECT r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
        FROM refresh_tokens AS r
        WHERE r.expires_at < GETUTCDATE(), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        RefreshToken entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            RefreshToken instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(RefreshToken);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: RefreshToken.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (RefreshToken)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]: 
                        {
                            return 
                            {
                                RefreshToken instance;
                                instance = new RefreshToken();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                instance.<ExpiresAt>k__BackingField = dataReader.GetDateTime(2);
                                instance.<IsRevoked>k__BackingField = dataReader.GetBoolean(3);
                                instance.<Token>k__BackingField = dataReader.GetString(4);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(5);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(RefreshToken)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 21:32:25.879 +03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-06-05 21:32:25.881 +03:00 [DBG] Decrypting secret element using Windows DPAPI.
2025-06-05 21:32:25.884 +03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-06-05 21:32:25.884 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:25.887 +03:00 [DBG] Created DbConnection. (2ms).
2025-06-05 21:32:25.888 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.889 +03:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2025-06-05 21:32:25.889 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.893 +03:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2025-06-05 21:32:25.894 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:25.897 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:25.897 +03:00 [DBG] Using key {036e1e5f-5347-47d7-8236-0b64ed0a76a1} as the default key.
2025-06-05 21:32:25.899 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-06-05 21:32:25.900 +03:00 [DBG] Key ring with default key {036e1e5f-5347-47d7-8236-0b64ed0a76a1} was loaded during application startup.
2025-06-05 21:32:25.901 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[expires_at] < GETUTCDATE()
2025-06-05 21:32:25.911 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[expires_at] < GETUTCDATE()
2025-06-05 21:32:25.922 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.931 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 10ms reading results.
2025-06-05 21:32:25.934 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.936 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 21:32:25.940 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:25.944 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:25.945 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:32:26.229 +03:00 [INF] Now listening on: https://localhost:49464
2025-06-05 21:32:26.233 +03:00 [INF] Now listening on: http://localhost:49465
2025-06-05 21:32:26.235 +03:00 [DBG] Loaded hosting startup assembly Finance_Manager_Backend
2025-06-05 21:32:26.236 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-06-05 21:32:26.237 +03:00 [INF] Hosting environment: Development
2025-06-05 21:32:26.238 +03:00 [INF] Content root path: G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend
2025-06-05 21:32:26.239 +03:00 [DBG] Hosting started
2025-06-05 21:32:34.986 +03:00 [DBG] Connection id "0HND4BTBKLUB1" accepted.
2025-06-05 21:32:35.019 +03:00 [DBG] Connection id "0HND4BTBKLUB1" started.
2025-06-05 21:32:35.104 +03:00 [DBG] Connection 0HND4BTBKLUB1 established using the following protocol: "Tls12"
2025-06-05 21:32:35.711 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - application/json-patch+json 90
2025-06-05 21:32:35.715 +03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-06-05 21:32:35.790 +03:00 [DBG] POST requests are not supported
2025-06-05 21:32:35.812 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/refresh-token'
2025-06-05 21:32:35.816 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)' with route pattern 'api/Auth/refresh-token' is valid for the request path '/api/Auth/refresh-token'
2025-06-05 21:32:35.822 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-06-05 21:32:35.904 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-06-05 21:32:35.911 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-06-05 21:32:35.943 +03:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] RefreshToken(System.String) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-06-05 21:32:35.951 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:32:35.954 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:32:35.958 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:32:35.961 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:32:35.966 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:32:35.971 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 21:32:35.976 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 21:32:36.028 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' ...
2025-06-05 21:32:36.045 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' using the name '' in request data ...
2025-06-05 21:32:36.048 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:32:36.054 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:32:36.069 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:00000001": started reading request body.
2025-06-05 21:32:36.072 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:00000001": done reading request body.
2025-06-05 21:32:36.192 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-06-05 21:32:36.208 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-06-05 21:32:36.261 +03:00 [DBG] Attempting to validate the bound parameter 'refreshToken' of type 'System.String' ...
2025-06-05 21:32:36.282 +03:00 [DBG] Done attempting to validate the bound parameter 'refreshToken' of type 'System.String'.
2025-06-05 21:32:36.298 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:36.306 +03:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(rt => rt.Token == __refreshToken_0)'
2025-06-05 21:32:36.321 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<RefreshToken>(
    asyncEnumerable: SingleQueryingEnumerable.Create<RefreshToken>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
            SELECT TOP(1) r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
            FROM refresh_tokens AS r
            WHERE r.token == @__refreshToken_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
            SELECT TOP(1) r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
            FROM refresh_tokens AS r
            WHERE r.token == @__refreshToken_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            RefreshToken entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                RefreshToken instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(RefreshToken);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: RefreshToken.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (RefreshToken)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]: 
                            {
                                return 
                                {
                                    RefreshToken instance;
                                    instance = new RefreshToken();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<ExpiresAt>k__BackingField = dataReader.GetDateTime(2);
                                    instance.<IsRevoked>k__BackingField = dataReader.GetBoolean(3);
                                    instance.<Token>k__BackingField = dataReader.GetString(4);
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(5);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(RefreshToken)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 21:32:36.327 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:36.328 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 21:32:36.330 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:36.336 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:36.339 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:36.341 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:36.343 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-06-05 21:32:36.345 +03:00 [DBG] Executing DbCommand [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-06-05 21:32:36.359 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-06-05 21:32:36.377 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:36.381 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 5ms reading results.
2025-06-05 21:32:36.389 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:36.395 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (6ms).
2025-06-05 21:32:36.429 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend) in 456.8944ms
2025-06-05 21:32:36.432 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-06-05 21:32:36.455 +03:00 [ERR] Invalid refresh token
System.InvalidOperationException: Invalid refresh token
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserWithRefreshTokenAsync(String refreshToken) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 89
   at Finance_Manager_Backend.Controllers.AuthController.RefreshToken(String refreshToken) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 86
   at lambda_method475(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\ ++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-06-05 21:32:36.769 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:32:36.777 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:36.781 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:36.782 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:32:36.788 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - 400 null application/json 1079.169ms
2025-06-05 21:32:48.448 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - application/json-patch+json 63
2025-06-05 21:32:48.458 +03:00 [DBG] POST requests are not supported
2025-06-05 21:32:48.464 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/authenticate'
2025-06-05 21:32:48.466 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)' with route pattern 'api/Auth/authenticate' is valid for the request path '/api/Auth/authenticate'
2025-06-05 21:32:48.469 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-06-05 21:32:48.474 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-06-05 21:32:48.479 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-06-05 21:32:48.487 +03:00 [INF] Route matched with {action = "Authenticate", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] Authenticate(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-06-05 21:32:48.489 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:32:48.491 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:32:48.493 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:32:48.495 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:32:48.497 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:32:48.498 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 21:32:48.500 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-06-05 21:32:48.502 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-06-05 21:32:48.504 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' using the name '' in request data ...
2025-06-05 21:32:48.505 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:32:48.507 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:32:48.509 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:00000002": started reading request body.
2025-06-05 21:32:48.511 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:00000002": done reading request body.
2025-06-05 21:32:48.566 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-06-05 21:32:48.567 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-06-05 21:32:48.569 +03:00 [DBG] Attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-06-05 21:32:48.573 +03:00 [DBG] Done attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-06-05 21:32:48.648 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:48.652 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:48.654 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 21:32:48.655 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:48.656 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:48.657 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:48.659 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:48.661 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 21:32:48.663 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 21:32:48.674 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-06-05 21:32:48.679 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:48.682 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:48.685 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 5ms reading results.
2025-06-05 21:32:48.687 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:48.689 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 21:32:48.710 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'RefreshToken.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:48.715 +03:00 [DBG] The navigation 'RefreshToken.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:48.718 +03:00 [DBG] Context 'AppDbContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:48.720 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:32:48.722 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:32:48.725 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:32:48.730 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:48.734 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:48.747 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:48.749 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:48.754 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2025-06-05 21:32:48.756 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 21:32:48.785 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-06-05 21:32:48.787 +03:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:32:48.789 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:48.790 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 21:32:48.792 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:48.793 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:48.795 +03:00 [DBG] An entity of type 'RefreshToken' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:48.797 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-06-05 21:32:48.800 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:32:48.805 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:32:48.807 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:32:48.808 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:32:48.809 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:32:48.811 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:32:48.813 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO'.
2025-06-05 21:32:48.838 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend) in 339.4591ms
2025-06-05 21:32:48.839 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-06-05 21:32:48.840 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:32:48.841 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:48.844 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:48.845 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:32:48.847 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - 200 524 application/json; charset=utf-8 398.4995ms
2025-06-05 21:32:49.605 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1157 - null null
2025-06-05 21:32:49.632 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:32:49.633 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1157'
2025-06-05 21:32:49.634 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1157'
2025-06-05 21:32:49.636 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:32:49.826 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:32:49.829 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:32:49.832 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:32:49.838 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 21:32:49.840 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:32:49.841 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:32:49.845 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:32:49.848 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:32:49.850 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:32:49.852 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:32:49.861 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:32:49.864 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 21:32:49.867 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 21:32:49.869 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:32:49.871 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:32:49.872 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 21:32:49.874 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 21:32:49.904 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:49.907 +03:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(u => u.Id == __userId_0)'
2025-06-05 21:32:49.914 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<User>(
    asyncEnumerable: SingleQueryingEnumerable.Create<User>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.id == @__userId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.Balance (decimal) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(50), 2], [Property: User.PasswordHash (string) Required MaxLength(50), 3], [Property: User.PrimaryCurrency (string) Required ValueGenerated.OnAdd MaxLength(3), 4], [Property: User.Role (string) Required ValueGenerated.OnAdd MaxLength(5), 5], [Property: User.Salt (string) Required MaxLength(30), 6], [Property: User.SecondaryCurrency1 (string) MaxLength(3), 7], [Property: User.SecondaryCurrency2 (string) MaxLength(3), 8] }
            SELECT TOP(1) u.id, u.balance, u.email, u.password_hash, u.primary_currency, u.role, u.salt, u.secondary_currency_1, u.secondary_currency_2
            FROM users AS u
            WHERE u.id == @__userId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            User entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                User instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(User);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: User.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (User)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]: 
                            {
                                return 
                                {
                                    User instance;
                                    instance = new User();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Balance>k__BackingField = dataReader.GetDecimal(1);
                                    instance.<Email>k__BackingField = dataReader.GetString(2);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(3);
                                    instance.<PrimaryCurrency>k__BackingField = dataReader.GetString(4);
                                    instance.<Role>k__BackingField = dataReader.GetString(5);
                                    instance.<Salt>k__BackingField = dataReader.GetString(6);
                                    instance.<SecondaryCurrency1>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<SecondaryCurrency2>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: User | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.User")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(User)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 21:32:49.918 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:49.919 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 21:32:49.920 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:49.922 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:49.924 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:49.925 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:49.926 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:49.928 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:32:49.967 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:32:49.969 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:49.971 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:49.973 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 21:32:49.974 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:49.976 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:49.980 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:32:49.983 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:32:49.984 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:32:49.985 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:32:49.986 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:32:49.987 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:32:49.989 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 21:32:49.994 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 142.2632ms
2025-06-05 21:32:49.996 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:32:49.997 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:32:49.998 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:49.999 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.000 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:32:50.001 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1157 - 200 105 application/json; charset=utf-8 395.8207ms
2025-06-05 21:32:50.044 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Categories - null null
2025-06-05 21:32:50.049 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:32:50.050 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Categories'
2025-06-05 21:32:50.052 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)' with route pattern 'api/Categories' is valid for the request path '/api/Categories'
2025-06-05 21:32:50.054 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)'
2025-06-05 21:32:50.056 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:32:50.058 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:32:50.059 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)'
2025-06-05 21:32:50.066 +03:00 [INF] Route matched with {action = "GetAllCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryDTO]]] GetAllCategories() on controller Finance_Manager_Backend.Controllers.CategoriesController (Finance_Manager_Backend).
2025-06-05 21:32:50.069 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:32:50.071 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:32:50.074 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:32:50.077 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:32:50.081 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:32:50.084 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.CategoriesController (Finance_Manager_Backend)
2025-06-05 21:32:50.086 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.CategoriesController (Finance_Manager_Backend)
2025-06-05 21:32:50.090 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:50.095 +03:00 [DBG] Compiling query expression: 
'DbSet<Category>()'
2025-06-05 21:32:50.102 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Category>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
        FROM categories AS c, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Category entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Category instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Category);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Category)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                        {
                            return 
                            {
                                Category instance;
                                instance = new Category();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<ColorForBackground>k__BackingField = dataReader.GetString(1);
                                instance.<Icon>k__BackingField = dataReader.GetString(2);
                                instance.<IsIncome>k__BackingField = dataReader.GetBoolean(3);
                                instance.<Name>k__BackingField = dataReader.GetString(4);
                                instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Category)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 21:32:50.108 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:50.110 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 21:32:50.118 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.121 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.123 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:50.124 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:50.128 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-06-05 21:32:50.130 +03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 21:32:50.136 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
2025-06-05 21:32:50.139 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.141 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.145 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.147 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.150 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.152 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.154 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 15ms reading results.
2025-06-05 21:32:50.156 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.158 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 21:32:50.181 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:32:50.186 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:32:50.194 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:32:50.196 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:32:50.197 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:32:50.198 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:32:50.199 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 21:32:50.209 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend) in 125.3271ms
2025-06-05 21:32:50.212 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.CategoriesController.GetAllCategories (Finance_Manager_Backend)'
2025-06-05 21:32:50.213 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:32:50.214 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:50.216 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.217 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:32:50.219 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Categories - 200 736 application/json; charset=utf-8 174.7658ms
2025-06-05 21:32:50.273 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Transactions?userId=1157&lastDate=2025-06-05T18%3A32%3A50&pageSize=10 - null null
2025-06-05 21:32:50.277 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:32:50.278 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions'
2025-06-05 21:32:50.279 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)' with route pattern 'api/Transactions' is valid for the request path '/api/Transactions'
2025-06-05 21:32:50.281 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)'
2025-06-05 21:32:50.283 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:32:50.284 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:32:50.286 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)'
2025-06-05 21:32:50.294 +03:00 [INF] Route matched with {action = "GetTransactions", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO]]] GetTransactions(Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 21:32:50.297 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:32:50.299 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:32:50.301 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:32:50.303 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:32:50.304 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:32:50.306 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 21:32:50.308 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 21:32:50.315 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO' ...
2025-06-05 21:32:50.318 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO' using the name '' in request data ...
2025-06-05 21:32:50.324 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-06-05 21:32:50.327 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.userId' of type 'System.Int32'.
2025-06-05 21:32:50.331 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.lastDate' of type 'System.Nullable`1[System.DateTime]' using the name 'lastDate' in request data ...
2025-06-05 21:32:50.334 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.lastDate' of type 'System.Nullable`1[System.DateTime]'.
2025-06-05 21:32:50.335 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-06-05 21:32:50.337 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO.pageSize' of type 'System.Int32'.
2025-06-05 21:32:50.339 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO'.
2025-06-05 21:32:50.341 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO'.
2025-06-05 21:32:50.344 +03:00 [DBG] Attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO' ...
2025-06-05 21:32:50.347 +03:00 [DBG] Done attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserTransactionsQueryDTO'.
2025-06-05 21:32:50.376 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:50.380 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:50.381 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 21:32:50.383 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.385 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.387 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:50.388 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:50.392 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-06-05 21:32:50.396 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:32:50.404 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:32:50.408 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.411 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.414 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 6ms reading results.
2025-06-05 21:32:50.417 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.418 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:50.438 +03:00 [DBG] Compiling query expression: 
'DbSet<Transaction>()
    .Where(t => t.UserId == __userId_0)
    .OrderByDescending(t => t.Date)
    .Where(t => t.Date < __lastDate_Value_1)
    .OrderByDescending(t => t.Date)
    .Take(__p_2)'
2025-06-05 21:32:50.465 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Transaction>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Transaction.CategoryId (int) Required FK Index, 1], [Property: Transaction.Date (DateTime) Required, 2], [Property: Transaction.InnerCategoryId (int?) FK Index, 3], [Property: Transaction.Name (string) Required MaxLength(50), 4], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 5], [Property: Transaction.UserId (int) Required FK Index, 6] }
        SELECT TOP(@__p_2) t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        WHERE (t.user_fk == @__userId_0) && (t.date < @__lastDate_Value_1)
        ORDER BY t.date DESC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Transaction.CategoryId (int) Required FK Index, 1], [Property: Transaction.Date (DateTime) Required, 2], [Property: Transaction.InnerCategoryId (int?) FK Index, 3], [Property: Transaction.Name (string) Required MaxLength(50), 4], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 5], [Property: Transaction.UserId (int) Required FK Index, 6] }
        SELECT TOP(@__p_2) t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        WHERE (t.user_fk == @__userId_0) && (t.date < @__lastDate_Value_1)
        ORDER BY t.date DESC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Transaction entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Transaction instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Transaction);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Transaction.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Transaction)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]: 
                        {
                            return 
                            {
                                Transaction instance;
                                instance = new Transaction();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(1);
                                instance.<Date>k__BackingField = dataReader.GetDateTime(2);
                                instance.<InnerCategoryId>k__BackingField = dataReader.IsDBNull(3) ? default(int?) : (int?)dataReader.GetInt32(3);
                                instance.<Name>k__BackingField = dataReader.GetString(4);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(5);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(6);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Transaction)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 21:32:50.471 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.473 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.474 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:50.475 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:50.477 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 21:32:50.479 +03:00 [DBG] Executing DbCommand [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__lastDate_Value_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
WHERE [t].[user_fk] = @__userId_0 AND [t].[date] < @__lastDate_Value_1
ORDER BY [t].[date] DESC
2025-06-05 21:32:50.485 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__lastDate_Value_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
WHERE [t].[user_fk] = @__userId_0 AND [t].[date] < @__lastDate_Value_1
ORDER BY [t].[date] DESC
2025-06-05 21:32:50.488 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.490 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.492 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.494 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.495 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.497 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.498 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.500 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.501 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.503 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.504 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.505 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 18ms reading results.
2025-06-05 21:32:50.506 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.507 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:50.514 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:32:50.516 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:32:50.517 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:32:50.518 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:32:50.519 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:32:50.520 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:32:50.521 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 21:32:50.525 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend) in 219.7813ms
2025-06-05 21:32:50.527 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.GetTransactions (Finance_Manager_Backend)'
2025-06-05 21:32:50.529 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:32:50.532 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:50.534 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.537 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 21:32:50.539 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Transactions?userId=1157&lastDate=2025-06-05T18%3A32%3A50&pageSize=10 - 200 1345 application/json; charset=utf-8 265.8688ms
2025-06-05 21:32:50.567 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Savings?userId=1157&previousSavingId=1&pageSize=5 - null null
2025-06-05 21:32:50.574 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:32:50.576 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 21:32:50.579 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 21:32:50.584 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)'
2025-06-05 21:32:50.586 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:32:50.587 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:32:50.589 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)'
2025-06-05 21:32:50.596 +03:00 [INF] Route matched with {action = "GetSavings", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingDTO]]] GetSavings(Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 21:32:50.599 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:32:50.602 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:32:50.605 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:32:50.609 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:32:50.614 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:32:50.616 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 21:32:50.620 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 21:32:50.623 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO' ...
2025-06-05 21:32:50.625 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO' using the name '' in request data ...
2025-06-05 21:32:50.627 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-06-05 21:32:50.630 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.userId' of type 'System.Int32'.
2025-06-05 21:32:50.632 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.previousSavingId' of type 'System.Int32' using the name 'previousSavingId' in request data ...
2025-06-05 21:32:50.634 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.previousSavingId' of type 'System.Int32'.
2025-06-05 21:32:50.635 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.pageSize' of type 'System.Int32' using the name 'pageSize' in request data ...
2025-06-05 21:32:50.637 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO.pageSize' of type 'System.Int32'.
2025-06-05 21:32:50.639 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO'.
2025-06-05 21:32:50.640 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO'.
2025-06-05 21:32:50.642 +03:00 [DBG] Attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO' ...
2025-06-05 21:32:50.644 +03:00 [DBG] Done attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.GetUserSavingsQueryDTO'.
2025-06-05 21:32:50.652 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:50.655 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:50.656 +03:00 [DBG] Created DbConnection. (1ms).
2025-06-05 21:32:50.658 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.659 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.662 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:50.663 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:50.665 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:50.666 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:32:50.671 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:32:50.673 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.675 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.676 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 21:32:50.679 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.681 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:50.686 +03:00 [DBG] Compiling query expression: 
'DbSet<Saving>()
    .Where(s => s.UserId == __userId_0 && s.Id > __previousSavingId_1)
    .Take(__p_2)'
2025-06-05 21:32:50.689 +03:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-06-05 21:32:50.697 +03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Saving>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
        SELECT TOP(@__p_2) s.id, s.current_amount, s.goal, s.name, s.user_fk
        FROM savings AS s
        WHERE (s.user_fk == @__userId_0) && (s.id > @__previousSavingId_1)) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
        SELECT TOP(@__p_2) s.id, s.current_amount, s.goal, s.name, s.user_fk
        FROM savings AS s
        WHERE (s.user_fk == @__userId_0) && (s.id > @__previousSavingId_1), 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Saving entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Saving instance1;
            InternalEntityEntry entry1;
            bool hasNullKey1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Saving);
            entry1 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Saving.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey1);
            !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
            {
                entityType1 = entry1.EntityType;
                return instance1 = (Saving)entry1.Entity;
            } : 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]: 
                        {
                            return 
                            {
                                Saving instance;
                                instance = new Saving();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<CurrentAmount>k__BackingField = dataReader.GetDecimal(1);
                                instance.<Goal>k__BackingField = dataReader.GetDecimal(2);
                                instance.<Name>k__BackingField = dataReader.GetString(3);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(4);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Saving)
                }
                ;
                entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType1, 
                    entity: instance1, 
                    snapshot: shadowSnapshot1);
                return instance1;
            } : default(void);
            return instance1;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 21:32:50.702 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.703 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.705 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:50.706 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:50.708 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:50.709 +03:00 [DBG] Executing DbCommand [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__previousSavingId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[user_fk] = @__userId_0 AND [s].[id] > @__previousSavingId_1
2025-06-05 21:32:50.717 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_2='?' (DbType = Int32), @__userId_0='?' (DbType = Int32), @__previousSavingId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_2) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[user_fk] = @__userId_0 AND [s].[id] > @__previousSavingId_1
2025-06-05 21:32:50.720 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.722 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.724 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.725 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:50.728 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.730 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 10ms reading results.
2025-06-05 21:32:50.732 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.734 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:50.739 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:32:50.742 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:32:50.744 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:32:50.747 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:32:50.748 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:32:50.750 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:32:50.752 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 21:32:50.758 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend) in 142.0747ms
2025-06-05 21:32:50.767 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.GetSavings (Finance_Manager_Backend)'
2025-06-05 21:32:50.768 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:32:50.769 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:50.770 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:50.771 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:32:50.773 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Savings?userId=1157&previousSavingId=1&pageSize=5 - 200 327 application/json; charset=utf-8 205.4155ms
2025-06-05 21:32:50.782 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/Analytics/overview?userId=1157&minDate=2025-05-29T18%3A32%3A50&maxDate=2025-06-05T18%3A32%3A50 - null null
2025-06-05 21:32:50.788 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:32:50.790 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Analytics/overview'
2025-06-05 21:32:50.793 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)' with route pattern 'api/Analytics/overview' is valid for the request path '/api/Analytics/overview'
2025-06-05 21:32:50.949 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)'
2025-06-05 21:32:50.967 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:32:50.969 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:32:50.974 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)'
2025-06-05 21:32:51.366 +03:00 [INF] Route matched with {action = "GetAnalytics", controller = "Analytics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryPercentDTO]]] GetAnalytics(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO) on controller Finance_Manager_Backend.Controllers.AnalyticsController (Finance_Manager_Backend).
2025-06-05 21:32:51.387 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:32:51.392 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:32:51.424 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:32:51.458 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:32:51.467 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:32:51.478 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AnalyticsController (Finance_Manager_Backend)
2025-06-05 21:32:51.484 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AnalyticsController (Finance_Manager_Backend)
2025-06-05 21:32:51.494 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO' ...
2025-06-05 21:32:51.504 +03:00 [DBG] Attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO' using the name '' in request data ...
2025-06-05 21:32:51.506 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.userId' of type 'System.Int32' using the name 'userId' in request data ...
2025-06-05 21:32:51.519 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.userId' of type 'System.Int32'.
2025-06-05 21:32:51.533 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.minDate' of type 'System.DateTime' using the name 'minDate' in request data ...
2025-06-05 21:32:51.536 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.minDate' of type 'System.DateTime'.
2025-06-05 21:32:51.538 +03:00 [DBG] Attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.maxDate' of type 'System.DateTime' using the name 'maxDate' in request data ...
2025-06-05 21:32:51.540 +03:00 [DBG] Done attempting to bind property 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO.maxDate' of type 'System.DateTime'.
2025-06-05 21:32:51.541 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO'.
2025-06-05 21:32:51.542 +03:00 [DBG] Done attempting to bind parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO'.
2025-06-05 21:32:51.544 +03:00 [DBG] Attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO' ...
2025-06-05 21:32:51.547 +03:00 [DBG] Done attempting to validate the bound parameter 'queryDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AnalyticsQueryDTO'.
2025-06-05 21:32:51.561 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:51.582 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:51.588 +03:00 [DBG] Created DbConnection. (5ms).
2025-06-05 21:32:51.594 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:51.644 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:51.648 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:51.650 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:51.651 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 21:32:51.654 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:32:51.660 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:32:51.665 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:51.668 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:51.670 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 4ms reading results.
2025-06-05 21:32:51.674 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:51.676 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 21:32:51.689 +03:00 [DBG] Compiling query expression: 
'DbSet<Transaction>()
    .Where(s => s.UserId == __userId_0 && !(s.Category.IsIncome) && s.Date > __minDate_1 && s.Date < __maxDate_2)
    .GroupBy(s => s.Category)'
2025-06-05 21:32:51.870 +03:00 [DBG] Generated query execution expression: 
'queryContext => GroupBySingleQueryingEnumerable.Create<Category, Transaction>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
            1 -> 0
            2 -> 1
            3 -> 2
            4 -> 3
            5 -> 4
            6 -> 5
            7 -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Transaction.CategoryId (int) Required FK Index, 7], [Property: Transaction.Date (DateTime) Required, 8], [Property: Transaction.InnerCategoryId (int?) FK Index, 9], [Property: Transaction.Name (string) Required MaxLength(50), 10], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 11], [Property: Transaction.UserId (int) Required FK Index, 12] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk, t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        INNER JOIN categories AS c ON t.category_fk == c.id
        WHERE (((t.user_fk == @__userId_0) && Not(c.is_income)) && (t.date > @__minDate_1)) && (t.date < @__maxDate_2)
        ORDER BY c.id ASC, c.background_color ASC, c.icon_path ASC, c.is_income ASC, c.name ASC, c.parent_category_fk ASC) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
            1 -> 0
            2 -> 1
            3 -> 2
            4 -> 3
            5 -> 4
            6 -> 5
            7 -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 6], [Property: Transaction.CategoryId (int) Required FK Index, 7], [Property: Transaction.Date (DateTime) Required, 8], [Property: Transaction.InnerCategoryId (int?) FK Index, 9], [Property: Transaction.Name (string) Required MaxLength(50), 10], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 11], [Property: Transaction.UserId (int) Required FK Index, 12] }
        SELECT c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk, t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk
        FROM transactions AS t
        INNER JOIN categories AS c ON t.category_fk == c.id
        WHERE (((t.user_fk == @__userId_0) && Not(c.is_income)) && (t.date > @__minDate_1)) && (t.date < @__maxDate_2)
        ORDER BY c.id ASC, c.background_color ASC, c.icon_path ASC, c.is_income ASC, c.name ASC, c.parent_category_fk ASC, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    keySelector: (queryContext, dataReader) => 
    {
        MaterializationContext materializationContext1;
        IEntityType entityType1;
        Category instance1;
        InternalEntityEntry entry1;
        bool hasNullKey1;
        materializationContext1 = new MaterializationContext(
            [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
            queryContext.Context
        );
        instance1 = default(Category);
        entry1 = queryContext.TryGetEntry(
            key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
            keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
            throwOnNullKey: True, 
            hasNullKey: hasNullKey1);
        !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
        {
            entityType1 = entry1.EntityType;
            return instance1 = (Category)entry1.Entity;
        } : 
        {
            ISnapshot shadowSnapshot1;
            shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
            entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
            instance1 = switch (entityType1)
            {
                case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                    {
                        return 
                        {
                            Category instance;
                            instance = new Category();
                            instance.<Id>k__BackingField = dataReader.GetInt32(0);
                            instance.<ColorForBackground>k__BackingField = dataReader.GetString(1);
                            instance.<Icon>k__BackingField = dataReader.GetString(2);
                            instance.<IsIncome>k__BackingField = dataReader.GetBoolean(3);
                            instance.<Name>k__BackingField = dataReader.GetString(4);
                            instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5);
                            (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                context: materializationContext1.Context, 
                                entity: instance, 
                                queryTrackingBehavior: TrackAll, 
                                structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                            return instance;
                        }}
                default: 
                    default(Category)
            }
            ;
            entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                entityType: entityType1, 
                entity: instance1, 
                snapshot: shadowSnapshot1);
            return instance1;
        } : default(void);
        return instance1;
    }, 
    keyIdentifier: (queryContext, dataReader) => new object[]
    { 
        (object)(int?)dataReader.GetInt32(0), 
        dataReader.GetString(1), 
        dataReader.GetString(2), 
        (object)(bool?)dataReader.GetBoolean(3), 
        dataReader.GetString(4), 
        (object)dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5) 
    }, 
    keyIdentifierValueComparers: [LIFTABLE Constant: Func<object, object, bool>[] { Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool>, Func<object, object, bool> } | Resolver: _ => new Func<object, object, bool>[]
    { 
        (left, right) => left == null ? right == null : right != null && (int)left == (int)right, 
        (left, right) => left == null ? right == null : right != null && (string)left == (string)right, 
        (left, right) => left == null ? right == null : right != null && (string)left == (string)right, 
        (left, right) => left == null ? right == null : right != null && (bool)left == (bool)right, 
        (left, right) => left == null ? right == null : right != null && (string)left == (string)right, 
        (left, right) => left == null ? right == null : right != null && (int)left == (int)right 
    }], 
    elementSelector: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Transaction entity;
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Transaction instance2;
            InternalEntityEntry entry2;
            bool hasNullKey2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Transaction);
            entry2 = queryContext.TryGetEntry(
                key: [LIFTABLE Constant: Key: Transaction.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindPrimaryKey()], 
                keyValues: new object[]{ (object)dataReader.GetInt32(6) }, 
                throwOnNullKey: True, 
                hasNullKey: hasNullKey2);
            !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
            {
                entityType2 = entry2.EntityType;
                return instance2 = (Transaction)entry2.Entity;
            } : 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]: 
                        {
                            return 
                            {
                                Transaction instance;
                                instance = new Transaction();
                                instance.<Id>k__BackingField = dataReader.GetInt32(6);
                                instance.<CategoryId>k__BackingField = dataReader.GetInt32(7);
                                instance.<Date>k__BackingField = dataReader.GetDateTime(8);
                                instance.<InnerCategoryId>k__BackingField = dataReader.IsDBNull(9) ? default(int?) : (int?)dataReader.GetInt32(9);
                                instance.<Name>k__BackingField = dataReader.GetString(10);
                                instance.<Price>k__BackingField = dataReader.GetDecimal(11);
                                instance.<UserId>k__BackingField = dataReader.GetInt32(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: TrackAll, 
                                    structuralType: [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Transaction)
                }
                ;
                entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                    entityType: entityType2, 
                    entity: instance2, 
                    snapshot: shadowSnapshot2);
                return instance2;
            } : default(void);
            return instance2;
        };
        return entity;
    }, 
    contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2025-06-05 21:32:51.982 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:51.984 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:51.988 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:51.992 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2025-06-05 21:32:51.994 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-06-05 21:32:51.996 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32), @__minDate_1='?' (DbType = DateTime2), @__maxDate_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
WHERE [t].[user_fk] = @__userId_0 AND [c].[is_income] = CAST(0 AS bit) AND [t].[date] > @__minDate_1 AND [t].[date] < @__maxDate_2
ORDER BY [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
2025-06-05 21:32:52.011 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__userId_0='?' (DbType = Int32), @__minDate_1='?' (DbType = DateTime2), @__maxDate_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
WHERE [t].[user_fk] = @__userId_0 AND [c].[is_income] = CAST(0 AS bit) AND [t].[date] > @__minDate_1 AND [t].[date] < @__maxDate_2
ORDER BY [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
2025-06-05 21:32:52.018 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:52.020 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 4ms reading results.
2025-06-05 21:32:52.023 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:52.025 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:52.034 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:32:52.038 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:32:52.040 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:32:52.042 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:32:52.072 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:32:52.144 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:32:52.181 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Finance_Manager_Backend.BusinessLogic.Models.DTOs.CategoryPercentDTO, Finance_Manager_Backend, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-06-05 21:32:52.190 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend) in 711.8149ms
2025-06-05 21:32:52.319 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AnalyticsController.GetAnalytics (Finance_Manager_Backend)'
2025-06-05 21:32:52.322 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:32:52.326 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:52.330 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:52.333 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 21:32:52.337 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/Analytics/overview?userId=1157&minDate=2025-05-29T18%3A32%3A50&maxDate=2025-06-05T18%3A32%3A50 - 200 2 application/json; charset=utf-8 1554.9003ms
2025-06-05 21:32:54.354 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Transactions - application/json-patch+json 124
2025-06-05 21:32:54.358 +03:00 [DBG] POST requests are not supported
2025-06-05 21:32:54.360 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions'
2025-06-05 21:32:54.361 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)' with route pattern 'api/Transactions' is valid for the request path '/api/Transactions'
2025-06-05 21:32:54.362 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 21:32:54.364 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:32:54.365 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:32:54.372 +03:00 [DBG] Authorization was successful.
2025-06-05 21:32:54.373 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 21:32:54.378 +03:00 [INF] Route matched with {action = "CreateTransaction", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Int32]] CreateTransaction(Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 21:32:54.380 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:32:54.381 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:32:54.382 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:32:54.384 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:32:54.385 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:32:54.386 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 21:32:54.387 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 21:32:54.388 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 21:32:54.389 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' using the name '' in request data ...
2025-06-05 21:32:54.391 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:32:54.392 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:32:54.394 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:00000008": started reading request body.
2025-06-05 21:32:54.395 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:00000008": done reading request body.
2025-06-05 21:32:54.507 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 21:32:54.508 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 21:32:54.510 +03:00 [DBG] Attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 21:32:54.515 +03:00 [DBG] Done attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 21:32:54.572 +03:00 [ERR] Validation failed. Errors: ["{ Field = Name, Error = Transaction name can't be empty. }","{ Field = Price, Error = 'Price' must not be empty. }","{ Field = Price, Error = 'Price' must be greater than '0'. }","{ Field = CategoryId, Error = 'Category Id' must not be empty. }","{ Field = CategoryId, Error = Transaction category id must be greater than 0. }"]
2025-06-05 21:32:54.576 +03:00 [DBG] Request was short circuited at action filter 'Finance_Manager_Backend.Middleware.ValidationFilter'.
2025-06-05 21:32:54.578 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:32:54.582 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:32:54.583 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:32:54.585 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:32:54.586 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:32:54.587 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:32:54.588 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Finance_Manager_Backend.Middleware.ErrorResponse'.
2025-06-05 21:32:54.591 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend) in 204.764ms
2025-06-05 21:32:54.592 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 21:32:54.594 +03:00 [DBG] Connection id "0HND4BTBKLUB2" accepted.
2025-06-05 21:32:54.595 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:32:54.599 +03:00 [DBG] Connection id "0HND4BTBKLUB2" started.
2025-06-05 21:32:54.600 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Transactions - 400 255 application/json; charset=utf-8 246.2341ms
2025-06-05 21:32:54.603 +03:00 [DBG] Connection 0HND4BTBKLUB2 established using the following protocol: "Tls12"
2025-06-05 21:32:54.608 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1157 - null null
2025-06-05 21:32:54.610 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:32:54.611 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1157'
2025-06-05 21:32:54.613 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1157'
2025-06-05 21:32:54.615 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:32:54.616 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:32:54.617 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:32:54.618 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:32:54.620 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 21:32:54.621 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:32:54.623 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:32:54.625 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:32:54.626 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:32:54.628 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:32:54.630 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:32:54.632 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:32:54.633 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 21:32:54.634 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 21:32:54.636 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:32:54.637 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:32:54.639 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 21:32:54.640 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 21:32:54.642 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:32:54.644 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:32:54.645 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 21:32:54.646 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:54.648 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:54.649 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:32:54.650 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:32:54.651 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:32:54.653 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:32:54.657 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:32:54.660 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:32:54.662 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:54.664 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 21:32:54.665 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:54.667 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:32:54.668 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:32:54.671 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:32:54.672 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:32:54.674 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:32:54.675 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:32:54.676 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:32:54.678 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 21:32:54.680 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 49.8836ms
2025-06-05 21:32:54.684 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:32:54.687 +03:00 [DBG] Connection id "0HND4BTBKLUB2" completed keep alive response.
2025-06-05 21:32:54.699 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:32:54.701 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:32:54.703 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 21:32:54.705 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1157 - 200 105 application/json; charset=utf-8 97.6844ms
2025-06-05 21:33:05.047 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Transactions - application/json-patch+json 132
2025-06-05 21:33:05.052 +03:00 [DBG] POST requests are not supported
2025-06-05 21:33:05.053 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions'
2025-06-05 21:33:05.054 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)' with route pattern 'api/Transactions' is valid for the request path '/api/Transactions'
2025-06-05 21:33:05.057 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 21:33:05.058 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:05.059 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:05.062 +03:00 [DBG] Authorization was successful.
2025-06-05 21:33:05.063 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 21:33:05.065 +03:00 [INF] Route matched with {action = "CreateTransaction", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Int32]] CreateTransaction(Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 21:33:05.071 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:05.075 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:05.078 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:05.081 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:05.085 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:05.087 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 21:33:05.095 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 21:33:05.101 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 21:33:05.104 +03:00 [DBG] Attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' using the name '' in request data ...
2025-06-05 21:33:05.107 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:33:05.110 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:33:05.117 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:00000009": started reading request body.
2025-06-05 21:33:05.120 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:00000009": done reading request body.
2025-06-05 21:33:05.124 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 21:33:05.126 +03:00 [DBG] Done attempting to bind parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 21:33:05.128 +03:00 [DBG] Attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO' ...
2025-06-05 21:33:05.130 +03:00 [DBG] Done attempting to validate the bound parameter 'transactionDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.TransactionDTO'.
2025-06-05 21:33:05.135 +03:00 [INF] Executing CreateTransactionAsync method.
2025-06-05 21:33:05.138 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 21:33:05.179 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:33:05.194 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:33:05.195 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 21:33:05.196 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.197 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.199 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 21:33:05.201 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 21:33:05.202 +03:00 [DBG] Start db transaction.
2025-06-05 21:33:05.204 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:05.205 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:05.207 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:05.208 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:05.212 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:05.215 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:05.216 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.218 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 21:33:05.224 +03:00 [DBG] Compiling query expression: 
'DbSet<Category>()
    .FirstOrDefault(t => t.Id == __categoryId_0)'
2025-06-05 21:33:05.230 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Category>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Category>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
            SELECT TOP(1) c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
            FROM categories AS c
            WHERE c.id == @__categoryId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Category.ColorForBackground (string) Required MaxLength(7), 1], [Property: Category.Icon (string) Required MaxLength(100), 2], [Property: Category.IsIncome (bool) Required, 3], [Property: Category.Name (string) Required MaxLength(50), 4], [Property: Category.ParentCategoryId (int?) FK Index, 5] }
            SELECT TOP(1) c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk
            FROM categories AS c
            WHERE c.id == @__categoryId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Category entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Category instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Category);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Category)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<ColorForBackground>k__BackingField = dataReader.GetString(1);
                                    instance.<Icon>k__BackingField = dataReader.GetString(2);
                                    instance.<IsIncome>k__BackingField = dataReader.GetBoolean(3);
                                    instance.<Name>k__BackingField = dataReader.GetString(4);
                                    instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(5) ? default(int?) : (int?)dataReader.GetInt32(5);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 21:33:05.234 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:05.235 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:05.237 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:05.238 +03:00 [DBG] Executing DbCommand [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
WHERE [c].[id] = @__categoryId_0
2025-06-05 21:33:05.241 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__categoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk]
FROM [categories] AS [c]
WHERE [c].[id] = @__categoryId_0
2025-06-05 21:33:05.244 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:05.245 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.246 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 21:33:05.248 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Transaction.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:05.250 +03:00 [DBG] The navigation 'Transaction.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:05.251 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:05.252 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:33:05.254 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:33:05.256 +03:00 [DBG] The unchanged property 'User.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:33:05.257 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:05.259 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:33:05.260 +03:00 [DBG] Executing 2 update commands as a batch.
2025-06-05 21:33:05.265 +03:00 [DBG] Creating transaction savepoint.
2025-06-05 21:33:05.275 +03:00 [DBG] Created transaction savepoint.
2025-06-05 21:33:05.276 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:05.277 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:05.278 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:05.280 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (Size = 50), @p4='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = Int32), @p7='?' (DbType = Int32), @p6='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [transactions] ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [users] SET [balance] = @p6
OUTPUT 1
WHERE [id] = @p7;
2025-06-05 21:33:05.285 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (Size = 50), @p4='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = Int32), @p7='?' (DbType = Int32), @p6='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [transactions] ([category_fk], [date], [inner_category_fk], [name], [price], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [users] SET [balance] = @p6
OUTPUT 1
WHERE [id] = @p7;
2025-06-05 21:33:05.287 +03:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:33:05.289 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.290 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 21:33:05.292 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:05.294 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:05.296 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-06-05 21:33:05.297 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:33:05.298 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:33:05.300 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:33:05.301 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 0 entities written to the database.
2025-06-05 21:33:05.302 +03:00 [DBG] Committing transaction.
2025-06-05 21:33:05.319 +03:00 [DBG] Committed transaction.
2025-06-05 21:33:05.320 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.321 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:33:05.323 +03:00 [INF] Transaction successful.
2025-06-05 21:33:05.324 +03:00 [DBG] Disposing transaction.
2025-06-05 21:33:05.327 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:33:05.329 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:33:05.330 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:33:05.332 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:33:05.333 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:33:05.334 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:33:05.335 +03:00 [INF] Executing CreatedAtActionResult, writing value of type 'System.Int32'.
2025-06-05 21:33:05.354 +03:00 [DBG] Found the endpoints ["Finance_Manager_Backend.Controllers.TransactionsController.GetTransactionById (Finance_Manager_Backend)"] for address (id=[2821],action=[GetTransactionById],controller=[Transactions])
2025-06-05 21:33:05.358 +03:00 [DBG] Successfully processed template api/Transactions/{id} for Finance_Manager_Backend.Controllers.TransactionsController.GetTransactionById (Finance_Manager_Backend) resulting in /api/Transactions/2821 and 
2025-06-05 21:33:05.360 +03:00 [DBG] Link generation succeeded for endpoints ["Finance_Manager_Backend.Controllers.TransactionsController.GetTransactionById (Finance_Manager_Backend)"] with result /api/Transactions/2821
2025-06-05 21:33:05.362 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend) in 275.2116ms
2025-06-05 21:33:05.364 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.CreateTransaction (Finance_Manager_Backend)'
2025-06-05 21:33:05.364 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1157 - null null
2025-06-05 21:33:05.365 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:33:05.368 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:33:05.369 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:33:05.370 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1157'
2025-06-05 21:33:05.371 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.372 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1157'
2025-06-05 21:33:05.373 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 21:33:05.375 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:05.377 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Transactions - 201 4 application/json; charset=utf-8 329.975ms
2025-06-05 21:33:05.378 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:05.382 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:05.384 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:05.385 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 21:33:05.387 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:05.388 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:05.390 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:05.392 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:05.394 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:05.395 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:05.397 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:05.398 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:05.400 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 21:33:05.401 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:05.403 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:05.404 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:05.405 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:05.407 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:33:05.409 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:33:05.410 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 21:33:05.411 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.413 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.414 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:05.416 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:05.417 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:05.418 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:05.423 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:05.426 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:05.428 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.429 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 21:33:05.430 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.432 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:33:05.434 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:33:05.436 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:33:05.437 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:33:05.439 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:33:05.440 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:33:05.441 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:33:05.443 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 21:33:05.445 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 49.4545ms
2025-06-05 21:33:05.451 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:05.454 +03:00 [DBG] Connection id "0HND4BTBKLUB2" completed keep alive response.
2025-06-05 21:33:05.458 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:33:05.460 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:05.465 +03:00 [DBG] Disposed connection to database '' on server '' (4ms).
2025-06-05 21:33:05.467 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1157 - 200 104 application/json; charset=utf-8 102.7653ms
2025-06-05 21:33:08.946 +03:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:49464/api/Transactions/2821 - null null
2025-06-05 21:33:08.949 +03:00 [DBG] DELETE requests are not supported
2025-06-05 21:33:08.950 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Transactions/2821'
2025-06-05 21:33:08.951 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)' with route pattern 'api/Transactions/{id}' is valid for the request path '/api/Transactions/2821'
2025-06-05 21:33:08.953 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 21:33:08.954 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:08.955 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:08.958 +03:00 [DBG] Authorization was successful.
2025-06-05 21:33:08.961 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 21:33:08.966 +03:00 [INF] Route matched with {action = "DeleteTransaction", controller = "Transactions"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] DeleteTransaction(Int32) on controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend).
2025-06-05 21:33:08.968 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:08.969 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:08.970 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:08.972 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:08.973 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:08.975 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 21:33:08.976 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.TransactionsController (Finance_Manager_Backend)
2025-06-05 21:33:08.978 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:08.979 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 21:33:08.981 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:08.982 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:08.984 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:08.985 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:08.988 +03:00 [INF] Executing DeleteTransactionAsync method.
2025-06-05 21:33:08.988 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 21:33:08.989 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:33:08.994 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:33:08.996 +03:00 [DBG] Created DbConnection. (2ms).
2025-06-05 21:33:08.997 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:08.998 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:08.999 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 21:33:09.001 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 21:33:09.002 +03:00 [DBG] Start db transaction.
2025-06-05 21:33:09.009 +03:00 [DBG] Compiling query expression: 
'DbSet<Transaction>()
    .Include(t => t.Category)
    .Include(t => t.InnerCategory)
    .FirstOrDefault(t => t.Id == __transactionId_0)'
2025-06-05 21:33:09.014 +03:00 [DBG] Including navigation: 'Transaction.Category'.
2025-06-05 21:33:09.017 +03:00 [DBG] Including navigation: 'Transaction.InnerCategory'.
2025-06-05 21:33:09.035 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Transaction>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Transaction>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Transaction.CategoryId (int) Required FK Index, 1], [Property: Transaction.Date (DateTime) Required, 2], [Property: Transaction.InnerCategoryId (int?) FK Index, 3], [Property: Transaction.Name (string) Required MaxLength(50), 4], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 5], [Property: Transaction.UserId (int) Required FK Index, 6] }
                1 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Category.ColorForBackground (string) Required MaxLength(7), 8], [Property: Category.Icon (string) Required MaxLength(100), 9], [Property: Category.IsIncome (bool) Required, 10], [Property: Category.Name (string) Required MaxLength(50), 11], [Property: Category.ParentCategoryId (int?) FK Index, 12] }
                2 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Category.ColorForBackground (string) Required MaxLength(7), 14], [Property: Category.Icon (string) Required MaxLength(100), 15], [Property: Category.IsIncome (bool) Required, 16], [Property: Category.Name (string) Required MaxLength(50), 17], [Property: Category.ParentCategoryId (int?) FK Index, 18] }
            SELECT TOP(1) t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk, c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk, c0.id, c0.background_color, c0.icon_path, c0.is_income, c0.name, c0.parent_category_fk
            FROM transactions AS t
            INNER JOIN categories AS c ON t.category_fk == c.id
            LEFT JOIN categories AS c0 ON t.inner_category_fk == c0.id
            WHERE t.id == @__transactionId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Transaction.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Transaction.CategoryId (int) Required FK Index, 1], [Property: Transaction.Date (DateTime) Required, 2], [Property: Transaction.InnerCategoryId (int?) FK Index, 3], [Property: Transaction.Name (string) Required MaxLength(50), 4], [Property: Transaction.Price (decimal) Required ValueGenerated.OnAdd, 5], [Property: Transaction.UserId (int) Required FK Index, 6] }
                1 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: Category.ColorForBackground (string) Required MaxLength(7), 8], [Property: Category.Icon (string) Required MaxLength(100), 9], [Property: Category.IsIncome (bool) Required, 10], [Property: Category.Name (string) Required MaxLength(50), 11], [Property: Category.ParentCategoryId (int?) FK Index, 12] }
                2 -> Dictionary<IProperty, int> { [Property: Category.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Category.ColorForBackground (string) Required MaxLength(7), 14], [Property: Category.Icon (string) Required MaxLength(100), 15], [Property: Category.IsIncome (bool) Required, 16], [Property: Category.Name (string) Required MaxLength(50), 17], [Property: Category.ParentCategoryId (int?) FK Index, 18] }
            SELECT TOP(1) t.id, t.category_fk, t.date, t.inner_category_fk, t.name, t.price, t.user_fk, c.id, c.background_color, c.icon_path, c.is_income, c.name, c.parent_category_fk, c0.id, c0.background_color, c0.icon_path, c0.is_income, c0.name, c0.parent_category_fk
            FROM transactions AS t
            INNER JOIN categories AS c ON t.category_fk == c.id
            LEFT JOIN categories AS c0 ON t.inner_category_fk == c0.id
            WHERE t.id == @__transactionId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Transaction entity;
            Category entity;
            Category entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Transaction instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Transaction);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Transaction.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Transaction)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]: 
                            {
                                return 
                                {
                                    Transaction instance;
                                    instance = new Transaction();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CategoryId>k__BackingField = dataReader.GetInt32(1);
                                    instance.<Date>k__BackingField = dataReader.GetDateTime(2);
                                    instance.<InnerCategoryId>k__BackingField = dataReader.IsDBNull(3) ? default(int?) : (int?)dataReader.GetInt32(3);
                                    instance.<Name>k__BackingField = dataReader.GetString(4);
                                    instance.<Price>k__BackingField = dataReader.GetDecimal(5);
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(6);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Transaction | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Transaction)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            entity = 
            {
                MaterializationContext materializationContext2;
                IEntityType entityType2;
                Category instance2;
                InternalEntityEntry entry2;
                bool hasNullKey2;
                materializationContext2 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance2 = default(Category);
                entry2 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(7) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey2);
                !(hasNullKey2) ? entry2 != default(InternalEntityEntry) ? 
                {
                    entityType2 = entry2.EntityType;
                    return instance2 = (Category)entry2.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot2;
                    shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType2 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                    instance2 = switch (entityType2)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(7);
                                    instance.<ColorForBackground>k__BackingField = dataReader.GetString(8);
                                    instance.<Icon>k__BackingField = dataReader.GetString(9);
                                    instance.<IsIncome>k__BackingField = dataReader.GetBoolean(10);
                                    instance.<Name>k__BackingField = dataReader.GetString(11);
                                    instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(12) ? default(int?) : (int?)dataReader.GetInt32(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext2.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry2 = entityType2 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType2, 
                        entity: instance2, 
                        snapshot: shadowSnapshot2);
                    return instance2;
                } : default(void);
                return instance2;
            };
            entity = 
            {
                MaterializationContext materializationContext3;
                IEntityType entityType3;
                Category instance3;
                InternalEntityEntry entry3;
                bool hasNullKey3;
                materializationContext3 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance3 = default(Category);
                entry3 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Category.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category").FindPrimaryKey()], 
                    keyValues: new object[]{ dataReader.IsDBNull(13) ? default(object) : (object)dataReader.GetInt32(13) }, 
                    throwOnNullKey: False, 
                    hasNullKey: hasNullKey3);
                !(hasNullKey3) ? entry3 != default(InternalEntityEntry) ? 
                {
                    entityType3 = entry3.EntityType;
                    return instance3 = (Category)entry3.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot3;
                    shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType3 = [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")];
                    instance3 = switch (entityType3)
                    {
                        case [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]: 
                            {
                                return 
                                {
                                    Category instance;
                                    instance = new Category();
                                    instance.<Id>k__BackingField = dataReader.IsDBNull(13) ? default(int) : dataReader.GetInt32(13);
                                    instance.<ColorForBackground>k__BackingField = dataReader.IsDBNull(14) ? default(string) : dataReader.GetString(14);
                                    instance.<Icon>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                    instance.<IsIncome>k__BackingField = dataReader.IsDBNull(16) ? default(bool) : dataReader.GetBoolean(16);
                                    instance.<Name>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                    instance.<ParentCategoryId>k__BackingField = dataReader.IsDBNull(18) ? default(int?) : (int?)dataReader.GetInt32(18);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext3.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Category | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Category")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Category)
                    }
                    ;
                    entry3 = entityType3 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType3, 
                        entity: instance3, 
                        snapshot: shadowSnapshot3);
                    return instance3;
                } : default(void);
                return instance3;
            };
            ShaperProcessingExpressionVisitor.IncludeReference<Transaction, Transaction, Category>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Transaction.Category (Category) ToPrincipal Category | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindNavigation("Category")], 
                inverseNavigation: default(INavigation), 
                fixup: (namelessParameter{10}, namelessParameter{11}) => 
                {
                    return namelessParameter{10}.<Category>k__BackingField = namelessParameter{11};
                }, 
                trackingQuery: True);
            ShaperProcessingExpressionVisitor.IncludeReference<Transaction, Transaction, Category>(
                queryContext: queryContext, 
                entity: entity, 
                relatedEntity: entity, 
                navigation: [LIFTABLE Constant: Navigation: Transaction.InnerCategory (Category) ToPrincipal Category | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Transaction").FindNavigation("InnerCategory")], 
                inverseNavigation: default(INavigation), 
                fixup: (namelessParameter{13}, namelessParameter{14}) => 
                {
                    return namelessParameter{13}.<InnerCategory>k__BackingField = namelessParameter{14};
                }, 
                trackingQuery: True);
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 21:33:09.045 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:09.046 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:09.047 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:09.049 +03:00 [DBG] Executing DbCommand [Parameters=[@__transactionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk], [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [c0].[id], [c0].[background_color], [c0].[icon_path], [c0].[is_income], [c0].[name], [c0].[parent_category_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
LEFT JOIN [categories] AS [c0] ON [t].[inner_category_fk] = [c0].[id]
WHERE [t].[id] = @__transactionId_0
2025-06-05 21:33:09.055 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__transactionId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [t].[id], [t].[category_fk], [t].[date], [t].[inner_category_fk], [t].[name], [t].[price], [t].[user_fk], [c].[id], [c].[background_color], [c].[icon_path], [c].[is_income], [c].[name], [c].[parent_category_fk], [c0].[id], [c0].[background_color], [c0].[icon_path], [c0].[is_income], [c0].[name], [c0].[parent_category_fk]
FROM [transactions] AS [t]
INNER JOIN [categories] AS [c] ON [t].[category_fk] = [c].[id]
LEFT JOIN [categories] AS [c0] ON [t].[inner_category_fk] = [c0].[id]
WHERE [t].[id] = @__transactionId_0
2025-06-05 21:33:09.057 +03:00 [DBG] Context 'AppDbContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:09.059 +03:00 [DBG] The navigation 'Transaction.Category' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:09.061 +03:00 [DBG] Context 'AppDbContext' started tracking 'Category' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:09.063 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:09.064 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 7ms reading results.
2025-06-05 21:33:09.066 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:09.067 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:09.069 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:09.070 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:09.074 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:09.076 +03:00 [DBG] The navigation 'Transaction.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:09.078 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:09.079 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:09.081 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 4ms reading results.
2025-06-05 21:33:09.083 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:09.085 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:33:09.086 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:33:09.088 +03:00 [DBG] The unchanged property 'User.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:33:09.089 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:09.091 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:33:09.092 +03:00 [DBG] Executing 2 update commands as a batch.
2025-06-05 21:33:09.094 +03:00 [DBG] Creating transaction savepoint.
2025-06-05 21:33:09.095 +03:00 [DBG] Created transaction savepoint.
2025-06-05 21:33:09.096 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:09.097 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:09.098 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:09.100 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p2='?' (DbType = Int32), @p1='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [transactions]
OUTPUT 1
WHERE [id] = @p0;
UPDATE [users] SET [balance] = @p1
OUTPUT 1
WHERE [id] = @p2;
2025-06-05 21:33:09.149 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@p0='?' (DbType = Int32), @p2='?' (DbType = Int32), @p1='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [transactions]
OUTPUT 1
WHERE [id] = @p0;
UPDATE [users] SET [balance] = @p1
OUTPUT 1
WHERE [id] = @p2;
2025-06-05 21:33:09.152 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:09.153 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-06-05 21:33:09.155 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:09.158 +03:00 [DBG] An entity of type 'Transaction' tracked by 'AppDbContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:09.160 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-06-05 21:33:09.161 +03:00 [DBG] Committing transaction.
2025-06-05 21:33:09.166 +03:00 [DBG] Committed transaction.
2025-06-05 21:33:09.167 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:09.169 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:33:09.171 +03:00 [INF] Transaction successful.
2025-06-05 21:33:09.172 +03:00 [DBG] Disposing transaction.
2025-06-05 21:33:09.174 +03:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-06-05 21:33:09.176 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend) in 201.0161ms
2025-06-05 21:33:09.177 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.TransactionsController.DeleteTransaction (Finance_Manager_Backend)'
2025-06-05 21:33:09.179 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:33:09.182 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:33:09.184 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:09.185 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:33:09.187 +03:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:49464/api/Transactions/2821 - 204 null null 240.8382ms
2025-06-05 21:33:09.190 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1157 - null null
2025-06-05 21:33:09.194 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:33:09.196 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1157'
2025-06-05 21:33:09.197 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1157'
2025-06-05 21:33:09.199 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:09.200 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:09.201 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:09.203 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:09.204 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 21:33:09.206 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:09.208 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:09.211 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:09.214 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:09.216 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:09.217 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:09.219 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:09.220 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:09.222 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 21:33:09.224 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:09.226 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:09.227 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:09.228 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:09.231 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:33:09.233 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:33:09.234 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 21:33:09.235 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:09.237 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:09.238 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:09.240 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:09.241 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 21:33:09.244 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:09.248 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:09.252 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:09.254 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:09.256 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 4ms reading results.
2025-06-05 21:33:09.259 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:09.262 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (3ms).
2025-06-05 21:33:09.264 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:33:09.267 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:33:09.270 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:33:09.272 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:33:09.274 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:33:09.277 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:33:09.280 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 21:33:09.283 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 65.9609ms
2025-06-05 21:33:09.288 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:09.290 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:33:09.292 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:33:09.295 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:09.297 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:33:09.299 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1157 - 200 105 application/json; charset=utf-8 108.6465ms
2025-06-05 21:33:35.068 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:49464/api/Savings - application/json-patch+json 48
2025-06-05 21:33:35.073 +03:00 [DBG] PUT requests are not supported
2025-06-05 21:33:35.073 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 21:33:35.074 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 21:33:35.076 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:35.077 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:35.078 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:35.079 +03:00 [DBG] Authorization was successful.
2025-06-05 21:33:35.080 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:35.085 +03:00 [INF] Route matched with {action = "UpdateSaving", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] UpdateSaving(Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 21:33:35.087 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:35.088 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:35.089 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:35.091 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:35.093 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:35.094 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 21:33:35.096 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 21:33:35.099 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 21:33:35.100 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' using the name '' in request data ...
2025-06-05 21:33:35.102 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:33:35.103 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:33:35.104 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:0000000C": started reading request body.
2025-06-05 21:33:35.106 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:0000000C": done reading request body.
2025-06-05 21:33:35.109 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:35.110 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:35.112 +03:00 [DBG] Attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 21:33:35.114 +03:00 [DBG] Done attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:35.118 +03:00 [ERR] Validation failed. Errors: ["{ Field = topUpAmount, Error = Top up amount must be greater than 0. }"]
2025-06-05 21:33:35.120 +03:00 [DBG] Request was short circuited at action filter 'Finance_Manager_Backend.Middleware.ValidationFilter'.
2025-06-05 21:33:35.121 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:33:35.124 +03:00 [DBG] No information found on request to perform content negotiation.
2025-06-05 21:33:35.124 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:33:35.125 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:33:35.126 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:33:35.128 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Finance_Manager_Backend.Middleware.ErrorResponse'.
2025-06-05 21:33:35.130 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend) in 35.4991ms
2025-06-05 21:33:35.131 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1157 - null null
2025-06-05 21:33:35.131 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:35.134 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:33:35.135 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:33:35.136 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1157'
2025-06-05 21:33:35.137 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:49464/api/Savings - 400 83 application/json; charset=utf-8 69.7033ms
2025-06-05 21:33:35.139 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1157'
2025-06-05 21:33:35.144 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:35.145 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:35.146 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:35.148 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:35.149 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 21:33:35.150 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:35.152 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:35.153 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:35.155 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:35.156 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:35.158 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:35.159 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:35.160 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:35.162 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 21:33:35.165 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:35.167 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:35.169 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:35.170 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:35.173 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:33:35.175 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:33:35.176 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 21:33:35.177 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:35.179 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:35.180 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:35.181 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:35.182 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:35.184 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:35.188 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:35.191 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:35.193 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:35.195 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 21:33:35.197 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:35.199 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:33:35.201 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:33:35.204 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:33:35.205 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:33:35.206 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:33:35.207 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:33:35.208 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:33:35.209 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 21:33:35.211 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 53.3166ms
2025-06-05 21:33:35.223 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:35.224 +03:00 [DBG] Connection id "0HND4BTBKLUB2" completed keep alive response.
2025-06-05 21:33:35.226 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:33:35.227 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:35.228 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:33:35.232 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1157 - 200 105 application/json; charset=utf-8 100.9348ms
2025-06-05 21:33:39.693 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:49464/api/Savings - application/json-patch+json 47
2025-06-05 21:33:39.705 +03:00 [DBG] PUT requests are not supported
2025-06-05 21:33:39.707 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 21:33:39.709 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 21:33:39.712 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:39.714 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:39.749 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:39.753 +03:00 [DBG] Authorization was successful.
2025-06-05 21:33:39.754 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:39.756 +03:00 [INF] Route matched with {action = "UpdateSaving", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] UpdateSaving(Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 21:33:39.758 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:39.760 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:39.762 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:39.764 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:39.768 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:39.770 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 21:33:39.773 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 21:33:39.775 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 21:33:39.776 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' using the name '' in request data ...
2025-06-05 21:33:39.778 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:33:39.780 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:33:39.782 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:0000000D": started reading request body.
2025-06-05 21:33:39.783 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:0000000D": done reading request body.
2025-06-05 21:33:39.785 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:39.786 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:39.788 +03:00 [DBG] Attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 21:33:39.790 +03:00 [DBG] Done attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:39.793 +03:00 [INF] Executing UdateSavingAsync method
2025-06-05 21:33:39.794 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 21:33:39.796 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:33:39.820 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:33:39.825 +03:00 [DBG] Created DbConnection. (5ms).
2025-06-05 21:33:39.826 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:39.828 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:39.833 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 21:33:39.837 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 21:33:39.838 +03:00 [DBG] Start db transaction.
2025-06-05 21:33:39.842 +03:00 [DBG] Compiling query expression: 
'DbSet<Saving>()
    .FirstOrDefault(s => s.Id == __savingId_0)'
2025-06-05 21:33:39.848 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Saving>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Saving>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
            SELECT TOP(1) s.id, s.current_amount, s.goal, s.name, s.user_fk
            FROM savings AS s
            WHERE s.id == @__savingId_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Saving.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Saving.CurrentAmount (decimal) Required ValueGenerated.OnAdd, 1], [Property: Saving.Goal (decimal) Required ValueGenerated.OnAdd, 2], [Property: Saving.Name (string) Required MaxLength(50), 3], [Property: Saving.UserId (int) Required FK Index, 4] }
            SELECT TOP(1) s.id, s.current_amount, s.goal, s.name, s.user_fk
            FROM savings AS s
            WHERE s.id == @__savingId_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Saving entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Saving instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Saving);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Saving.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Saving)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]: 
                            {
                                return 
                                {
                                    Saving instance;
                                    instance = new Saving();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CurrentAmount>k__BackingField = dataReader.GetDecimal(1);
                                    instance.<Goal>k__BackingField = dataReader.GetDecimal(2);
                                    instance.<Name>k__BackingField = dataReader.GetString(3);
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(4);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Saving | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.Saving")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Saving)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-06-05 21:33:39.897 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:39.898 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:39.899 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:39.901 +03:00 [DBG] Executing DbCommand [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 21:33:39.905 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 21:33:39.907 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:39.908 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:39.910 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 21:33:39.913 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:39.915 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:39.916 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-06-05 21:33:39.919 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:39.923 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:39.927 +03:00 [DBG] The navigation 'Saving.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:39.929 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:39.930 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:39.932 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 4ms reading results.
2025-06-05 21:33:39.934 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:33:39.936 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:33:39.937 +03:00 [DBG] The unchanged property 'Saving.CurrentAmount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:33:39.938 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:39.940 +03:00 [DBG] The unchanged property 'User.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:33:39.942 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:39.944 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:33:39.946 +03:00 [DBG] Executing 2 update commands as a batch.
2025-06-05 21:33:39.947 +03:00 [DBG] Creating transaction savepoint.
2025-06-05 21:33:39.949 +03:00 [DBG] Created transaction savepoint.
2025-06-05 21:33:39.950 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:39.951 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:39.952 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:39.954 +03:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [savings] SET [current_amount] = @p0
OUTPUT 1
WHERE [id] = @p1;
UPDATE [users] SET [balance] = @p2
OUTPUT 1
WHERE [id] = @p3;
2025-06-05 21:33:39.962 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [savings] SET [current_amount] = @p0
OUTPUT 1
WHERE [id] = @p1;
UPDATE [users] SET [balance] = @p2
OUTPUT 1
WHERE [id] = @p3;
2025-06-05 21:33:39.965 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:39.967 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 21:33:39.969 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:39.972 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:39.974 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-06-05 21:33:39.976 +03:00 [DBG] Committing transaction.
2025-06-05 21:33:39.996 +03:00 [DBG] Committed transaction.
2025-06-05 21:33:39.997 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:39.999 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:33:40.001 +03:00 [INF] Transaction successful.
2025-06-05 21:33:40.002 +03:00 [DBG] Disposing transaction.
2025-06-05 21:33:40.003 +03:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-06-05 21:33:40.005 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend) in 235.0351ms
2025-06-05 21:33:40.006 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:40.007 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:33:40.009 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:33:40.010 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:40.011 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:33:40.013 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:49464/api/Savings - 204 null null 320.0473ms
2025-06-05 21:33:40.016 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1157 - null null
2025-06-05 21:33:40.019 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:33:40.020 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1157'
2025-06-05 21:33:40.021 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1157'
2025-06-05 21:33:40.023 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:40.024 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:40.025 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:40.026 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:40.027 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 21:33:40.029 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:40.031 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:40.032 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:40.034 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:40.036 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:40.038 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:40.039 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:40.041 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:40.042 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 21:33:40.044 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:40.045 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:40.046 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:40.048 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:40.050 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:33:40.053 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:33:40.054 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 21:33:40.055 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:40.057 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:40.058 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:40.059 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:40.061 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:40.062 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:40.067 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:40.070 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:40.072 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:40.073 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 21:33:40.074 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:40.076 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:33:40.077 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:33:40.080 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:33:40.081 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:33:40.083 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:33:40.084 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:33:40.085 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:33:40.087 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 21:33:40.088 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 50.4851ms
2025-06-05 21:33:40.090 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:40.091 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:33:40.092 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:33:40.093 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:40.094 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:33:40.095 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1157 - 200 104 application/json; charset=utf-8 79.1526ms
2025-06-05 21:33:43.672 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:49464/api/Savings - application/json-patch+json 46
2025-06-05 21:33:43.676 +03:00 [DBG] PUT requests are not supported
2025-06-05 21:33:43.677 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 21:33:43.678 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 21:33:43.679 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:43.681 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:43.681 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:43.694 +03:00 [DBG] Authorization was successful.
2025-06-05 21:33:43.695 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:43.696 +03:00 [INF] Route matched with {action = "UpdateSaving", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] UpdateSaving(Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 21:33:43.700 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:43.701 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:43.704 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:43.706 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:43.708 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:43.709 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 21:33:43.711 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 21:33:43.713 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 21:33:43.714 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' using the name '' in request data ...
2025-06-05 21:33:43.716 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:33:43.717 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:33:43.718 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:0000000F": started reading request body.
2025-06-05 21:33:43.720 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:0000000F": done reading request body.
2025-06-05 21:33:43.722 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:43.724 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:43.726 +03:00 [DBG] Attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 21:33:43.727 +03:00 [DBG] Done attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:43.729 +03:00 [INF] Executing UdateSavingAsync method
2025-06-05 21:33:43.730 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 21:33:43.731 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:33:43.733 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:33:43.733 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 21:33:43.734 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.735 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.738 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 21:33:43.739 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 21:33:43.740 +03:00 [DBG] Start db transaction.
2025-06-05 21:33:43.741 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:43.742 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:43.744 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:43.745 +03:00 [DBG] Executing DbCommand [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 21:33:43.749 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 21:33:43.751 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:43.753 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.754 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 21:33:43.756 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:43.757 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-05 21:33:43.758 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:43.759 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:43.762 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:43.764 +03:00 [DBG] The navigation 'Saving.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:43.765 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:43.766 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.767 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 21:33:43.768 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:33:43.769 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:33:43.770 +03:00 [DBG] The unchanged property 'Saving.CurrentAmount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:33:43.772 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:43.773 +03:00 [DBG] The unchanged property 'User.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:33:43.774 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:43.776 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:33:43.777 +03:00 [DBG] Executing 2 update commands as a batch.
2025-06-05 21:33:43.778 +03:00 [DBG] Creating transaction savepoint.
2025-06-05 21:33:43.779 +03:00 [DBG] Created transaction savepoint.
2025-06-05 21:33:43.780 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:43.781 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-05 21:33:43.782 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:43.784 +03:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [savings] SET [current_amount] = @p0
OUTPUT 1
WHERE [id] = @p1;
UPDATE [users] SET [balance] = @p2
OUTPUT 1
WHERE [id] = @p3;
2025-06-05 21:33:43.789 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [savings] SET [current_amount] = @p0
OUTPUT 1
WHERE [id] = @p1;
UPDATE [users] SET [balance] = @p2
OUTPUT 1
WHERE [id] = @p3;
2025-06-05 21:33:43.791 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.792 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-06-05 21:33:43.794 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:43.796 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:43.797 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-06-05 21:33:43.799 +03:00 [DBG] Committing transaction.
2025-06-05 21:33:43.833 +03:00 [DBG] Committed transaction.
2025-06-05 21:33:43.834 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.836 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:33:43.837 +03:00 [INF] Transaction successful.
2025-06-05 21:33:43.838 +03:00 [DBG] Disposing transaction.
2025-06-05 21:33:43.839 +03:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-06-05 21:33:43.840 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend) in 130.8285ms
2025-06-05 21:33:43.841 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:43.842 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:33:43.844 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:33:43.846 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.848 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-06-05 21:33:43.851 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:49464/api/Savings - 204 null null 178.1291ms
2025-06-05 21:33:43.854 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1157 - null null
2025-06-05 21:33:43.857 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:33:43.858 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1157'
2025-06-05 21:33:43.859 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1157'
2025-06-05 21:33:43.861 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:43.862 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:43.863 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:43.864 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:43.866 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 21:33:43.868 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:43.869 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:43.871 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:43.873 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:43.875 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:43.877 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:43.878 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:43.879 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:43.881 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 21:33:43.882 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:43.884 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:43.885 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:43.886 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:43.888 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:33:43.891 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:33:43.892 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 21:33:43.893 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.894 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.896 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:43.897 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:43.899 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:43.900 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:43.905 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:43.907 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:43.910 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.912 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 4ms reading results.
2025-06-05 21:33:43.915 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.917 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-06-05 21:33:43.921 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:33:43.925 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:33:43.927 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:33:43.930 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:33:43.931 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:33:43.933 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:33:43.935 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 21:33:43.941 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 64.4563ms
2025-06-05 21:33:43.950 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:43.980 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:33:43.982 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:33:43.985 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:43.989 +03:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-06-05 21:33:43.991 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1157 - 200 104 application/json; charset=utf-8 136.3502ms
2025-06-05 21:33:50.932 +03:00 [INF] Request starting HTTP/1.1 PUT https://localhost:49464/api/Savings - application/json-patch+json 46
2025-06-05 21:33:50.941 +03:00 [DBG] PUT requests are not supported
2025-06-05 21:33:50.951 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Savings'
2025-06-05 21:33:50.953 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)' with route pattern 'api/Savings' is valid for the request path '/api/Savings'
2025-06-05 21:33:50.956 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:50.958 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:50.966 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:50.967 +03:00 [DBG] Authorization was successful.
2025-06-05 21:33:50.969 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:50.971 +03:00 [INF] Route matched with {action = "UpdateSaving", controller = "Savings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] UpdateSaving(Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO) on controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend).
2025-06-05 21:33:50.975 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:50.979 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:50.982 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:50.985 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:50.988 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:50.990 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 21:33:50.992 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.SavingsController (Finance_Manager_Backend)
2025-06-05 21:33:50.994 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 21:33:50.995 +03:00 [DBG] Attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' using the name '' in request data ...
2025-06-05 21:33:50.997 +03:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:33:50.999 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2025-06-05 21:33:51.000 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:00000011": started reading request body.
2025-06-05 21:33:51.002 +03:00 [DBG] Connection id "0HND4BTBKLUB1", Request id "0HND4BTBKLUB1:00000011": done reading request body.
2025-06-05 21:33:51.004 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:51.007 +03:00 [DBG] Done attempting to bind parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:51.009 +03:00 [DBG] Attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO' ...
2025-06-05 21:33:51.011 +03:00 [DBG] Done attempting to validate the bound parameter 'topUpDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.SavingTopUpDTO'.
2025-06-05 21:33:51.013 +03:00 [INF] Executing UdateSavingAsync method
2025-06-05 21:33:51.014 +03:00 [INF] Start ExecuteTransactionAsync method.
2025-06-05 21:33:51.015 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:33:51.017 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:33:51.018 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 21:33:51.019 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.020 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.022 +03:00 [DBG] Beginning transaction with isolation level 'ReadCommitted'.
2025-06-05 21:33:51.023 +03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-06-05 21:33:51.024 +03:00 [DBG] Start db transaction.
2025-06-05 21:33:51.025 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:51.027 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:51.028 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:51.029 +03:00 [DBG] Executing DbCommand [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 21:33:51.034 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__savingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[id], [s].[current_amount], [s].[goal], [s].[name], [s].[user_fk]
FROM [savings] AS [s]
WHERE [s].[id] = @__savingId_0
2025-06-05 21:33:51.038 +03:00 [DBG] Context 'AppDbContext' started tracking 'Saving' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:51.040 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.041 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-06-05 21:33:51.046 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:51.048 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:51.050 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2025-06-05 21:33:51.053 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:51.058 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:51.064 +03:00 [DBG] The navigation 'Saving.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:51.066 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:51.069 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.071 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 7ms reading results.
2025-06-05 21:33:51.074 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-06-05 21:33:51.077 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-06-05 21:33:51.079 +03:00 [DBG] The unchanged property 'Saving.CurrentAmount' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:33:51.081 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:51.084 +03:00 [DBG] The unchanged property 'User.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-06-05 21:33:51.085 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:51.087 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-06-05 21:33:51.088 +03:00 [DBG] Executing 2 update commands as a batch.
2025-06-05 21:33:51.089 +03:00 [DBG] Creating transaction savepoint.
2025-06-05 21:33:51.091 +03:00 [DBG] Created transaction savepoint.
2025-06-05 21:33:51.092 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:51.093 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-06-05 21:33:51.094 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:51.095 +03:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [savings] SET [current_amount] = @p0
OUTPUT 1
WHERE [id] = @p1;
UPDATE [users] SET [balance] = @p2
OUTPUT 1
WHERE [id] = @p3;
2025-06-05 21:33:51.101 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (Precision = 12) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [savings] SET [current_amount] = @p0
OUTPUT 1
WHERE [id] = @p1;
UPDATE [users] SET [balance] = @p2
OUTPUT 1
WHERE [id] = @p3;
2025-06-05 21:33:51.103 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.104 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-06-05 21:33:51.106 +03:00 [DBG] An entity of type 'Saving' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:51.107 +03:00 [DBG] An entity of type 'User' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:51.108 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 2 entities written to the database.
2025-06-05 21:33:51.110 +03:00 [DBG] Committing transaction.
2025-06-05 21:33:51.111 +03:00 [DBG] Committed transaction.
2025-06-05 21:33:51.112 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.113 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:33:51.114 +03:00 [INF] Transaction successful.
2025-06-05 21:33:51.115 +03:00 [DBG] Disposing transaction.
2025-06-05 21:33:51.116 +03:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-06-05 21:33:51.117 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend) in 126.8341ms
2025-06-05 21:33:51.118 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.SavingsController.UpdateSaving (Finance_Manager_Backend)'
2025-06-05 21:33:51.119 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:33:51.120 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:33:51.121 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.122 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:33:51.123 +03:00 [INF] Request finished HTTP/1.1 PUT https://localhost:49464/api/Savings - 204 null null 190.8401ms
2025-06-05 21:33:51.128 +03:00 [INF] Request starting HTTP/1.1 GET https://localhost:49464/api/User/1157 - null null
2025-06-05 21:33:51.130 +03:00 [DBG] The request path  does not match the path filter
2025-06-05 21:33:51.131 +03:00 [DBG] 1 candidate(s) found for the request path '/api/User/1157'
2025-06-05 21:33:51.132 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)' with route pattern 'api/User/{id}' is valid for the request path '/api/User/1157'
2025-06-05 21:33:51.134 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:51.135 +03:00 [DBG] Successfully validated the token.
2025-06-05 21:33:51.136 +03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-06-05 21:33:51.137 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:51.138 +03:00 [INF] Route matched with {action = "GetBalanceById", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO]] GetBalanceById(Int32) on controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend).
2025-06-05 21:33:51.139 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-06-05 21:33:51.141 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-06-05 21:33:51.142 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-06-05 21:33:51.144 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-06-05 21:33:51.146 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-06-05 21:33:51.147 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:51.148 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.UserController (Finance_Manager_Backend)
2025-06-05 21:33:51.150 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:51.151 +03:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2025-06-05 21:33:51.152 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:51.153 +03:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:51.155 +03:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2025-06-05 21:33:51.156 +03:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2025-06-05 21:33:51.157 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-06-05 21:33:51.160 +03:00 [DBG] Creating DbConnection.
2025-06-05 21:33:51.161 +03:00 [DBG] Created DbConnection. (0ms).
2025-06-05 21:33:51.162 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.163 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.164 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-06-05 21:33:51.165 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-06-05 21:33:51.166 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-06-05 21:33:51.168 +03:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:51.171 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[id] = @__userId_0
2025-06-05 21:33:51.173 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-06-05 21:33:51.174 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.176 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-06-05 21:33:51.178 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.180 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-06-05 21:33:51.182 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter"]
2025-06-05 21:33:51.184 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-06-05 21:33:51.185 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-06-05 21:33:51.187 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-06-05 21:33:51.187 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-06-05 21:33:51.188 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2025-06-05 21:33:51.189 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.UserBalanceDTO'.
2025-06-05 21:33:51.191 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend) in 44.0033ms
2025-06-05 21:33:51.196 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.UserController.GetBalanceById (Finance_Manager_Backend)'
2025-06-05 21:33:51.197 +03:00 [DBG] Connection id "0HND4BTBKLUB1" completed keep alive response.
2025-06-05 21:33:51.199 +03:00 [DBG] 'AppDbContext' disposed.
2025-06-05 21:33:51.200 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-06-05 21:33:51.201 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-06-05 21:33:51.202 +03:00 [INF] Request finished HTTP/1.1 GET https://localhost:49464/api/User/1157 - 200 104 application/json; charset=utf-8 74.5105ms
2025-06-05 21:33:55.210 +03:00 [DBG] Connection id "0HND4BTBKLUB1" reset.
2025-06-05 21:33:55.211 +03:00 [DBG] Connection id "0HND4BTBKLUB2" reset.
2025-06-05 21:33:55.239 +03:00 [DBG] Connection id "0HND4BTBKLUB1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-05 21:33:55.241 +03:00 [DBG] Connection id "0HND4BTBKLUB2" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-06-05 21:33:55.242 +03:00 [DBG] Connection id "0HND4BTBKLUB1" disconnecting.
2025-06-05 21:33:55.243 +03:00 [DBG] Connection id "0HND4BTBKLUB2" disconnecting.
2025-06-05 21:33:55.261 +03:00 [DBG] Connection id "0HND4BTBKLUB1" stopped.
2025-06-05 21:33:55.261 +03:00 [DBG] Connection id "0HND4BTBKLUB2" stopped.
2025-06-05 21:33:56.703 +03:00 [INF] Application is shutting down...
2025-06-05 21:33:56.704 +03:00 [DBG] Hosting stopping
2025-06-05 21:33:56.729 +03:00 [DBG] Hosting stopped
