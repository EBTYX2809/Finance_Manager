2025-05-08 00:00:06.518 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:00:06.556 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:00:06.578 +03:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] RefreshToken(System.String) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:00:06.581 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:00:06.583 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:00:06.585 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:00:06.588 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:00:06.590 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:00:06.593 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:00:06.596 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:00:06.723 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:00:06.812 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' using the name '' in request data ...
2025-05-08 00:00:06.826 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:00:07.928 +03:00 [DBG] Connection id "0HNCDL8F5PG8K", Request id "0HNCDL8F5PG8K:00000001": started reading request body.
2025-05-08 00:00:07.929 +03:00 [DBG] Connection id "0HNCDL8F5PG8K", Request id "0HNCDL8F5PG8K:00000001": done reading request body.
2025-05-08 00:00:08.033 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'System.String'
2025-05-08 00:00:08.035 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:00:08.037 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:00:08.038 +03:00 [DBG] Attempting to validate the bound parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:00:08.046 +03:00 [DBG] Done attempting to validate the bound parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:00:08.108 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:00:08.113 +03:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(rt => rt.Token == __refreshToken_0)'
2025-05-08 00:00:08.184 +03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<RefreshToken>(
    asyncEnumerable: SingleQueryingEnumerable.Create<RefreshToken>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
            SELECT TOP(1) r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
            FROM refresh_tokens AS r
            WHERE r.token == @__refreshToken_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.CreatedAt (DateTime) Required, 1], [Property: RefreshToken.ExpiresAt (DateTime) Required, 2], [Property: RefreshToken.IsRevoked (bool) Required, 3], [Property: RefreshToken.Token (string) Required Index MaxLength(200), 4], [Property: RefreshToken.UserId (int) Required FK Index, 5] }
            SELECT TOP(1) r.id, r.created_at, r.expires_at, r.is_revoked, r.token, r.user_fk
            FROM refresh_tokens AS r
            WHERE r.token == @__refreshToken_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            RefreshToken entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                RefreshToken instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(RefreshToken);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: RefreshToken.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (RefreshToken)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]: 
                            {
                                return 
                                {
                                    RefreshToken instance;
                                    instance = new RefreshToken();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(1);
                                    instance.<ExpiresAt>k__BackingField = dataReader.GetDateTime(2);
                                    instance.<IsRevoked>k__BackingField = dataReader.GetBoolean(3);
                                    instance.<Token>k__BackingField = dataReader.GetString(4);
                                    instance.<UserId>k__BackingField = dataReader.GetInt32(5);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: RefreshToken | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Finance_Manager_Backend.BusinessLogic.Models.RefreshToken")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(RefreshToken)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Finance_Manager_Backend.DataBase.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2025-05-08 00:00:08.269 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:00:08.271 +03:00 [DBG] Created DbConnection. (1ms).
2025-05-08 00:00:08.273 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:00:08.358 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:00:08.361 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:00:08.362 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:00:08.364 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-05-08 00:00:08.367 +03:00 [DBG] Executing DbCommand [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:00:08.520 +03:00 [INF] Executed DbCommand (153ms) [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:00:08.532 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:00:08.535 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-05-08 00:00:08.538 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:00:08.541 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (2ms).
2025-05-08 00:00:08.587 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend) in 1992.8778ms
2025-05-08 00:00:08.591 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:00:08.596 +03:00 [ERR] Invalid refresh token
System.InvalidOperationException: Invalid refresh token
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserWithRefreshTokenAsync(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 89
   at Finance_Manager_Backend.Controllers.AuthController.RefreshToken(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 84
   at lambda_method472(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:00:09.175 +03:00 [DBG] Connection id "0HNCDL8F5PG8K" completed keep alive response.
2025-05-08 00:00:09.181 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:00:09.185 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:00:09.186 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-08 00:00:09.189 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - 400 null application/json 13732.4597ms
2025-05-08 00:00:22.221 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - application/json 62
2025-05-08 00:00:22.226 +03:00 [DBG] POST requests are not supported
2025-05-08 00:00:22.230 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/authenticate'
2025-05-08 00:00:22.232 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)' with route pattern 'api/Auth/authenticate' is valid for the request path '/api/Auth/authenticate'
2025-05-08 00:00:22.233 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:00:22.236 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:00:22.237 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:00:22.243 +03:00 [INF] Route matched with {action = "Authenticate", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] Authenticate(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:00:22.245 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:00:22.247 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:00:22.249 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:00:22.251 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:00:22.253 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:00:22.254 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:00:22.257 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:00:22.259 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:00:22.261 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' using the name '' in request data ...
2025-05-08 00:00:22.263 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:00:22.265 +03:00 [DBG] Connection id "0HNCDL8F5PG8K", Request id "0HNCDL8F5PG8K:00000002": started reading request body.
2025-05-08 00:00:22.267 +03:00 [DBG] Connection id "0HNCDL8F5PG8K", Request id "0HNCDL8F5PG8K:00000002": done reading request body.
2025-05-08 00:00:22.277 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'
2025-05-08 00:00:22.278 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:00:22.280 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:00:22.281 +03:00 [DBG] Attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:00:22.286 +03:00 [DBG] Done attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:00:22.635 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:00:22.638 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:00:22.639 +03:00 [DBG] Created DbConnection. (0ms).
2025-05-08 00:00:22.640 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:00:22.642 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:00:22.643 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:00:22.644 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:00:22.646 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-08 00:00:22.647 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:00:22.653 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:00:22.655 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:00:22.657 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-05-08 00:00:22.659 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:00:22.660 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-05-08 00:00:22.663 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend) in 408.3488ms
2025-05-08 00:00:22.664 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:00:22.666 +03:00 [ERR] Error, this email not registered.
System.InvalidOperationException: Error, this email not registered.
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserAsync(String email, String password) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 66
   at Finance_Manager_Backend.Controllers.AuthController.Authenticate(AuthDataDTO authDataDTO) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 59
   at lambda_method490(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:00:22.672 +03:00 [DBG] Connection id "0HNCDL8F5PG8K" completed keep alive response.
2025-05-08 00:00:22.674 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:00:22.675 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:00:22.677 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-08 00:00:22.678 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - 400 null application/json 457.9177ms
2025-05-08 00:01:14.185 +03:00 [DBG] Connection id "0HNCDL8F5PG8K" received FIN.
2025-05-08 00:01:14.188 +03:00 [DBG] Connection id "0HNCDL8F5PG8K" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-08 00:01:14.190 +03:00 [DBG] Connection id "0HNCDL8F5PG8K" disconnecting.
2025-05-08 00:01:14.200 +03:00 [DBG] Connection id "0HNCDL8F5PG8K" stopped.
2025-05-08 00:03:47.070 +03:00 [DBG] Connection id "0HNCDL8F5PG8L" accepted.
2025-05-08 00:03:47.077 +03:00 [DBG] Connection id "0HNCDL8F5PG8L" started.
2025-05-08 00:03:47.110 +03:00 [DBG] Connection 0HNCDL8F5PG8L established using the following protocol: "Tls12"
2025-05-08 00:03:47.210 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - application/json 90
2025-05-08 00:03:47.245 +03:00 [DBG] POST requests are not supported
2025-05-08 00:03:47.247 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/refresh-token'
2025-05-08 00:03:47.251 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)' with route pattern 'api/Auth/refresh-token' is valid for the request path '/api/Auth/refresh-token'
2025-05-08 00:03:47.294 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:03:47.374 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:03:47.375 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:03:47.378 +03:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] RefreshToken(System.String) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:03:47.380 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:03:47.383 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:03:47.385 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:03:47.388 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:03:47.390 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:03:47.391 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:03:47.393 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:03:47.395 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:03:47.397 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' using the name '' in request data ...
2025-05-08 00:03:47.399 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:03:47.402 +03:00 [DBG] Connection id "0HNCDL8F5PG8L", Request id "0HNCDL8F5PG8L:00000001": started reading request body.
2025-05-08 00:03:47.403 +03:00 [DBG] Connection id "0HNCDL8F5PG8L", Request id "0HNCDL8F5PG8L:00000001": done reading request body.
2025-05-08 00:03:47.404 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'System.String'
2025-05-08 00:03:47.405 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:03:47.407 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:03:47.408 +03:00 [DBG] Attempting to validate the bound parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:03:47.410 +03:00 [DBG] Done attempting to validate the bound parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:03:47.414 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:03:47.417 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:03:47.418 +03:00 [DBG] Created DbConnection. (1ms).
2025-05-08 00:03:47.419 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:03:47.420 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:03:47.422 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:03:47.423 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:03:47.425 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-08 00:03:47.457 +03:00 [DBG] Executing DbCommand [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:03:47.473 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:03:47.475 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:03:47.477 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-05-08 00:03:47.478 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:03:47.480 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-05-08 00:03:47.482 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend) in 90.3538ms
2025-05-08 00:03:47.484 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:03:47.485 +03:00 [ERR] Invalid refresh token
System.InvalidOperationException: Invalid refresh token
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserWithRefreshTokenAsync(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 89
   at Finance_Manager_Backend.Controllers.AuthController.RefreshToken(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 84
   at lambda_method472(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:03:47.493 +03:00 [DBG] Connection id "0HNCDL8F5PG8L" completed keep alive response.
2025-05-08 00:03:47.506 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:03:47.507 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:03:47.509 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-08 00:03:47.511 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - 400 null application/json 300.9427ms
2025-05-08 00:04:01.455 +03:00 [DBG] Connection id "0HNCDL8F5PG8L" received FIN.
2025-05-08 00:04:01.458 +03:00 [DBG] Connection id "0HNCDL8F5PG8L" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-08 00:04:01.460 +03:00 [DBG] Connection id "0HNCDL8F5PG8L" disconnecting.
2025-05-08 00:04:01.465 +03:00 [DBG] Connection id "0HNCDL8F5PG8L" stopped.
2025-05-08 00:04:37.610 +03:00 [DBG] Connection id "0HNCDL8F5PG8M" accepted.
2025-05-08 00:04:37.618 +03:00 [DBG] Connection id "0HNCDL8F5PG8M" started.
2025-05-08 00:04:37.649 +03:00 [DBG] Connection 0HNCDL8F5PG8M established using the following protocol: "Tls12"
2025-05-08 00:04:37.819 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - application/json 90
2025-05-08 00:04:37.829 +03:00 [DBG] POST requests are not supported
2025-05-08 00:04:37.830 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/refresh-token'
2025-05-08 00:04:37.832 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)' with route pattern 'api/Auth/refresh-token' is valid for the request path '/api/Auth/refresh-token'
2025-05-08 00:04:37.835 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:04:37.836 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:04:37.838 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:04:37.839 +03:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] RefreshToken(System.String) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:04:37.843 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:04:37.845 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:04:37.847 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:04:37.849 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:04:37.851 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:04:37.853 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:04:37.855 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:04:37.857 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:04:37.859 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' using the name '' in request data ...
2025-05-08 00:04:37.861 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:04:37.863 +03:00 [DBG] Connection id "0HNCDL8F5PG8M", Request id "0HNCDL8F5PG8M:00000001": started reading request body.
2025-05-08 00:04:37.864 +03:00 [DBG] Connection id "0HNCDL8F5PG8M", Request id "0HNCDL8F5PG8M:00000001": done reading request body.
2025-05-08 00:04:37.866 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'System.String'
2025-05-08 00:04:37.867 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:04:37.869 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:04:37.870 +03:00 [DBG] Attempting to validate the bound parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:04:37.872 +03:00 [DBG] Done attempting to validate the bound parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:04:37.875 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:04:37.877 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:04:37.878 +03:00 [DBG] Created DbConnection. (1ms).
2025-05-08 00:04:37.880 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:04:37.882 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:04:37.883 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:04:37.884 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:04:37.886 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-08 00:04:37.887 +03:00 [DBG] Executing DbCommand [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:04:37.893 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:04:37.895 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:04:37.897 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-05-08 00:04:37.899 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:04:37.900 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-05-08 00:04:37.902 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend) in 49.3553ms
2025-05-08 00:04:37.905 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:04:37.906 +03:00 [ERR] Invalid refresh token
System.InvalidOperationException: Invalid refresh token
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserWithRefreshTokenAsync(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 89
   at Finance_Manager_Backend.Controllers.AuthController.RefreshToken(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 84
   at lambda_method472(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:04:37.912 +03:00 [DBG] Connection id "0HNCDL8F5PG8M" completed keep alive response.
2025-05-08 00:04:37.914 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:04:37.915 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:04:37.917 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-08 00:04:37.919 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - 400 null application/json 99.4014ms
2025-05-08 00:05:13.958 +03:00 [DBG] Connection id "0HNCDL8F5PG8M" received FIN.
2025-05-08 00:05:13.968 +03:00 [DBG] Connection id "0HNCDL8F5PG8M" disconnecting.
2025-05-08 00:05:13.975 +03:00 [DBG] Connection id "0HNCDL8F5PG8M" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-08 00:05:13.979 +03:00 [DBG] Connection id "0HNCDL8F5PG8M" stopped.
2025-05-08 00:12:34.513 +03:00 [DBG] Connection id "0HNCDL8F5PG8N" accepted.
2025-05-08 00:12:34.540 +03:00 [DBG] Connection id "0HNCDL8F5PG8N" started.
2025-05-08 00:12:34.558 +03:00 [DBG] Connection 0HNCDL8F5PG8N established using the following protocol: "Tls12"
2025-05-08 00:12:34.826 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - application/json 90
2025-05-08 00:12:35.020 +03:00 [DBG] POST requests are not supported
2025-05-08 00:12:35.023 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/refresh-token'
2025-05-08 00:12:35.025 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)' with route pattern 'api/Auth/refresh-token' is valid for the request path '/api/Auth/refresh-token'
2025-05-08 00:12:35.028 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:12:35.030 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:12:35.034 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:12:35.039 +03:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] RefreshToken(System.String) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:12:35.045 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:12:35.057 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:12:35.064 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:12:35.073 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:12:35.075 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:12:35.080 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:12:35.152 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:12:35.160 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:12:35.192 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' using the name '' in request data ...
2025-05-08 00:12:35.199 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:12:35.201 +03:00 [DBG] Connection id "0HNCDL8F5PG8N", Request id "0HNCDL8F5PG8N:00000001": started reading request body.
2025-05-08 00:12:35.202 +03:00 [DBG] Connection id "0HNCDL8F5PG8N", Request id "0HNCDL8F5PG8N:00000001": done reading request body.
2025-05-08 00:12:35.203 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'System.String'
2025-05-08 00:12:35.206 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:12:35.208 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:12:35.210 +03:00 [DBG] Attempting to validate the bound parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:12:35.211 +03:00 [DBG] Done attempting to validate the bound parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:12:35.219 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:12:35.231 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:12:35.234 +03:00 [DBG] Created DbConnection. (2ms).
2025-05-08 00:12:35.239 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:12:35.275 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:12:35.765 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:12:35.766 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:12:35.767 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-08 00:12:35.770 +03:00 [DBG] Executing DbCommand [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:12:35.782 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:12:35.785 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:12:35.787 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-05-08 00:12:35.798 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:12:35.802 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (3ms).
2025-05-08 00:12:35.805 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend) in 725.9473ms
2025-05-08 00:12:35.807 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:12:35.808 +03:00 [ERR] Invalid refresh token
System.InvalidOperationException: Invalid refresh token
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserWithRefreshTokenAsync(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 89
   at Finance_Manager_Backend.Controllers.AuthController.RefreshToken(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 84
   at lambda_method472(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:12:35.847 +03:00 [DBG] Connection id "0HNCDL8F5PG8N" completed keep alive response.
2025-05-08 00:12:36.040 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:12:36.046 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:12:36.047 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-08 00:12:36.085 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - 400 null application/json 1259.0565ms
2025-05-08 00:13:07.096 +03:00 [DBG] Connection id "0HNCDL8F5PG8N" received FIN.
2025-05-08 00:13:07.099 +03:00 [DBG] Connection id "0HNCDL8F5PG8N" disconnecting.
2025-05-08 00:13:07.101 +03:00 [DBG] Connection id "0HNCDL8F5PG8N" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-08 00:13:07.109 +03:00 [DBG] Connection id "0HNCDL8F5PG8N" stopped.
2025-05-08 00:26:52.411 +03:00 [DBG] Connection id "0HNCDL8F5PG8O" accepted.
2025-05-08 00:26:52.417 +03:00 [DBG] Connection id "0HNCDL8F5PG8O" started.
2025-05-08 00:26:52.441 +03:00 [DBG] Connection 0HNCDL8F5PG8O established using the following protocol: "Tls12"
2025-05-08 00:26:52.688 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - application/json 90
2025-05-08 00:26:52.694 +03:00 [DBG] POST requests are not supported
2025-05-08 00:26:52.695 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/refresh-token'
2025-05-08 00:26:52.696 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)' with route pattern 'api/Auth/refresh-token' is valid for the request path '/api/Auth/refresh-token'
2025-05-08 00:26:52.697 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:26:52.699 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:26:52.700 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:26:52.701 +03:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] RefreshToken(System.String) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:26:52.703 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:26:52.704 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:26:52.706 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:26:52.708 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:26:52.709 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:26:52.711 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:26:52.713 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:26:52.714 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:26:52.716 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' using the name '' in request data ...
2025-05-08 00:26:52.717 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:26:52.719 +03:00 [DBG] Connection id "0HNCDL8F5PG8O", Request id "0HNCDL8F5PG8O:00000001": started reading request body.
2025-05-08 00:26:52.720 +03:00 [DBG] Connection id "0HNCDL8F5PG8O", Request id "0HNCDL8F5PG8O:00000001": done reading request body.
2025-05-08 00:26:52.722 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'System.String'
2025-05-08 00:26:52.723 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:26:52.725 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:26:52.727 +03:00 [DBG] Attempting to validate the bound parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:26:52.728 +03:00 [DBG] Done attempting to validate the bound parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:26:52.731 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:26:52.733 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:26:52.735 +03:00 [DBG] Created DbConnection. (1ms).
2025-05-08 00:26:52.736 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:26:52.821 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:26:52.823 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:26:52.824 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:26:52.826 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-08 00:26:52.827 +03:00 [DBG] Executing DbCommand [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:26:52.833 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:26:52.840 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:26:52.842 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-05-08 00:26:52.844 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:26:52.845 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-05-08 00:26:52.847 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend) in 136.3072ms
2025-05-08 00:26:52.849 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:26:52.851 +03:00 [ERR] Invalid refresh token
System.InvalidOperationException: Invalid refresh token
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserWithRefreshTokenAsync(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 89
   at Finance_Manager_Backend.Controllers.AuthController.RefreshToken(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 84
   at lambda_method472(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:26:52.856 +03:00 [DBG] Connection id "0HNCDL8F5PG8O" completed keep alive response.
2025-05-08 00:26:52.857 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:26:52.858 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:26:52.859 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-08 00:26:52.861 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - 400 null application/json 172.6946ms
2025-05-08 00:27:24.158 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - application/json 62
2025-05-08 00:27:24.174 +03:00 [DBG] POST requests are not supported
2025-05-08 00:27:24.179 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/authenticate'
2025-05-08 00:27:24.183 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)' with route pattern 'api/Auth/authenticate' is valid for the request path '/api/Auth/authenticate'
2025-05-08 00:27:24.186 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:27:24.189 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:27:24.191 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:27:24.193 +03:00 [INF] Route matched with {action = "Authenticate", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] Authenticate(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:27:24.197 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:27:24.199 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:27:24.205 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:27:24.208 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:27:24.212 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:27:24.214 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:27:24.218 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:27:24.224 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:27:24.229 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' using the name '' in request data ...
2025-05-08 00:27:24.232 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:27:24.233 +03:00 [DBG] Connection id "0HNCDL8F5PG8O", Request id "0HNCDL8F5PG8O:00000002": started reading request body.
2025-05-08 00:27:24.236 +03:00 [DBG] Connection id "0HNCDL8F5PG8O", Request id "0HNCDL8F5PG8O:00000002": done reading request body.
2025-05-08 00:27:24.240 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'
2025-05-08 00:27:24.241 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:27:24.242 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:27:24.244 +03:00 [DBG] Attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:27:24.246 +03:00 [DBG] Done attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:27:24.250 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:27:24.253 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:27:24.253 +03:00 [DBG] Created DbConnection. (0ms).
2025-05-08 00:27:24.255 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:27:24.256 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:27:24.257 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:27:24.259 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:27:24.260 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-05-08 00:27:24.262 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:27:24.268 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:27:24.271 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:27:24.272 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-05-08 00:27:24.276 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:27:24.283 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (7ms).
2025-05-08 00:27:24.285 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend) in 70.9124ms
2025-05-08 00:27:24.287 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:27:24.288 +03:00 [ERR] Error, this email not registered.
System.InvalidOperationException: Error, this email not registered.
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserAsync(String email, String password) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 66
   at Finance_Manager_Backend.Controllers.AuthController.Authenticate(AuthDataDTO authDataDTO) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 59
   at lambda_method490(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:27:24.293 +03:00 [DBG] Connection id "0HNCDL8F5PG8O" completed keep alive response.
2025-05-08 00:27:24.295 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:27:24.297 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:27:24.298 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-08 00:27:24.300 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - 400 null application/json 142.5105ms
2025-05-08 00:28:49.184 +03:00 [DBG] Connection id "0HNCDL8F5PG8O" received FIN.
2025-05-08 00:28:49.244 +03:00 [DBG] Connection id "0HNCDL8F5PG8O" disconnecting.
2025-05-08 00:28:49.293 +03:00 [DBG] Connection id "0HNCDL8F5PG8O" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-08 00:28:49.299 +03:00 [DBG] Connection id "0HNCDL8F5PG8O" stopped.
2025-05-08 00:29:41.334 +03:00 [DBG] Connection id "0HNCDL8F5PG8P" accepted.
2025-05-08 00:29:41.338 +03:00 [DBG] Connection id "0HNCDL8F5PG8P" started.
2025-05-08 00:29:41.392 +03:00 [DBG] Connection 0HNCDL8F5PG8P established using the following protocol: "Tls12"
2025-05-08 00:29:41.481 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - application/json 90
2025-05-08 00:29:41.492 +03:00 [DBG] POST requests are not supported
2025-05-08 00:29:41.493 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/refresh-token'
2025-05-08 00:29:41.494 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)' with route pattern 'api/Auth/refresh-token' is valid for the request path '/api/Auth/refresh-token'
2025-05-08 00:29:41.495 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:29:41.497 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:29:41.498 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:29:41.499 +03:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] RefreshToken(System.String) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:29:41.501 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:29:41.502 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:29:41.504 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:29:41.508 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:29:41.509 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:29:41.511 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:29:41.513 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:29:41.516 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:29:41.519 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' using the name '' in request data ...
2025-05-08 00:29:41.522 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:29:41.524 +03:00 [DBG] Connection id "0HNCDL8F5PG8P", Request id "0HNCDL8F5PG8P:00000001": started reading request body.
2025-05-08 00:29:41.525 +03:00 [DBG] Connection id "0HNCDL8F5PG8P", Request id "0HNCDL8F5PG8P:00000001": done reading request body.
2025-05-08 00:29:41.527 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'System.String'
2025-05-08 00:29:41.530 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:29:41.532 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:29:41.534 +03:00 [DBG] Attempting to validate the bound parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:29:41.535 +03:00 [DBG] Done attempting to validate the bound parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:29:41.538 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:29:41.545 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:29:41.547 +03:00 [DBG] Created DbConnection. (2ms).
2025-05-08 00:29:41.549 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:29:41.552 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:29:41.556 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:29:41.557 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:29:41.558 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-08 00:29:41.560 +03:00 [DBG] Executing DbCommand [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:29:41.568 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:29:41.570 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:29:41.572 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-05-08 00:29:41.574 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:29:41.575 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-05-08 00:29:41.578 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend) in 66.1648ms
2025-05-08 00:29:41.579 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:29:41.580 +03:00 [ERR] Invalid refresh token
System.InvalidOperationException: Invalid refresh token
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserWithRefreshTokenAsync(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 89
   at Finance_Manager_Backend.Controllers.AuthController.RefreshToken(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 84
   at lambda_method472(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:29:41.585 +03:00 [DBG] Connection id "0HNCDL8F5PG8P" completed keep alive response.
2025-05-08 00:29:41.587 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:29:41.590 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:29:41.593 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-08 00:29:41.594 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - 400 null application/json 113.2887ms
2025-05-08 00:30:02.850 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - application/json 62
2025-05-08 00:30:02.899 +03:00 [DBG] POST requests are not supported
2025-05-08 00:30:02.900 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/authenticate'
2025-05-08 00:30:02.905 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)' with route pattern 'api/Auth/authenticate' is valid for the request path '/api/Auth/authenticate'
2025-05-08 00:30:02.907 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:30:02.909 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:30:02.910 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:30:02.912 +03:00 [INF] Route matched with {action = "Authenticate", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] Authenticate(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:30:02.914 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:30:02.916 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:30:02.918 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:30:02.924 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:30:02.926 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:30:02.928 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:30:02.929 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:30:02.931 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:30:02.932 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' using the name '' in request data ...
2025-05-08 00:30:02.934 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:30:02.935 +03:00 [DBG] Connection id "0HNCDL8F5PG8P", Request id "0HNCDL8F5PG8P:00000002": started reading request body.
2025-05-08 00:30:02.936 +03:00 [DBG] Connection id "0HNCDL8F5PG8P", Request id "0HNCDL8F5PG8P:00000002": done reading request body.
2025-05-08 00:30:02.938 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'
2025-05-08 00:30:02.939 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:30:02.941 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:30:02.942 +03:00 [DBG] Attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:30:02.943 +03:00 [DBG] Done attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:30:02.946 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:30:02.948 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:30:02.949 +03:00 [DBG] Created DbConnection. (0ms).
2025-05-08 00:30:02.950 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:30:02.951 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:30:02.954 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:30:02.969 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (14ms).
2025-05-08 00:30:02.974 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (19ms).
2025-05-08 00:30:02.975 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:30:02.979 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:30:02.981 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:30:02.983 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-05-08 00:30:02.984 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:30:02.986 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-05-08 00:30:02.988 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend) in 59.9453ms
2025-05-08 00:30:02.990 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:30:02.991 +03:00 [ERR] Error, this email not registered.
System.InvalidOperationException: Error, this email not registered.
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserAsync(String email, String password) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 66
   at Finance_Manager_Backend.Controllers.AuthController.Authenticate(AuthDataDTO authDataDTO) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 59
   at lambda_method490(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:30:02.996 +03:00 [DBG] Connection id "0HNCDL8F5PG8P" completed keep alive response.
2025-05-08 00:30:02.997 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:30:02.999 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:30:03.001 +03:00 [DBG] Disposed connection to database '' on server '' (2ms).
2025-05-08 00:30:03.003 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - 400 null application/json 153.3302ms
2025-05-08 00:30:16.803 +03:00 [DBG] Connection id "0HNCDL8F5PG8P" received FIN.
2025-05-08 00:30:16.831 +03:00 [DBG] Connection id "0HNCDL8F5PG8P" disconnecting.
2025-05-08 00:30:16.873 +03:00 [DBG] Connection id "0HNCDL8F5PG8P" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-08 00:30:16.891 +03:00 [DBG] Connection id "0HNCDL8F5PG8P" stopped.
2025-05-08 00:30:47.195 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q" accepted.
2025-05-08 00:30:47.199 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q" started.
2025-05-08 00:30:47.250 +03:00 [DBG] Connection 0HNCDL8F5PG8Q established using the following protocol: "Tls12"
2025-05-08 00:30:47.370 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - application/json 90
2025-05-08 00:30:47.451 +03:00 [DBG] POST requests are not supported
2025-05-08 00:30:47.452 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/refresh-token'
2025-05-08 00:30:47.453 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)' with route pattern 'api/Auth/refresh-token' is valid for the request path '/api/Auth/refresh-token'
2025-05-08 00:30:47.455 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:30:47.456 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:30:47.460 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:30:47.461 +03:00 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] RefreshToken(System.String) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:30:47.463 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:30:47.465 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:30:47.466 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:30:47.469 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:30:47.470 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:30:47.473 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:30:47.475 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:30:47.478 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:30:47.479 +03:00 [DBG] Attempting to bind parameter 'refreshToken' of type 'System.String' using the name '' in request data ...
2025-05-08 00:30:47.481 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:30:47.482 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q", Request id "0HNCDL8F5PG8Q:00000001": started reading request body.
2025-05-08 00:30:47.484 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q", Request id "0HNCDL8F5PG8Q:00000001": done reading request body.
2025-05-08 00:30:47.485 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'System.String'
2025-05-08 00:30:47.487 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:30:47.490 +03:00 [DBG] Done attempting to bind parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:30:47.493 +03:00 [DBG] Attempting to validate the bound parameter 'refreshToken' of type 'System.String' ...
2025-05-08 00:30:47.494 +03:00 [DBG] Done attempting to validate the bound parameter 'refreshToken' of type 'System.String'.
2025-05-08 00:30:47.497 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:30:47.500 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:30:47.501 +03:00 [DBG] Created DbConnection. (1ms).
2025-05-08 00:30:47.502 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:30:47.504 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:30:47.514 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:30:47.516 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:30:47.517 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-08 00:30:47.528 +03:00 [DBG] Executing DbCommand [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:30:47.535 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__refreshToken_0='?' (Size = 200)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[id], [r].[created_at], [r].[expires_at], [r].[is_revoked], [r].[token], [r].[user_fk]
FROM [refresh_tokens] AS [r]
WHERE [r].[token] = @__refreshToken_0
2025-05-08 00:30:47.542 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:30:47.544 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 1ms reading results.
2025-05-08 00:30:47.546 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:30:47.547 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-05-08 00:30:47.549 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend) in 76.3903ms
2025-05-08 00:30:47.552 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.RefreshToken (Finance_Manager_Backend)'
2025-05-08 00:30:47.554 +03:00 [ERR] Invalid refresh token
System.InvalidOperationException: Invalid refresh token
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserWithRefreshTokenAsync(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 89
   at Finance_Manager_Backend.Controllers.AuthController.RefreshToken(String refreshToken) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 84
   at lambda_method472(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:30:47.561 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q" completed keep alive response.
2025-05-08 00:30:47.563 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:30:47.564 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:30:47.565 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-08 00:30:47.568 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/refresh-token - 400 null application/json 197.7961ms
2025-05-08 00:31:03.666 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - application/json 62
2025-05-08 00:31:03.673 +03:00 [DBG] POST requests are not supported
2025-05-08 00:31:03.674 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/authenticate'
2025-05-08 00:31:03.675 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)' with route pattern 'api/Auth/authenticate' is valid for the request path '/api/Auth/authenticate'
2025-05-08 00:31:03.677 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:31:03.678 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:31:03.679 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:31:03.680 +03:00 [INF] Route matched with {action = "Authenticate", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] Authenticate(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:31:03.682 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:31:03.683 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:31:03.685 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:31:03.687 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:31:03.690 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:31:03.692 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:31:03.694 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:31:03.695 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:31:03.696 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' using the name '' in request data ...
2025-05-08 00:31:03.698 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:31:03.700 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q", Request id "0HNCDL8F5PG8Q:00000002": started reading request body.
2025-05-08 00:31:03.702 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q", Request id "0HNCDL8F5PG8Q:00000002": done reading request body.
2025-05-08 00:31:03.703 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'
2025-05-08 00:31:03.704 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:31:03.706 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:31:03.708 +03:00 [DBG] Attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:31:03.709 +03:00 [DBG] Done attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:31:03.712 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:31:03.714 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:31:03.715 +03:00 [DBG] Created DbConnection. (1ms).
2025-05-08 00:31:03.716 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:03.717 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:03.719 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:31:03.720 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:31:03.722 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-05-08 00:31:03.723 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:31:03.727 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:31:03.729 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:03.731 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-05-08 00:31:03.733 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:03.734 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-05-08 00:31:03.736 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend) in 44.1051ms
2025-05-08 00:31:03.738 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:31:03.740 +03:00 [ERR] Error, this email not registered.
System.InvalidOperationException: Error, this email not registered.
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserAsync(String email, String password) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 66
   at Finance_Manager_Backend.Controllers.AuthController.Authenticate(AuthDataDTO authDataDTO) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 59
   at lambda_method490(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:31:03.745 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q" completed keep alive response.
2025-05-08 00:31:03.757 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:31:03.758 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:03.759 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-08 00:31:03.760 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - 400 null application/json 94.4502ms
2025-05-08 00:31:09.637 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - application/json 62
2025-05-08 00:31:09.749 +03:00 [DBG] POST requests are not supported
2025-05-08 00:31:09.751 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/authenticate'
2025-05-08 00:31:09.753 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)' with route pattern 'api/Auth/authenticate' is valid for the request path '/api/Auth/authenticate'
2025-05-08 00:31:09.756 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:31:09.758 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:31:09.822 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:31:09.824 +03:00 [INF] Route matched with {action = "Authenticate", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] Authenticate(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:31:09.826 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:31:09.828 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:31:09.847 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:31:09.848 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:31:09.850 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:31:09.852 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:31:09.853 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:31:09.854 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:31:09.855 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' using the name '' in request data ...
2025-05-08 00:31:09.857 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:31:09.858 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q", Request id "0HNCDL8F5PG8Q:00000003": started reading request body.
2025-05-08 00:31:09.862 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q", Request id "0HNCDL8F5PG8Q:00000003": done reading request body.
2025-05-08 00:31:09.863 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'
2025-05-08 00:31:09.864 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:31:09.866 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:31:09.867 +03:00 [DBG] Attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:31:09.868 +03:00 [DBG] Done attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:31:09.870 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:31:09.873 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:31:09.874 +03:00 [DBG] Created DbConnection. (0ms).
2025-05-08 00:31:09.877 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:09.878 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:09.880 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:31:09.881 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:31:09.882 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-08 00:31:09.883 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:31:09.888 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:31:09.894 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-08 00:31:09.896 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:09.897 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 2ms reading results.
2025-05-08 00:31:09.898 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:09.899 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-05-08 00:31:09.918 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend) in 66.6495ms
2025-05-08 00:31:09.925 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:31:09.927 +03:00 [ERR] Invalid password. Please try again.
System.InvalidOperationException: Invalid password. Please try again.
   at Finance_Manager_Backend.BusinessLogic.Services.AuthServices.AuthService.AuthenticateUserAsync(String email, String password) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\BusinessLogic\Services\AuthServices\AuthService.cs:line 82
   at Finance_Manager_Backend.Controllers.AuthController.Authenticate(AuthDataDTO authDataDTO) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Controllers\AuthController.cs:line 59
   at lambda_method490(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Finance_Manager_Backend.Middleware.ExceptionsHandler.InvokeAsync(HttpContext httpContext) in G:\ARTEM\Проэкты С++, C#\Visual Studio projects\C# Projects\Finance_Manager_Backend\Finance_Manager_Backend\Middleware\ExceptionsHandler.cs:line 23
2025-05-08 00:31:09.984 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q" completed keep alive response.
2025-05-08 00:31:10.415 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:31:10.465 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:10.468 +03:00 [DBG] Disposed connection to database '' on server '' (3ms).
2025-05-08 00:31:10.471 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - 400 null application/json 834.2488ms
2025-05-08 00:31:16.706 +03:00 [INF] Request starting HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - application/json 63
2025-05-08 00:31:16.711 +03:00 [DBG] POST requests are not supported
2025-05-08 00:31:16.712 +03:00 [DBG] 1 candidate(s) found for the request path '/api/Auth/authenticate'
2025-05-08 00:31:16.713 +03:00 [DBG] Endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)' with route pattern 'api/Auth/authenticate' is valid for the request path '/api/Auth/authenticate'
2025-05-08 00:31:16.714 +03:00 [DBG] Request matched endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:31:16.716 +03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-05-08 00:31:16.717 +03:00 [INF] Executing endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:31:16.718 +03:00 [INF] Route matched with {action = "Authenticate", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO]] Authenticate(Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO) on controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend).
2025-05-08 00:31:16.720 +03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-05-08 00:31:16.722 +03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-05-08 00:31:16.724 +03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Finance_Manager_Backend.Middleware.ValidationFilter"]
2025-05-08 00:31:16.726 +03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-05-08 00:31:16.728 +03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-05-08 00:31:16.730 +03:00 [DBG] Executing controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:31:16.732 +03:00 [DBG] Executed controller factory for controller Finance_Manager_Backend.Controllers.AuthController (Finance_Manager_Backend)
2025-05-08 00:31:16.733 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:31:16.735 +03:00 [DBG] Attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' using the name '' in request data ...
2025-05-08 00:31:16.736 +03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-05-08 00:31:16.739 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q", Request id "0HNCDL8F5PG8Q:00000004": started reading request body.
2025-05-08 00:31:16.741 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q", Request id "0HNCDL8F5PG8Q:00000004": done reading request body.
2025-05-08 00:31:16.743 +03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'
2025-05-08 00:31:16.744 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:31:16.746 +03:00 [DBG] Done attempting to bind parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:31:16.747 +03:00 [DBG] Attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO' ...
2025-05-08 00:31:16.750 +03:00 [DBG] Done attempting to validate the bound parameter 'authDataDTO' of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthDataDTO'.
2025-05-08 00:31:16.752 +03:00 [DBG] Entity Framework Core 9.0.4 initialized 'AppDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:9.0.4' with options: EngineType=SqlServer 
2025-05-08 00:31:16.763 +03:00 [DBG] Creating DbConnection.
2025-05-08 00:31:16.777 +03:00 [DBG] Created DbConnection. (13ms).
2025-05-08 00:31:16.778 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:16.779 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:16.782 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:31:16.786 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2025-05-08 00:31:16.787 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2025-05-08 00:31:16.790 +03:00 [DBG] Executing DbCommand [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:31:16.794 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 50)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[balance], [u].[email], [u].[password_hash], [u].[primary_currency], [u].[role], [u].[salt], [u].[secondary_currency_1], [u].[secondary_currency_2]
FROM [users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-08 00:31:16.796 +03:00 [DBG] Context 'AppDbContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-08 00:31:16.797 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:16.799 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-05-08 00:31:16.801 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:16.802 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-05-08 00:31:16.813 +03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'RefreshToken.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-08 00:31:16.815 +03:00 [DBG] The navigation 'RefreshToken.User' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-08 00:31:16.817 +03:00 [DBG] Context 'AppDbContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-08 00:31:16.819 +03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2025-05-08 00:31:16.820 +03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2025-05-08 00:31:16.821 +03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2025-05-08 00:31:16.823 +03:00 [DBG] Opening connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:16.824 +03:00 [DBG] Opened connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:16.826 +03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-05-08 00:31:16.827 +03:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2025-05-08 00:31:16.828 +03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-05-08 00:31:16.830 +03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-05-08 00:31:16.881 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (Size = 200), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [refresh_tokens] ([created_at], [expires_at], [is_revoked], [token], [user_fk])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-05-08 00:31:16.884 +03:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-05-08 00:31:16.886 +03:00 [DBG] Closing data reader to 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:16.887 +03:00 [DBG] A data reader for 'FinanceManagerDB' on server 'localhost' is being disposed after spending 3ms reading results.
2025-05-08 00:31:16.889 +03:00 [DBG] Closing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:16.890 +03:00 [DBG] Closed connection to database 'FinanceManagerDB' on server 'localhost' (1ms).
2025-05-08 00:31:16.892 +03:00 [DBG] An entity of type 'RefreshToken' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-05-08 00:31:16.894 +03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2025-05-08 00:31:16.898 +03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-05-08 00:31:16.903 +03:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-05-08 00:31:16.905 +03:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-05-08 00:31:16.907 +03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-05-08 00:31:16.908 +03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-05-08 00:31:16.910 +03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-05-08 00:31:16.912 +03:00 [INF] Executing OkObjectResult, writing value of type 'Finance_Manager_Backend.BusinessLogic.Models.DTOs.AuthUserTokensDTO'.
2025-05-08 00:31:16.952 +03:00 [INF] Executed action Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend) in 222.8624ms
2025-05-08 00:31:16.956 +03:00 [INF] Executed endpoint 'Finance_Manager_Backend.Controllers.AuthController.Authenticate (Finance_Manager_Backend)'
2025-05-08 00:31:16.957 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q" completed keep alive response.
2025-05-08 00:31:16.959 +03:00 [DBG] 'AppDbContext' disposed.
2025-05-08 00:31:16.960 +03:00 [DBG] Disposing connection to database 'FinanceManagerDB' on server 'localhost'.
2025-05-08 00:31:16.961 +03:00 [DBG] Disposed connection to database '' on server '' (1ms).
2025-05-08 00:31:16.963 +03:00 [INF] Request finished HTTP/1.1 POST https://localhost:49464/api/Auth/authenticate - 200 null application/json; charset=utf-8 257.2986ms
2025-05-08 00:31:24.932 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q" reset.
2025-05-08 00:31:24.935 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-05-08 00:31:24.937 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q" disconnecting.
2025-05-08 00:31:24.962 +03:00 [DBG] Connection id "0HNCDL8F5PG8Q" stopped.
2025-05-08 01:10:12.428 +03:00 [INF] Application is shutting down...
2025-05-08 01:10:12.429 +03:00 [DBG] Hosting stopping
2025-05-08 01:10:12.504 +03:00 [DBG] Hosting stopped
